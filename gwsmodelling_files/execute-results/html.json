{
  "hash": "3579c65eb1b6ca8f44bde3f4bacad815",
  "result": {
    "markdown": "---\ntitle: \"Parametric Testing\"\nauthor:\n  - name: Khant Min Naing\n  - name: Ann Mei Yi Victoria Grace\ndate: 01-07-2024 \ndate-modified: \"last-modified\"\ncategories:\n  - R\n  - sf\n  - gwmodel\noutput:\n  distill::distill_article:\n    code_folding: false\n    toc: true\n    self_contained: false\n---\n\n\nTo develop a landslide susceptibility methodology framework, we will explore and calibrate different statistical and machine learning models.\n\n## 1.0 Import Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sp, sf, st, spdep, raster, spatstat, tmap, devtools,vtable,ggplot2,egg, corrplot, patchwork, ggstats, ggstatsplot, GWmodel, tidyverse, gtsummary,vtable, sjPlot, sjmisc, sjlabelled, tableHTML, olsrr, car, blorr,ISLR, klaR)\n```\n:::\n\n\n## 2.0 Import Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvaltellina <- read_sf(dsn = \"./data/vector\", layer = \"valtellina\")\ntrain_grids_v4 <- read.csv(\"~/IS485-Landslide/data/aspatial/train_grid_v4.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain_grid_v4.sf <- st_as_sf(train_grids_v4,\n                            coords = c(\"X\", \"Y\"))\ntrain_grid_v4.sf <- st_set_crs(train_grid_v4.sf, 32632) \n```\n:::\n\n\n## 3.0 Exploratory Spatial Data Analysis (ESDA)\n\nTo calculate the summary statistics of `landslide_train` data frame, we use `st()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst(train_grids_v4)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Summary Statistics</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> N </th>\n   <th style=\"text-align:left;\"> Mean </th>\n   <th style=\"text-align:left;\"> Std. Dev. </th>\n   <th style=\"text-align:left;\"> Min </th>\n   <th style=\"text-align:left;\"> Pctl. 25 </th>\n   <th style=\"text-align:left;\"> Pctl. 75 </th>\n   <th style=\"text-align:left;\"> Max </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Train_ID </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 25282 </td>\n   <td style=\"text-align:left;\"> 14596 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 12642 </td>\n   <td style=\"text-align:left;\"> 37922 </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Grid_ID </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 7258576 </td>\n   <td style=\"text-align:left;\"> 4280699 </td>\n   <td style=\"text-align:left;\"> 154 </td>\n   <td style=\"text-align:left;\"> 3455206 </td>\n   <td style=\"text-align:left;\"> 11141722 </td>\n   <td style=\"text-align:left;\"> 14724829 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> X </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 573312 </td>\n   <td style=\"text-align:left;\"> 27325 </td>\n   <td style=\"text-align:left;\"> 519097 </td>\n   <td style=\"text-align:left;\"> 550687 </td>\n   <td style=\"text-align:left;\"> 594547 </td>\n   <td style=\"text-align:left;\"> 624487 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Y </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 5129116 </td>\n   <td style=\"text-align:left;\"> 17040 </td>\n   <td style=\"text-align:left;\"> 5095541 </td>\n   <td style=\"text-align:left;\"> 5115266 </td>\n   <td style=\"text-align:left;\"> 5143076 </td>\n   <td style=\"text-align:left;\"> 5164991 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Landslide </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.83 </td>\n   <td style=\"text-align:left;\"> 0.38 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Elevation </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 1913 </td>\n   <td style=\"text-align:left;\"> 677 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1509 </td>\n   <td style=\"text-align:left;\"> 2420 </td>\n   <td style=\"text-align:left;\"> 3924 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Slope_Angle </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 29 </td>\n   <td style=\"text-align:left;\"> 15 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 18 </td>\n   <td style=\"text-align:left;\"> 39 </td>\n   <td style=\"text-align:left;\"> 83 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_North </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.061 </td>\n   <td style=\"text-align:left;\"> 0.24 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_NorthEast </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.12 </td>\n   <td style=\"text-align:left;\"> 0.32 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_East </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.14 </td>\n   <td style=\"text-align:left;\"> 0.34 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_SouthEast </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.15 </td>\n   <td style=\"text-align:left;\"> 0.35 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_South </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.16 </td>\n   <td style=\"text-align:left;\"> 0.36 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_SouthWest </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.15 </td>\n   <td style=\"text-align:left;\"> 0.36 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_West </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.13 </td>\n   <td style=\"text-align:left;\"> 0.34 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Profile_Curvature </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> -0.00043 </td>\n   <td style=\"text-align:left;\"> 0.0012 </td>\n   <td style=\"text-align:left;\"> -0.0066 </td>\n   <td style=\"text-align:left;\"> -0.0011 </td>\n   <td style=\"text-align:left;\"> 0.00022 </td>\n   <td style=\"text-align:left;\"> 0.0079 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Plan_Curvature </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> -0.00019 </td>\n   <td style=\"text-align:left;\"> 0.0011 </td>\n   <td style=\"text-align:left;\"> -0.0056 </td>\n   <td style=\"text-align:left;\"> -0.00071 </td>\n   <td style=\"text-align:left;\"> 0.00032 </td>\n   <td style=\"text-align:left;\"> 0.0068 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lithology_Metamorphic </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.42 </td>\n   <td style=\"text-align:left;\"> 0.49 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lithology_Sedimentary </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.24 </td>\n   <td style=\"text-align:left;\"> 0.42 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lithology_Plutonic </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.057 </td>\n   <td style=\"text-align:left;\"> 0.23 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lithology_Unconsolidated </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.29 </td>\n   <td style=\"text-align:left;\"> 0.45 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proximity_Settlement </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 904 </td>\n   <td style=\"text-align:left;\"> 764 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 328 </td>\n   <td style=\"text-align:left;\"> 1288 </td>\n   <td style=\"text-align:left;\"> 5600 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proximity_Stream </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 3.1 </td>\n   <td style=\"text-align:left;\"> 17 </td>\n   <td style=\"text-align:left;\"> 97 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proximity_Road </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 26 </td>\n   <td style=\"text-align:left;\"> 22 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 6.3 </td>\n   <td style=\"text-align:left;\"> 40 </td>\n   <td style=\"text-align:left;\"> 125 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proximity_Fault </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 828 </td>\n   <td style=\"text-align:left;\"> 1032 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 199 </td>\n   <td style=\"text-align:left;\"> 1012 </td>\n   <td style=\"text-align:left;\"> 7746 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Landuse_Vegetation </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.51 </td>\n   <td style=\"text-align:left;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Precipitation </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.15 </td>\n   <td style=\"text-align:left;\"> 0.048 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0.13 </td>\n   <td style=\"text-align:left;\"> 0.17 </td>\n   <td style=\"text-align:left;\"> 0.29 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TWI </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 7.5 </td>\n   <td style=\"text-align:left;\"> 2.3 </td>\n   <td style=\"text-align:left;\"> 3.7 </td>\n   <td style=\"text-align:left;\"> 6 </td>\n   <td style=\"text-align:left;\"> 8.3 </td>\n   <td style=\"text-align:left;\"> 23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SPI </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 0.0065 </td>\n   <td style=\"text-align:left;\"> 0.029 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0.00024 </td>\n   <td style=\"text-align:left;\"> 0.0032 </td>\n   <td style=\"text-align:left;\"> 1.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> STI </td>\n   <td style=\"text-align:left;\"> 50563 </td>\n   <td style=\"text-align:left;\"> 7.7 </td>\n   <td style=\"text-align:left;\"> 27 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:left;\"> 5.8 </td>\n   <td style=\"text-align:left;\"> 877 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nNext, we will create atrellis plot by using `ggarrange()` of [**ggpubr**](https://cran.r-project.org/web/packages/ggpubr/) package. In this way, we can see the distribution plots of different parameters at the same time.4.1 Correlation Matrix Using Corrplot\n\nBefore building a logistic regression model, it is important to ensure that the indepdent variables used are **not highly correlated** to each other. If these highly correlated independent variables are used in building a regression model by mistake, the quality of the model will be compromised. This phenomenon is known as **multicollinearity** in statistics.\n\nCorrelation matrix is commonly used to visualise the relationships between the independent variables. In this section, the [**corrplot**](https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html) package will be used to display the correlation matrix of the independent variables in *condo_resale* data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(cor(train_grids_v4[, 6:29]), diag = FALSE, order = \"AOE\",\n         col=colorRampPalette(c(\"#50a8b4\",\"#e4c838\",\"#be804f\"))(10),\n         tl.pos = \"td\", tl.cex = 0.5,tl.col = \"black\", number.cex = 0.5, method = \"number\", type = \"upper\")\n```\n\n::: {.cell-output-display}\n![](gwsmodelling_files/figure-html/unnamed-chunk-5-1.png){width=960}\n:::\n\n```{.r .cell-code}\ncorrplot(cor(train_grids_v4[,6:29]), diag = FALSE, order = \"AOE\",\n         col=colorRampPalette(c(\"#50a8b4\",\"#ffffdd\",\"#be804f\"))(10),\n         tl.pos = \"td\", tl.cex = 0.5,tl.col = \"black\", number.cex = 0.5, method = \"ellipse\", type = \"upper\")\n```\n\n::: {.cell-output-display}\n![](gwsmodelling_files/figure-html/unnamed-chunk-5-2.png){width=960}\n:::\n:::\n\n\nMatrix reorder is very important for mining the hiden structure and patter in the matrix. There are four methods in corrplot (parameter order), named \"AOE\", \"FPC\", \"hclust\", \"alphabet\". In the code chunk above, AOE order is used. It orders the variables by using the *angular order of the eigenvectors* method suggested by [Michael Friendly](https://www.datavis.ca/papers/corrgram.pdf).\n\n### 4.2 Correlation Matrix Using ggstats\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n## producing the correlation matrix\nggcorrmat(\n  data = train_grids_v4[, 6:29],  \n          matrix.type = \"upper\",\n  type = \"parametric\",\n  tr = 0.2,\n  partial = FALSE,\n  k = 2L,\n  sig.level = 0.05,\n  conf.level = 0.95,\n  bf.prior = 0.707,\n  ggcorrplot.args = list(\n     tl.cex = 10,\n     pch.cex = 5,\n     lab_size = 3\n  )) + ## modification outside `{ggstatsplot}` using `{ggplot2}` functions\n  ggplot2::theme(\n    axis.text.x = ggplot2::element_text(\n      margin = ggplot2::margin(t = 0.15, r = 0.15, b = 0.15, l = 0.15, unit = \"cm\")\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](gwsmodelling_files/figure-html/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n## Multiple Logistic Regression\n\nWe will fit a logistic regression model in order to predict the probability of a customer defaulting based on the average balance carried by the customer. The `glm` function fits generalized linear models, a class of models that includes logistic regression. The syntax of the `glm` function is similar to that of `lm`, except that we must pass the argument `family = binomial` in order to tell R to run a logistic regression rather than some other type of generalized linear model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlandslide.lr <- glm(Landslide ~ Elevation + Slope_Angle + Aspect_North + Aspect_NorthEast + Aspect_East+Aspect_SouthEast+Aspect_South + Aspect_SouthWest +Aspect_West + Profile_Curvature +Plan_Curvature + Lithology_Metamorphic+Lithology_Sedimentary + Lithology_Plutonic+Lithology_Unconsolidated + Proximity_Settlement+Proximity_Stream+Proximity_Road+Proximity_Fault+Landuse_Vegetation+Precipitation+TWI+SPI+STI, family = \"binomial\", data = train_grids_v4)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(landslide.lr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + \n    Aspect_NorthEast + Aspect_East + Aspect_SouthEast + Aspect_South + \n    Aspect_SouthWest + Aspect_West + Profile_Curvature + Plan_Curvature + \n    Lithology_Metamorphic + Lithology_Sedimentary + Lithology_Plutonic + \n    Lithology_Unconsolidated + Proximity_Settlement + Proximity_Stream + \n    Proximity_Road + Proximity_Fault + Landuse_Vegetation + Precipitation + \n    TWI + SPI + STI, family = \"binomial\", data = train_grids_v4)\n\nCoefficients:\n                           Estimate Std. Error z value Pr(>|z|)    \n(Intercept)              -2.243e+00  1.893e-01 -11.847  < 2e-16 ***\nElevation                 5.790e-05  3.517e-05   1.646 0.099718 .  \nSlope_Angle               1.706e-01  1.954e-03  87.343  < 2e-16 ***\nAspect_North             -3.510e-02  8.618e-02  -0.407 0.683821    \nAspect_NorthEast         -2.225e-01  7.213e-02  -3.084 0.002041 ** \nAspect_East              -1.617e-01  7.128e-02  -2.268 0.023321 *  \nAspect_SouthEast         -2.401e-01  6.917e-02  -3.472 0.000517 ***\nAspect_South             -1.812e-01  6.829e-02  -2.653 0.007975 ** \nAspect_SouthWest         -4.600e-02  6.949e-02  -0.662 0.508031    \nAspect_West              -4.762e-02  7.108e-02  -0.670 0.502869    \nProfile_Curvature        -6.228e+02  1.777e+01 -35.052  < 2e-16 ***\nPlan_Curvature           -5.890e+02  2.009e+01 -29.320  < 2e-16 ***\nLithology_Metamorphic     1.109e+00  9.629e-02  11.522  < 2e-16 ***\nLithology_Sedimentary     1.577e+00  1.005e-01  15.687  < 2e-16 ***\nLithology_Plutonic       -3.030e-02  8.847e-02  -0.343 0.731946    \nLithology_Unconsolidated  1.499e+00  9.792e-02  15.312  < 2e-16 ***\nProximity_Settlement      4.360e-05  2.970e-05   1.468 0.142100    \nProximity_Stream         -6.250e-03  1.593e-03  -3.924 8.72e-05 ***\nProximity_Road           -2.343e-03  1.026e-03  -2.283 0.022445 *  \nProximity_Fault          -1.315e-04  1.615e-05  -8.146 3.77e-16 ***\nLanduse_Vegetation        6.692e-01  4.060e-02  16.483  < 2e-16 ***\nPrecipitation            -3.469e+00  4.229e-01  -8.202 2.37e-16 ***\nTWI                      -1.067e-01  9.637e-03 -11.067  < 2e-16 ***\nSPI                       1.191e+00  7.010e-01   1.699 0.089396 .  \nSTI                      -5.287e-04  7.677e-04  -0.689 0.491022    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 46691  on 50562  degrees of freedom\nResidual deviance: 22929  on 50538  degrees of freedom\nAIC: 22979\n\nNumber of Fisher Scoring iterations: 7\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n100*with(summary(landslide.lr), 1 - deviance/null.deviance)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 50.89114\n```\n:::\n\n```{.r .cell-code}\nconfint(landslide.lr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWaiting for profiling to be done...\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n                                 2.5 %        97.5 %\n(Intercept)              -2.614798e+00 -1.872528e+00\nElevation                -1.100535e-05  1.268617e-04\nSlope_Angle               1.668213e-01  1.744792e-01\nAspect_North             -2.036349e-01  1.342130e-01\nAspect_NorthEast         -3.639457e-01 -8.116805e-02\nAspect_East              -3.014909e-01 -2.205432e-02\nAspect_SouthEast         -3.758587e-01 -1.047178e-01\nAspect_South             -3.152073e-01 -4.749895e-02\nAspect_SouthWest         -1.823284e-01  9.008984e-02\nAspect_West              -1.870295e-01  9.162142e-02\nProfile_Curvature        -6.577535e+02 -5.880979e+02\nPlan_Curvature           -6.284441e+02 -5.496984e+02\nLithology_Metamorphic     9.214128e-01  1.298931e+00\nLithology_Sedimentary     1.380869e+00  1.775060e+00\nLithology_Plutonic       -2.039839e-01  1.428812e-01\nLithology_Unconsolidated  1.308214e+00  1.692127e+00\nProximity_Settlement     -1.450154e-05  1.019138e-04\nProximity_Stream         -9.364838e-03 -3.120470e-03\nProximity_Road           -4.349682e-03 -3.261896e-04\nProximity_Fault          -1.631453e-04 -9.983405e-05\nLanduse_Vegetation        5.897524e-01  7.489057e-01\nPrecipitation            -4.298446e+00 -2.640479e+00\nTWI                      -1.256194e-01 -8.783854e-02\nSPI                      -1.375593e-01  2.613875e+00\nSTI                      -2.021054e-03  9.886275e-04\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl_regression(landslide.lr, intercept = TRUE) %>%\n  add_glance_source_note(\n  include = c(AIC))\n```\n:::\n\n\n### 4.5 Calculating Adjusted Odd Ratios and Confidence Intervals\n\n\n::: {.cell}\n\n```{.r .cell-code}\nOR.CI <- cbind(\"AOR\" = exp(coef(landslide.lr)),\n                       exp(confint(landslide.lr)))[-1,]\nround(OR.CI, 6)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvif(landslide.lr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Elevation              Slope_Angle             Aspect_North \n                2.362748                 1.691170                 1.497475 \n        Aspect_NorthEast              Aspect_East         Aspect_SouthEast \n                1.905428                 1.954287                 2.093957 \n            Aspect_South         Aspect_SouthWest              Aspect_West \n                2.145022                 2.027933                 1.927346 \n       Profile_Curvature           Plan_Curvature    Lithology_Metamorphic \n                1.422228                 1.487571                 7.443019 \n   Lithology_Sedimentary       Lithology_Plutonic Lithology_Unconsolidated \n                5.130757                 1.910924                 7.685545 \n    Proximity_Settlement         Proximity_Stream           Proximity_Road \n                1.787204                 1.293758                 1.818813 \n         Proximity_Fault       Landuse_Vegetation            Precipitation \n                1.058314                 1.387744                 1.297600 \n                     TWI                      SPI                      STI \n                2.201753                 1.308706                 1.308264 \n```\n:::\n:::\n\n\n### Stepwise Selection\n\nFor the initial/ first cut model, all the independent variables are put into the model. Our goal is to include a limited number of independent variables (5-15) which are all significant, without sacrificing too much on the model performance. The rationale behind not-including too many variables is that the model would be over fitted and would become unstable when tested on the validation sample. The variable reduction is done using forward or backward or stepwise variable selection procedures. We will use `blr_step_aic_both()` to shortlist predictors for our model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblr_step_aic_both(landslide.lr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStepwise Selection Method \n-------------------------\n\nCandidate Terms: \n\n1 . Elevation \n2 . Slope_Angle \n3 . Aspect_North \n4 . Aspect_NorthEast \n5 . Aspect_East \n6 . Aspect_SouthEast \n7 . Aspect_South \n8 . Aspect_SouthWest \n9 . Aspect_West \n10 . Profile_Curvature \n11 . Plan_Curvature \n12 . Lithology_Metamorphic \n13 . Lithology_Sedimentary \n14 . Lithology_Plutonic \n15 . Lithology_Unconsolidated \n16 . Proximity_Settlement \n17 . Proximity_Stream \n18 . Proximity_Road \n19 . Proximity_Fault \n20 . Landuse_Vegetation \n21 . Precipitation \n22 . TWI \n23 . SPI \n24 . STI \n\n\nVariables Entered/Removed: \n\n- Slope_Angle added \n- Profile_Curvature added \n- Plan_Curvature added \n- Landuse_Vegetation added \n- Lithology_Plutonic added \n- Precipitation added \n- Proximity_Fault added \n- TWI added \n- Lithology_Sedimentary added \n- Lithology_Unconsolidated added \n- Lithology_Metamorphic added \n- Lithology_Plutonic removed \n- Proximity_Stream added \n- Aspect_SouthEast added \n- Aspect_NorthEast added \n- Aspect_South added \n- Aspect_East added \n- SPI added \n\nNo more variables to be added or removed.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                              Stepwise Summary                               \n---------------------------------------------------------------------------\nVariable                     Method        AIC          BIC       Deviance  \n---------------------------------------------------------------------------\nSlope_Angle                 addition    27757.416    27775.078    27753.416 \nProfile_Curvature           addition    25065.141    25091.634    25059.141 \nPlan_Curvature              addition    24303.970    24339.294    24295.970 \nLanduse_Vegetation          addition    23891.260    23935.415    23881.260 \nLithology_Plutonic          addition    23677.727    23730.713    23665.727 \nPrecipitation               addition    23539.203    23601.020    23525.203 \nProximity_Fault             addition    23430.433    23501.081    23414.433 \nTWI                         addition    23337.014    23416.493    23319.014 \nLithology_Sedimentary       addition    23278.363    23366.672    23258.363 \nLithology_Unconsolidated    addition    23148.835    23245.976    23126.835 \nLithology_Metamorphic       addition    22999.689    23105.661    22975.689 \nLithology_Plutonic          removal     22997.760    23094.901    22975.760 \nProximity_Stream            addition    22989.371    23095.343    22965.371 \nAspect_SouthEast            addition    22984.054    23098.857    22958.054 \nAspect_NorthEast            addition    22979.924    23103.558    22951.924 \nAspect_South                addition    22975.790    23108.254    22945.790 \nAspect_East                 addition    22972.549    23113.844    22940.549 \nSPI                         addition    22971.964    23122.090    22937.964 \n---------------------------------------------------------------------------\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlandslide.lr %>%\n  blr_step_aic_both() %>%\n  plot()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStepwise Selection Method \n-------------------------\n\nCandidate Terms: \n\n1 . Elevation \n2 . Slope_Angle \n3 . Aspect_North \n4 . Aspect_NorthEast \n5 . Aspect_East \n6 . Aspect_SouthEast \n7 . Aspect_South \n8 . Aspect_SouthWest \n9 . Aspect_West \n10 . Profile_Curvature \n11 . Plan_Curvature \n12 . Lithology_Metamorphic \n13 . Lithology_Sedimentary \n14 . Lithology_Plutonic \n15 . Lithology_Unconsolidated \n16 . Proximity_Settlement \n17 . Proximity_Stream \n18 . Proximity_Road \n19 . Proximity_Fault \n20 . Landuse_Vegetation \n21 . Precipitation \n22 . TWI \n23 . SPI \n24 . STI \n\n\nVariables Entered/Removed: \n\n- Slope_Angle added \n- Profile_Curvature added \n- Plan_Curvature added \n- Landuse_Vegetation added \n- Lithology_Plutonic added \n- Precipitation added \n- Proximity_Fault added \n- TWI added \n- Lithology_Sedimentary added \n- Lithology_Unconsolidated added \n- Lithology_Metamorphic added \n- Lithology_Plutonic removed \n- Proximity_Stream added \n- Aspect_SouthEast added \n- Aspect_NorthEast added \n- Aspect_South added \n- Aspect_East added \n- SPI added \n\nNo more variables to be added or removed.\n```\n:::\n\n::: {.cell-output-display}\n![](gwsmodelling_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n### Model Update\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlandslide.lr_modified <- glm(Landslide ~ Slope_Angle + Aspect_SouthEast + Aspect_NorthEast + Aspect_South + Aspect_East + Profile_Curvature +Plan_Curvature +Lithology_Metamorphic+Lithology_Unconsolidated+ Lithology_Sedimentary+Proximity_Stream+Landuse_Vegetation+TWI+SPI, family = \"binomial\", data = train_grids_v4)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(landslide.lr_modified)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Landslide ~ Slope_Angle + Aspect_SouthEast + Aspect_NorthEast + \n    Aspect_South + Aspect_East + Profile_Curvature + Plan_Curvature + \n    Lithology_Metamorphic + Lithology_Unconsolidated + Lithology_Sedimentary + \n    Proximity_Stream + Landuse_Vegetation + TWI + SPI, family = \"binomial\", \n    data = train_grids_v4)\n\nCoefficients:\n                           Estimate Std. Error z value Pr(>|z|)    \n(Intercept)              -2.989e+00  1.226e-01 -24.386  < 2e-16 ***\nSlope_Angle               1.699e-01  1.938e-03  87.672  < 2e-16 ***\nAspect_SouthEast         -1.803e-01  5.117e-02  -3.523 0.000426 ***\nAspect_NorthEast         -2.012e-01  5.559e-02  -3.620 0.000295 ***\nAspect_South             -1.292e-01  4.982e-02  -2.593 0.009514 ** \nAspect_East              -1.277e-01  5.427e-02  -2.353 0.018603 *  \nProfile_Curvature        -6.192e+02  1.760e+01 -35.183  < 2e-16 ***\nPlan_Curvature           -5.746e+02  1.953e+01 -29.417  < 2e-16 ***\nLithology_Metamorphic     1.265e+00  7.068e-02  17.898  < 2e-16 ***\nLithology_Unconsolidated  1.657e+00  7.387e-02  22.433  < 2e-16 ***\nLithology_Sedimentary     1.797e+00  7.644e-02  23.510  < 2e-16 ***\nProximity_Stream         -2.702e-03  1.486e-03  -1.818 0.069028 .  \nLanduse_Vegetation        6.586e-01  3.592e-02  18.336  < 2e-16 ***\nTWI                      -1.088e-01  9.222e-03 -11.796  < 2e-16 ***\nSPI                       7.985e-01  6.022e-01   1.326 0.184876    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 46691  on 50562  degrees of freedom\nResidual deviance: 23127  on 50548  degrees of freedom\nAIC: 23157\n\nNumber of Fisher Scoring iterations: 7\n```\n:::\n\n```{.r .cell-code}\nvif(landslide.lr_modified)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Slope_Angle         Aspect_SouthEast         Aspect_NorthEast \n                1.674417                 1.157345                 1.134779 \n            Aspect_South              Aspect_East        Profile_Curvature \n                1.164675                 1.137678                 1.397392 \n          Plan_Curvature    Lithology_Metamorphic Lithology_Unconsolidated \n                1.410249                 4.035544                 4.405966 \n   Lithology_Sedimentary         Proximity_Stream       Landuse_Vegetation \n                3.037511                 1.138366                 1.096464 \n                     TWI                      SPI \n                2.048050                 1.000892 \n```\n:::\n:::\n\n\n## Model Fit Statistics\n\nModel fit statistics are available to assess how well the model fits the data and to compare two different models.The output includes likelihood ratio test, AIC, BIC and a host of pseudo r-squared measures. You can read more about pseudo r-squared at <https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/>.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblr_model_fit_stats(landslide.lr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                               Model Fit Statistics                                 \n-----------------------------------------------------------------------------------\nLog-Lik Intercept Only:     -23345.502    Log-Lik Full Model:            -11464.710 \nDeviance(50538):             22929.420    LR(24):                         23761.584 \n                                          Prob > LR:                          0.000 \nMCFadden's R2                    0.509    McFadden's Adj R2:                  0.508 \nML (Cox-Snell) R2:               0.375    Cragg-Uhler(Nagelkerke) R2:         0.622 \nMcKelvey & Zavoina's R2:         0.684    Efron's R2:                         0.619 \nCount R2:                        0.930    Adj Count R2:                       0.598 \nBIC:                         23200.195    AIC:                            22979.420 \n-----------------------------------------------------------------------------------\n```\n:::\n:::\n\n\nCompared with the basic model,\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblr_model_fit_stats(landslide.lr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                               Model Fit Statistics                                 \n-----------------------------------------------------------------------------------\nLog-Lik Intercept Only:     -23345.502    Log-Lik Full Model:            -11464.710 \nDeviance(50538):             22929.420    LR(24):                         23761.584 \n                                          Prob > LR:                          0.000 \nMCFadden's R2                    0.509    McFadden's Adj R2:                  0.508 \nML (Cox-Snell) R2:               0.375    Cragg-Uhler(Nagelkerke) R2:         0.622 \nMcKelvey & Zavoina's R2:         0.684    Efron's R2:                         0.619 \nCount R2:                        0.930    Adj Count R2:                       0.598 \nBIC:                         23200.195    AIC:                            22979.420 \n-----------------------------------------------------------------------------------\n```\n:::\n:::\n\n\n## Model Validation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblr_confusion_matrix(landslide.lr, cutoff = 0.5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nConfusion Matrix and Statistics \n\n          Reference\nPrediction     0     1\n         0  6548  1292\n         1  2235 40488\n\n                Accuracy : 0.9302 \n     No Information Rate : 0.1737 \n\n                   Kappa : 0.7462 \n\nMcNemars's Test P-Value  : 0.0000 \n\n             Sensitivity : 0.9691 \n             Specificity : 0.7455 \n          Pos Pred Value : 0.9477 \n          Neg Pred Value : 0.8352 \n              Prevalence : 0.8263 \n          Detection Rate : 0.8007 \n    Detection Prevalence : 0.8449 \n       Balanced Accuracy : 0.8573 \n               Precision : 0.9477 \n                  Recall : 0.9691 \n\n        'Positive' Class : 1\n```\n:::\n:::\n\n\n### Hosmer Lemeshow Test\n\nHosmer and Lemeshow developed a goodness-of-fit test for logistic regression models with binary responses. The test involves dividing the data into approximately ten groups of roughly equal size based on the percentiles of the estimated probabilities. The observations are sorted in increasing order of their estimated probability of having an even outcome. The discrepancies between the observed and expected number of observations in these groups are summarized by the Pearson chi-square statistic, which is then compared to chi-square distribution with t degrees of freedom, where t is the number of groups minus 2. Lower values of Goodness-of-fit are preferred.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblr_test_hosmer_lemeshow(landslide.lr_modified)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Partition for the Hosmer & Lemeshow Test            \n--------------------------------------------------------------\n                        def = 1                 def = 0        \nGroup    Total    Observed    Expected    Observed    Expected \n--------------------------------------------------------------\n  1      5057       439        789.34       4618      4267.66  \n  2      5056       2216      2432.89       2840      2623.11  \n  3      5056       4303      4058.69       753        997.31  \n  4      5056       4916      4634.39       140        421.61  \n  5      5057       5024      4841.37        33        215.63  \n  6      5056       5043      4933.14        13        122.86  \n  7      5056       5043      4984.03        13        71.97   \n  8      5056       5046      5016.07        10        39.93   \n  9      5056       5032      5037.52        24        18.48   \n 10      5057       4718      5052.56       339         4.44   \n--------------------------------------------------------------\n\n     Goodness of Fit Test      \n------------------------------\nChi-Square    DF    Pr > ChiSq \n------------------------------\n26056.1816    8       0.0000   \n------------------------------\n```\n:::\n:::\n\n\n### ROC Curve\n\nROC curve is a graphical representation of the validity of cut-offs for a logistic regression model. The ROC curve is plotted using the sensitivity and specificity for all possible cut-offs, i.e., all the probability scores. The graph is plotted using sensitivity on the y-axis and 1-specificity on the x-axis. Any point on the ROC curve represents a sensitivity X (1-specificity) measure corresponding to a cut-off. The area under the ROC curve is used as a validation measure for the model -- the bigger the area the better is the model.\n\n```{r]}\n#| eval: false\npredicted <- predict(landslide.lr, train_grids_v4[, 6:29], type=\"response\")\nroc_curve <- roc(train_grids_v4$Landslide, predicted)\nplot(roc_curve, main = \"ROC Curve (No Calibration Model)\")\nauc_value <- auc(roc_curve)\ncat(\"AUC:\", auc_value, \"\\n\")\n\npredicted <- predict(landslide.lr_modified, train_grids_v4[, 6:29], type=\"response\")\nroc_curve <- roc(train_grids_v4$Landslide, predicted)\nplot(roc_curve, main = \"ROC Curve (Stepwise Model)\")\nauc_value <- auc(roc_curve)\ncat(\"AUC:\", auc_value, \"\\n\")\n```\n\n#### Influence Diagnostics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblr_plot_diag_influence(landslide.lr_modified)\n```\n\n::: {.cell-output-display}\n![](gwsmodelling_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n#### Fitted Values Diagnostics\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblr_plot_diag_fit(landslide.lr_modified)\n```\n\n::: {.cell-output-display}\n![](gwsmodelling_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n## Weight of Evidence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"Information\")\n\nIV <- create_infotables(data=train_grids_v4[, 5:29],\n                        valid=train_grids_v4[, 5:29],\n                        y=\"Landslide\")\nkable(IV$Summary, row.names=FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:right;\"> IV </th>\n   <th style=\"text-align:right;\"> PENALTY </th>\n   <th style=\"text-align:right;\"> AdjIV </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Slope_Angle </td>\n   <td style=\"text-align:right;\"> 5.3574828 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 5.3574828 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> TWI </td>\n   <td style=\"text-align:right;\"> 0.5119619 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.5119619 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Elevation </td>\n   <td style=\"text-align:right;\"> 0.3270770 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.3270770 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proximity_Settlement </td>\n   <td style=\"text-align:right;\"> 0.2073722 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.2073722 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proximity_Road </td>\n   <td style=\"text-align:right;\"> 0.2060752 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.2060752 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Profile_Curvature </td>\n   <td style=\"text-align:right;\"> 0.1481448 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.1481448 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Plan_Curvature </td>\n   <td style=\"text-align:right;\"> 0.1469663 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.1469663 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Precipitation </td>\n   <td style=\"text-align:right;\"> 0.1097135 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.1097135 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lithology_Unconsolidated </td>\n   <td style=\"text-align:right;\"> 0.1047331 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.1047331 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proximity_Fault </td>\n   <td style=\"text-align:right;\"> 0.0931591 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0931591 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lithology_Sedimentary </td>\n   <td style=\"text-align:right;\"> 0.0770191 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0770191 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Landuse_Vegetation </td>\n   <td style=\"text-align:right;\"> 0.0758787 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0758787 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proximity_Stream </td>\n   <td style=\"text-align:right;\"> 0.0606072 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0606072 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lithology_Metamorphic </td>\n   <td style=\"text-align:right;\"> 0.0243440 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0243440 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Lithology_Plutonic </td>\n   <td style=\"text-align:right;\"> 0.0184281 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0184281 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_East </td>\n   <td style=\"text-align:right;\"> 0.0028829 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0028829 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_SouthEast </td>\n   <td style=\"text-align:right;\"> 0.0025985 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0025985 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_South </td>\n   <td style=\"text-align:right;\"> 0.0020174 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0020174 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_North </td>\n   <td style=\"text-align:right;\"> 0.0019081 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0019081 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_West </td>\n   <td style=\"text-align:right;\"> 0.0011630 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0011630 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> STI </td>\n   <td style=\"text-align:right;\"> 0.0008136 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0008136 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SPI </td>\n   <td style=\"text-align:right;\"> 0.0007769 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0007769 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_SouthWest </td>\n   <td style=\"text-align:right;\"> 0.0000422 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0000422 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Aspect_NorthEast </td>\n   <td style=\"text-align:right;\"> 0.0000023 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0000023 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### **Spatial Interpolation**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvaltellina_boundary <- st_union(valtellina) %>% st_sf()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(terra)\ngrid <- terra::rast(valtellina_boundary, nrows = 10000, ncols = 15000)\nxy <- terra::xyFromCell(grid, 1:ncell(grid))\ncoop <- st_as_sf(as.data.frame(xy), coords = c(\"x\", \"y\"),\n              crs = st_crs(valtellina_boundary))\ncoop <- st_filter(coop, valtellina_boundary)\nqtm(coop)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Voronoi\nv <- terra::voronoi(x = terra::vect(train.res.sf), bnd = valtellina_boundary)\nplot(v)\npoints(vect(train.res.sf), cex = 0.5)\n\n# Prediction\nv <- st_as_sf(v)\ntm_shape(v) +\n  tm_fill(col = \"MLR_RES\", palette = \"viridis\")+\n  tm_layout(\n    legend.outside=TRUE\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresp <- st_intersection(v, coop)\nresp$pred <- resp$MLR_RES\n\npred_mean <- terra::rasterize(resp, grid, field = \"pred\", fun = \"mean\")\ntm_shape(pred_mean) + \n  tm_raster(palette = \"plasma\")+\n  tm_layout(\n    legend.outside=TRUE\n  )\n```\n:::\n\n\n### IDW: Inverse Distance Weighting\n\nIn the IDW method, values at unsampled locations are estimated as the weighted average of values from the rest of locations with weights inversely proportional to the distance between the unsampled and the sampled locations.\n\nWe can apply the IDW method with the [`gstat()`](https://rdrr.io/pkg/gstat/man/gstat.html) function of **gstat** and the following arguments:\n\n-   `formula`: `vble ~ 1` to have an intercept only model,\n\n-   `nmax`: number of neighbors is set equal to the total number of locations,\n\n-   `idp`: inverse distance power is set to `idp = 1` to have weights with β=1�=1.\n\nThen, we use the [`predict()`](https://rdrr.io/pkg/terra/man/predict.html) function to obtain the predictions and **tmap** to show the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gstat)\nres <- gstat(formula = MLR_RES ~ 1, locations = train.res.sf,\n             nmax = nrow(train.res.sf), # use all the neighbors locations\n             set = list(idp = 1)) # beta = 1 \n\nresp <- predict(res, coop)\nresp$x <- st_coordinates(resp)[,1]\nresp$y <- st_coordinates(resp)[,2]\nresp$pred <- resp$var1.pred\n\npred <- terra::rasterize(resp, grid, field = \"pred\", fun = \"mean\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(pred) + \n  tm_raster(palette = \"viridis\")+\n  tm_layout(\n    legend.outside=TRUE\n  )\n```\n:::\n",
    "supporting": [
      "gwsmodelling_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}