<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Khant Min Naing">
<meta name="author" content="Ann Mei Yi Victoria Grace">
<meta name="dcterms.date" content="2024-02-19">

<title>Slope-Based Stratified Sampling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="logo.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo_name.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./studyarea.html" rel="" target="">
 <span class="menu-text">Study Area</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./methodology.html" rel="" target="">
 <span class="menu-text">Methodology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./project.html" rel="" target="">
 <span class="menu-text">EDA</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-model-development" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Model Development</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-model-development">    
        <li>
    <a class="dropdown-item" href="./gwsmodelling.html" rel="" target="">
 <span class="dropdown-text">Parametric Testing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./slopesampling.html" rel="" target="">
 <span class="dropdown-text">Slope Sampling</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./research.html" rel="" target="">
 <span class="menu-text">Research Paper</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#slope-based-stratified-sampling" id="toc-slope-based-stratified-sampling" class="nav-link active" data-scroll-target="#slope-based-stratified-sampling">Slope-Based Stratified Sampling</a>
  <ul class="collapse">
  <li><a href="#import-packages" id="toc-import-packages" class="nav-link" data-scroll-target="#import-packages">1.0 Import Packages</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">2.0 Import Data</a></li>
  <li><a href="#slope-sampling" id="toc-slope-sampling" class="nav-link" data-scroll-target="#slope-sampling">3.0 Slope Sampling</a>
  <ul class="collapse">
  <li><a href="#calculating-quartiles" id="toc-calculating-quartiles" class="nav-link" data-scroll-target="#calculating-quartiles">3.1 Calculating Quartiles</a></li>
  <li><a href="#subseting-dataset-into-quartile-based-samples" id="toc-subseting-dataset-into-quartile-based-samples" class="nav-link" data-scroll-target="#subseting-dataset-into-quartile-based-samples">3.2 Subseting Dataset into Quartile-based Samples</a></li>
  <li><a href="#plotting-slope-stratified-datasets" id="toc-plotting-slope-stratified-datasets" class="nav-link" data-scroll-target="#plotting-slope-stratified-datasets">3.3 Plotting Slope-Stratified Datasets</a></li>
  <li><a href="#creating-correlation-matrix" id="toc-creating-correlation-matrix" class="nav-link" data-scroll-target="#creating-correlation-matrix">3.4 Creating Correlation Matrix</a></li>
  </ul></li>
  <li><a href="#logistic-regression-modelling" id="toc-logistic-regression-modelling" class="nav-link" data-scroll-target="#logistic-regression-modelling">4.0 Logistic Regression Modelling</a>
  <ul class="collapse">
  <li><a href="#logistic-regression-model-1-slope-cut-off-1st-quartile" id="toc-logistic-regression-model-1-slope-cut-off-1st-quartile" class="nav-link" data-scroll-target="#logistic-regression-model-1-slope-cut-off-1st-quartile">4.1 Logistic Regression Model 1 (Slope Cut-off = 1st Quartile)</a></li>
  <li><a href="#logistic-regression-model-2-slope-cut-off-2nd-quartile" id="toc-logistic-regression-model-2-slope-cut-off-2nd-quartile" class="nav-link" data-scroll-target="#logistic-regression-model-2-slope-cut-off-2nd-quartile">4.2 Logistic Regression Model 2 (Slope Cut-off = 2nd Quartile)</a></li>
  <li><a href="#logistic-regression-model-3-slope-cut-off-3rd-quartile" id="toc-logistic-regression-model-3-slope-cut-off-3rd-quartile" class="nav-link" data-scroll-target="#logistic-regression-model-3-slope-cut-off-3rd-quartile">4.3 Logistic Regression Model 3 (Slope Cut-off = 3rd Quartile)</a></li>
  <li><a href="#logistic-regression-model-4-slope-cut-off-4th-quartile" id="toc-logistic-regression-model-4-slope-cut-off-4th-quartile" class="nav-link" data-scroll-target="#logistic-regression-model-4-slope-cut-off-4th-quartile">4.4 Logistic Regression Model 4 (Slope Cut-off = 4th Quartile)</a></li>
  <li><a href="#logistic-regression-model-5-slope-cut-off-25" id="toc-logistic-regression-model-5-slope-cut-off-25" class="nav-link" data-scroll-target="#logistic-regression-model-5-slope-cut-off-25">4.5 Logistic Regression Model 5 (Slope Cut-off = 25)</a></li>
  <li><a href="#logistic-regression-model-6-slope-cut-off-20" id="toc-logistic-regression-model-6-slope-cut-off-20" class="nav-link" data-scroll-target="#logistic-regression-model-6-slope-cut-off-20">4.6 Logistic Regression Model 6 (Slope Cut-off = 20)</a></li>
  <li><a href="#logistic-regression-model-7-slope-cut-off-15" id="toc-logistic-regression-model-7-slope-cut-off-15" class="nav-link" data-scroll-target="#logistic-regression-model-7-slope-cut-off-15">4.7 Logistic Regression Model 7 (Slope Cut-off = 15)</a></li>
  </ul></li>
  <li><a href="#geographically-weighted-logistic-regression" id="toc-geographically-weighted-logistic-regression" class="nav-link" data-scroll-target="#geographically-weighted-logistic-regression">5.0 Geographically Weighted Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">20%</a></li>
  <li><a href="#calculating-adaptive-bandwidth" id="toc-calculating-adaptive-bandwidth" class="nav-link" data-scroll-target="#calculating-adaptive-bandwidth">5.1 Calculating Adaptive Bandwidth</a></li>
  <li><a href="#building-geographically-weighted-logistic-regression-model" id="toc-building-geographically-weighted-logistic-regression-model" class="nav-link" data-scroll-target="#building-geographically-weighted-logistic-regression-model">5.2 Building Geographically Weighted Logistic Regression Model</a></li>
  <li><a href="#model-summary" id="toc-model-summary" class="nav-link" data-scroll-target="#model-summary">5.3 Model Summary</a></li>
  <li><a href="#spatial-interpolation" id="toc-spatial-interpolation" class="nav-link" data-scroll-target="#spatial-interpolation">Spatial Interpolation</a></li>
  <li><a href="#closest-observation" id="toc-closest-observation" class="nav-link" data-scroll-target="#closest-observation"><strong>Closest Observation</strong></a></li>
  <li><a href="#idw-inverse-distance-weighting" id="toc-idw-inverse-distance-weighting" class="nav-link" data-scroll-target="#idw-inverse-distance-weighting">IDW: Inverse Distance Weighting</a></li>
  <li><a href="#nearest-neighbors" id="toc-nearest-neighbors" class="nav-link" data-scroll-target="#nearest-neighbors"><strong>Nearest neighbors</strong></a></li>
  <li><a href="#ensemble-approach" id="toc-ensemble-approach" class="nav-link" data-scroll-target="#ensemble-approach"><strong>Ensemble approach</strong></a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">Cross-Validation</a></li>
  </ul></li>
  <li><a href="#page-break" id="toc-page-break" class="nav-link" data-scroll-target="#page-break">Page Break</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Slope-Based Stratified Sampling</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">sf</div>
    <div class="quarto-category">gwmodel</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Khant Min Naing </p>
             <p>Ann Mei Yi Victoria Grace </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 19, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 2, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="slope-based-stratified-sampling" class="level1">
<h1>Slope-Based Stratified Sampling</h1>
<section id="import-packages" class="level2">
<h2 class="anchored" data-anchor-id="import-packages">1.0 Import Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sp, sf, st, spdep, terra, raster, spatstat, tmap, devtools,vtable,ggplot2, corrplot, ggstats, ggstatsplot, GWmodel, tidyverse, gtsummary, blorr, car, ISLR, klaR,pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">2.0 Import Data</h2>
<p>We will import datasets used for this sampling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>valtellina <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="at">dsn =</span> <span class="st">"./data/vector"</span>, <span class="at">layer =</span> <span class="st">"valtellina"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>train_grids_v4 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/IS485-Landslide/data/aspatial/train_grid_v4.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="slope-sampling" class="level2">
<h2 class="anchored" data-anchor-id="slope-sampling">3.0 Slope Sampling</h2>
<section id="calculating-quartiles" class="level3">
<h3 class="anchored" data-anchor-id="calculating-quartiles">3.1 Calculating Quartiles</h3>
<p>First, we will extract the <strong><code>Slope_Angle</code></strong> column from the <strong><code>train_grids_v4</code></strong> data frame and assigning it to the variable <strong><code>slope_angle</code></strong>.</p>
<p>Next we will calculate the quartiles of the <strong><code>slope_angle</code></strong> data such as minimum (0th percentile), first quartile (25th percentile), median (50th percentile), third quartile (75th percentile), and maximum (100th percentile). This helps us understand the distribution of slope angles in the data set.</p>
<p>The <strong><code>quantile</code></strong> function in R calculates the specified quantiles of a data set. The <strong><code>probs</code></strong> argument specifies the probabilities for which quantiles are required, and <strong><code>seq(0, 1, 1/4)</code></strong> generates a sequence of numbers from 0 to 1 in increments of 1/4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>slope_angle <span class="ot">&lt;-</span> train_grids_v4<span class="sc">$</span>Slope_Angle</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(slope_angle, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      0%      25%      50%      75%     100% 
 0.00000 18.41368 30.34639 38.54599 82.91669 </code></pre>
</div>
</div>
</section>
<section id="subseting-dataset-into-quartile-based-samples" class="level3">
<h3 class="anchored" data-anchor-id="subseting-dataset-into-quartile-based-samples">3.2 Subseting Dataset into Quartile-based Samples</h3>
<p>Based on the quartile values that we have calculated, we will now subset the original dataset into four namely <code>sample_Q1</code>, <code>sample_Q2</code>, <code>sample_Q3</code> &amp; <code>sample_Q4</code>.</p>
<ul>
<li><p>For <strong><code>sample_Q1</code></strong>, we select all rows where <strong><code>Slope_Angle</code></strong> is less than 18.41368. This represents the first quartile of the data.</p></li>
<li><p>For <strong><code>sample_Q2</code></strong>, we select all rows in <strong><code>new_train</code></strong> where <strong><code>Slope_Angle</code></strong> is less than 30.34639.</p></li>
<li><p>For <strong><code>sample_Q3</code></strong>, we select all rows where <strong><code>Slope_Angle</code></strong> is less than 38.54599.</p></li>
<li><p>Finally, for <strong><code>sample_Q4</code></strong>, we select all rows where <strong><code>Slope_Angle</code></strong> is less than or equal to 82.91669.</p></li>
</ul>
<p>Finally, I’m using the <strong><code>nrow</code></strong> function to count the number of rows in each subset. This gives us the number of sample size in each quartile.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sample_Q1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(train_grids_v4,Slope_Angle <span class="sc">&lt;</span> <span class="fl">18.41368</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>new_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(train_grids_v4,Slope_Angle <span class="sc">&gt;=</span> <span class="fl">18.41368</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>sample_Q2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(new_train,Slope_Angle <span class="sc">&lt;</span> <span class="fl">30.34639</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>new_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(new_train,Slope_Angle <span class="sc">&gt;=</span> <span class="fl">30.34639</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>sample_Q3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(new_train,Slope_Angle <span class="sc">&lt;</span> <span class="fl">38.54599</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>new_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(new_train,Slope_Angle <span class="sc">&gt;=</span> <span class="fl">38.54599</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>sample_Q4 <span class="ot">&lt;-</span> <span class="fu">subset</span>(new_train,Slope_Angle <span class="sc">&lt;=</span> <span class="fl">82.91669</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_Q1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12641</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_Q2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12640</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_Q3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12641</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_Q4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12641</code></pre>
</div>
</div>
</section>
<section id="plotting-slope-stratified-datasets" class="level3">
<h3 class="anchored" data-anchor-id="plotting-slope-stratified-datasets">3.3 Plotting Slope-Stratified Datasets</h3>
<p>To understand the distribution of slope angle in each sample - <strong><code>sample_Q1</code></strong>, <strong><code>sample_Q2</code></strong>, <strong><code>sample_Q3</code></strong>, and <strong><code>sample_Q4</code></strong>, we will plot four histograms as below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sample_Q1, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Slope_Angle</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#e9531e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sample_Q2, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Slope_Angle</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#e9531e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sample_Q3, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Slope_Angle</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#e9531e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sample_Q4, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Slope_Angle</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#e9531e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="creating-correlation-matrix" class="level3">
<h3 class="anchored" data-anchor-id="creating-correlation-matrix">3.4 Creating Correlation Matrix</h3>
<p>Next, we will use the <strong><code>ggcorrmat</code></strong> function from the <strong><code>ggstatsplot</code></strong> package to create a correlation matrix for each dataset.</p>
<ul>
<li><p>We set <strong><code>matrix.type</code></strong> to “upper”, which means it will only show the upper triangle of the correlation matrix.</p></li>
<li><p>We set <strong><code>type</code></strong> to “parametric”, which means it will calculating the correlations using a parametric method (Pearson’s correlation).</p></li>
<li><p>We set <strong><code>k</code></strong> to 2, <strong><code>sig.level</code></strong> to 0.05, <strong><code>conf.level</code></strong> to 0.95, and <strong><code>bf.prior</code></strong> to 0.707. These are parameters for the statistical tests that <strong><code>ggcorrmat</code></strong> performs</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrmat</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sample_Q6[, <span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>],  </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">matrix.type =</span> <span class="st">"upper"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"parametric"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tr =</span> <span class="fl">0.2</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">partial =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> 2L,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">bf.prior =</span> <span class="fl">0.707</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggcorrplot.args =</span> <span class="fu">list</span>(</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">tl.cex =</span> <span class="dv">10</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch.cex =</span> <span class="dv">5</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">lab_size =</span> <span class="dv">3</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span> </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">t =</span> <span class="fl">0.15</span>, <span class="at">r =</span> <span class="fl">0.15</span>, <span class="at">b =</span> <span class="fl">0.15</span>, <span class="at">l =</span> <span class="fl">0.15</span>, <span class="at">unit =</span> <span class="st">"cm"</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Screenshot 2024-02-19 at 3.12.02 PM.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Q1</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Screenshot 2024-02-19 at 3.13.20 PM.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Q2</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Screenshot 2024-02-19 at 3.15.40 PM.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Q3</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Screenshot 2024-02-19 at 3.10.01 PM.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Q4</figcaption>
</figure>
</div>
</section>
</section>
<section id="logistic-regression-modelling" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression-modelling">4.0 Logistic Regression Modelling</h2>
<p>In this section, we will model a logistic regression model for each data sample.</p>
<p>Before wee build the model, we will need to split each data sample into training data and testing data. This is a common practice in machine learning and statistical modeling, where a model is trained on the training set and then evaluated on the test set. We use <code>sample</code> function to carry out test-train split with 7:3 ratio, resulting in four training sets (<strong><code>Q1_train</code></strong>, <strong><code>Q2_train</code></strong>, <strong><code>Q3_train</code></strong>, <strong><code>Q4_train</code></strong>) and four test sets (<strong><code>Q1_test</code></strong>, <strong><code>Q2_test</code></strong>, <strong><code>Q3_test</code></strong>, <strong><code>Q4_test</code></strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q1), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.30</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Q1_train  <span class="ot">&lt;-</span> sample_Q1[sample, ]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>Q1_test   <span class="ot">&lt;-</span> sample_Q1[<span class="sc">!</span>sample, ]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q2), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.30</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>Q2_train  <span class="ot">&lt;-</span> sample_Q2[sample, ]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>Q2_test   <span class="ot">&lt;-</span> sample_Q2[<span class="sc">!</span>sample, ]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q3), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.30</span>))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>Q3_train  <span class="ot">&lt;-</span> sample_Q3[sample, ]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>Q3_test   <span class="ot">&lt;-</span> sample_Q3[<span class="sc">!</span>sample, ]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q4), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.30</span>))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>Q4_train  <span class="ot">&lt;-</span> sample_Q4[sample, ]</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>Q4_test   <span class="ot">&lt;-</span> sample_Q4[<span class="sc">!</span>sample, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we have split the test and train for each data sample, we will now proceed to build a Logistic Regression (LR) model for each sampling dataset. We will fit the model using the <strong><code>glm</code></strong> function from <strong>stats</strong> package. It is used to fit generalized linear models, specified by giving a symbolic description of the linear predictor and a description of the error distribution.</p>
<section id="logistic-regression-model-1-slope-cut-off-1st-quartile" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-model-1-slope-cut-off-1st-quartile">4.1 Logistic Regression Model 1 (Slope Cut-off = 1st Quartile)</h3>
<p>First LR model, <code>log_model_1</code> is fitted using <code>Q1_train</code> dataset with specifications as follows:</p>
<ul>
<li><p>The model is predicting the <strong><code>Landslide</code></strong> variable based on a number of predictor variables, including <strong><code>Elevation</code></strong>, <strong><code>Slope_Angle</code></strong>, <strong><code>Aspect_North</code></strong>, <strong><code>Aspect_NorthEast</code></strong>, <strong><code>Aspect_East</code></strong>, <strong><code>Aspect_SouthEast</code></strong>, <strong><code>Aspect_South</code></strong>, <strong><code>Aspect_SouthWest</code></strong>, <strong><code>Aspect_West</code></strong>, <strong><code>Profile_Curvature</code></strong>, <strong><code>Plan_Curvature</code></strong>, <strong><code>Lithology_Metamorphic</code></strong>, <strong><code>Lithology_Sedimentary</code></strong>, <strong><code>Lithology_Plutonic</code></strong>, <strong><code>Lithology_Unconsolidated</code></strong>, <strong><code>Proximity_Settlement</code></strong>, <strong><code>Proximity_Stream</code></strong>, <strong><code>Proximity_Road</code></strong>, <strong><code>Proximity_Fault</code></strong>, <strong><code>Landuse_Vegetation</code></strong>, <strong><code>Precipitation</code></strong>, <strong><code>TWI</code></strong>, <strong><code>SPI</code></strong>, and <strong><code>STI</code></strong>.</p></li>
<li><p>The <strong><code>family</code></strong> argument is set to <strong><code>"binomial"</code></strong> to fit a binomial logistic regression model.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>log_model_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic<span class="sc">+</span>Lithology_Unconsolidated <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> Q1_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generating-model-summary" class="level4">
<h4 class="anchored" data-anchor-id="generating-model-summary">4.1.1 Generating Model Summary</h4>
<p>Once we have fitted the model, we will generate a summary of the model using <code>summary()</code> function. The model summary give us useful information about the model, including the coefficients of the predictor variables, the standard errors of these coefficients, and the statistical significance of each predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + 
    Aspect_NorthEast + Aspect_East + Aspect_SouthEast + Aspect_South + 
    Aspect_SouthWest + Aspect_West + Profile_Curvature + Plan_Curvature + 
    Lithology_Metamorphic + Lithology_Sedimentary + Lithology_Plutonic + 
    Lithology_Unconsolidated + Proximity_Settlement + Proximity_Stream + 
    Proximity_Road + Proximity_Fault + Landuse_Vegetation + Precipitation + 
    TWI + SPI + STI, family = "binomial", data = Q1_train)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -2.556e+00  3.111e-01  -8.218  &lt; 2e-16 ***
Elevation                -2.048e-04  5.595e-05  -3.661 0.000251 ***
Slope_Angle               2.518e-01  6.525e-03  38.589  &lt; 2e-16 ***
Aspect_North              4.673e-03  1.475e-01   0.032 0.974720    
Aspect_NorthEast         -2.675e-01  1.232e-01  -2.172 0.029863 *  
Aspect_East              -4.391e-01  1.234e-01  -3.558 0.000373 ***
Aspect_SouthEast         -4.797e-01  1.191e-01  -4.029 5.60e-05 ***
Aspect_South             -3.531e-01  1.150e-01  -3.070 0.002140 ** 
Aspect_SouthWest         -2.760e-01  1.171e-01  -2.357 0.018420 *  
Aspect_West              -3.009e-01  1.180e-01  -2.549 0.010794 *  
Profile_Curvature        -9.020e+02  3.419e+01 -26.382  &lt; 2e-16 ***
Plan_Curvature           -7.776e+02  4.085e+01 -19.036  &lt; 2e-16 ***
Lithology_Metamorphic     7.321e-01  1.741e-01   4.204 2.62e-05 ***
Lithology_Sedimentary     1.149e+00  1.795e-01   6.400 1.55e-10 ***
Lithology_Plutonic       -8.843e-01  1.627e-01  -5.435 5.47e-08 ***
Lithology_Unconsolidated  1.286e+00  1.743e-01   7.382 1.56e-13 ***
Proximity_Settlement      7.522e-06  5.152e-05   0.146 0.883932    
Proximity_Stream         -6.666e-03  2.685e-03  -2.483 0.013045 *  
Proximity_Road           -1.658e-03  1.830e-03  -0.906 0.364696    
Proximity_Fault          -1.756e-05  3.111e-05  -0.565 0.572376    
Landuse_Vegetation        6.213e-01  6.659e-02   9.330  &lt; 2e-16 ***
Precipitation            -6.711e+00  7.422e-01  -9.042  &lt; 2e-16 ***
TWI                      -6.276e-02  1.402e-02  -4.476 7.61e-06 ***
SPI                       1.836e+00  1.146e+00   1.602 0.109070    
STI                      -8.197e-04  1.300e-03  -0.631 0.528255    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 11965.2  on 8862  degrees of freedom
Residual deviance:  7164.9  on 8838  degrees of freedom
AIC: 7214.9

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="calculating-percentage-of-deviance" class="level4">
<h4 class="anchored" data-anchor-id="calculating-percentage-of-deviance">4.1.2 Calculating Percentage of Deviance</h4>
<p>Next, we will calculate the percentage of deviance explained by the model. The deviance is a measure of how well the model fits the data, with lower values indicating a better fit. The null deviance is the deviance of a model with no predictors, i.e., a model that only includes the intercept. So, this calculation gives me the percentage reduction in deviance when going from the null model to the current model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span><span class="fu">with</span>(<span class="fu">summary</span>(log_model_1), <span class="dv">1</span> <span class="sc">-</span> deviance<span class="sc">/</span>null.deviance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40.11882</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix">4.1.3 Confusion Matrix</h4>
<p>Next, we will generate a confusion matrix for the model predictions using <code>blr_confusion_matrix()</code> function from <code>blorr</code> package. The confusion matrix shows the number of true positives, true negatives, false positives, and false negatives. The <strong><code>cutoff</code></strong> argument is set to 0.5, which means that predicted probabilities greater than or equal to 0.5 are classified as positive, and predicted probabilities less than 0.5 are classified as negative.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_confusion_matrix</span>(log_model_1, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics 

          Reference
Prediction    0    1
         0 4600  878
         1  673 2712

                Accuracy : 0.8250 
     No Information Rate : 0.5949 

                   Kappa : 0.6336 

McNemars's Test P-Value  : 0.0000 

             Sensitivity : 0.7554 
             Specificity : 0.8724 
          Pos Pred Value : 0.8012 
          Neg Pred Value : 0.8397 
              Prevalence : 0.4051 
          Detection Rate : 0.3060 
    Detection Prevalence : 0.3819 
       Balanced Accuracy : 0.8139 
               Precision : 0.8012 
                  Recall : 0.7554 

        'Positive' Class : 1</code></pre>
</div>
</div>
</section>
<section id="ploting-roc-curve-and-calculating-auc" class="level4">
<h4 class="anchored" data-anchor-id="ploting-roc-curve-and-calculating-auc">4.1.4 Ploting ROC Curve and Calculating AUC</h4>
<p>Finally, we will plot the ROC curve and calculate the AUC. The ROC curve is a plot of the true positive rate against the false positive rate for different cutoff values, and the AUC is the area under the ROC curve. These are common metrics for evaluating the performance of a binary classifier. The <strong><code>roc</code></strong> function from the <strong><code>pROC</code></strong> package is used to calculate the ROC curve, and the <strong><code>auc</code></strong> function is used to calculate the AUC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_model_1, Q1_test[, <span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(Q1_test<span class="sc">$</span>Landslide, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"ROC Curve (Model 1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AUC:"</span>, auc_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.8891783 </code></pre>
</div>
</div>
</section>
</section>
<section id="logistic-regression-model-2-slope-cut-off-2nd-quartile" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-model-2-slope-cut-off-2nd-quartile">4.2 Logistic Regression Model 2 (Slope Cut-off = 2nd Quartile)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>log_model_2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic<span class="sc">+</span>Lithology_Unconsolidated <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> Q2_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generating-model-summary-1" class="level4">
<h4 class="anchored" data-anchor-id="generating-model-summary-1">4.2.1 Generating Model Summary</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + 
    Aspect_NorthEast + Aspect_East + Aspect_SouthEast + Aspect_South + 
    Aspect_SouthWest + Aspect_West + Profile_Curvature + Plan_Curvature + 
    Lithology_Metamorphic + Lithology_Sedimentary + Lithology_Plutonic + 
    Lithology_Unconsolidated + Proximity_Settlement + Proximity_Stream + 
    Proximity_Road + Proximity_Fault + Landuse_Vegetation + Precipitation + 
    TWI + SPI + STI, family = "binomial", data = Q2_train)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -8.735e+00  8.915e-01  -9.798  &lt; 2e-16 ***
Elevation                -4.186e-04  1.579e-04  -2.650  0.00804 ** 
Slope_Angle               5.001e-01  2.242e-02  22.309  &lt; 2e-16 ***
Aspect_North             -1.130e-01  2.661e-01  -0.425  0.67106    
Aspect_NorthEast         -4.171e-01  2.238e-01  -1.864  0.06239 .  
Aspect_East              -3.970e-01  2.215e-01  -1.793  0.07303 .  
Aspect_SouthEast         -3.119e-01  2.216e-01  -1.407  0.15938    
Aspect_South             -1.832e-01  2.265e-01  -0.809  0.41866    
Aspect_SouthWest          6.254e-01  2.585e-01   2.419  0.01555 *  
Aspect_West              -6.435e-02  2.305e-01  -0.279  0.78014    
Profile_Curvature        -7.971e+02  6.254e+01 -12.746  &lt; 2e-16 ***
Plan_Curvature           -5.561e+02  6.953e+01  -7.999 1.26e-15 ***
Lithology_Metamorphic     8.793e-01  2.562e-01   3.432  0.00060 ***
Lithology_Sedimentary     1.368e+00  2.741e-01   4.991 6.02e-07 ***
Lithology_Plutonic       -5.436e-01  2.579e-01  -2.108  0.03504 *  
Lithology_Unconsolidated  1.573e+00  2.641e-01   5.957 2.57e-09 ***
Proximity_Settlement      2.475e-04  9.357e-05   2.645  0.00816 ** 
Proximity_Stream         -2.964e-03  4.920e-03  -0.602  0.54687    
Proximity_Road           -4.843e-03  3.161e-03  -1.532  0.12541    
Proximity_Fault           9.810e-05  5.327e-05   1.842  0.06554 .  
Landuse_Vegetation        6.816e-01  1.463e-01   4.658 3.19e-06 ***
Precipitation            -1.209e+00  1.291e+00  -0.937  0.34871    
TWI                      -7.087e-02  5.079e-02  -1.395  0.16290    
SPI                      -3.463e-01  1.631e+00  -0.212  0.83183    
STI                      -2.759e-03  2.048e-03  -1.347  0.17805    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 4131.4  on 8844  degrees of freedom
Residual deviance: 2410.4  on 8820  degrees of freedom
AIC: 2460.4

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
</section>
<section id="calculating-percentage-of-deviance-1" class="level4">
<h4 class="anchored" data-anchor-id="calculating-percentage-of-deviance-1">4.2.2 Calculating Percentage of Deviance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span><span class="fu">with</span>(<span class="fu">summary</span>(log_model_2), <span class="dv">1</span> <span class="sc">-</span> deviance<span class="sc">/</span>null.deviance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41.65542</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-1" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-1">4.2.3 Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_confusion_matrix</span>(log_model_2, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics 

          Reference
Prediction    0    1
         0  189   84
         1  363 8209

                Accuracy : 0.9495 
     No Information Rate : 0.0624 

                   Kappa : 0.4348 

McNemars's Test P-Value  : 0.0000 

             Sensitivity : 0.9899 
             Specificity : 0.3424 
          Pos Pred Value : 0.9577 
          Neg Pred Value : 0.6923 
              Prevalence : 0.9376 
          Detection Rate : 0.9281 
    Detection Prevalence : 0.9691 
       Balanced Accuracy : 0.6661 
               Precision : 0.9577 
                  Recall : 0.9899 

        'Positive' Class : 1</code></pre>
</div>
</div>
</section>
<section id="ploting-roc-curve-and-calculating-auc-1" class="level4">
<h4 class="anchored" data-anchor-id="ploting-roc-curve-and-calculating-auc-1">4.2.4 Ploting ROC Curve and Calculating AUC</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_model_2, Q2_test[, <span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(Q2_test<span class="sc">$</span>Landslide, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curve</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"ROC Curve (Model 2)"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray"</span>)  <span class="co"># Add a reference line for a random classifier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AUC:"</span>, auc_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.9320681 </code></pre>
</div>
</div>
</section>
</section>
<section id="logistic-regression-model-3-slope-cut-off-3rd-quartile" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-model-3-slope-cut-off-3rd-quartile">4.3 Logistic Regression Model 3 (Slope Cut-off = 3rd Quartile)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>log_model_3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic<span class="sc">+</span>Lithology_Unconsolidated <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> Q3_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
</div>
<section id="generating-model-summary-2" class="level4">
<h4 class="anchored" data-anchor-id="generating-model-summary-2">4.3.1 Generating Model Summary</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Landslide ~ Elevation + Aspect_North + Aspect_NorthEast + 
    Aspect_East + Aspect_SouthEast + Aspect_South + Aspect_SouthWest + 
    Aspect_West + Profile_Curvature + Plan_Curvature + Lithology_Metamorphic + 
    Lithology_Sedimentary + Lithology_Plutonic + Lithology_Unconsolidated + 
    Proximity_Settlement + Proximity_Stream + Proximity_Road + 
    Proximity_Fault + Landuse_Vegetation + Precipitation + TWI + 
    SPI + STI, family = "binomial", data = Q3_train)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)               3.729e+01  4.240e+04   0.001  0.99930   
Elevation                 1.300e-04  1.015e-03   0.128  0.89808   
Aspect_North              1.761e+01  4.795e+03   0.004  0.99707   
Aspect_NorthEast         -3.610e-01  1.256e+00  -0.287  0.77379   
Aspect_East               1.790e+01  2.770e+03   0.006  0.99485   
Aspect_SouthEast          1.051e+00  1.518e+00   0.693  0.48859   
Aspect_South             -9.981e-02  1.260e+00  -0.079  0.93687   
Aspect_SouthWest          1.824e-01  1.277e+00   0.143  0.88644   
Aspect_West               1.727e+01  2.909e+03   0.006  0.99526   
Profile_Curvature        -8.463e+02  3.283e+02  -2.578  0.00994 **
Plan_Curvature           -4.788e+02  3.804e+02  -1.259  0.20817   
Lithology_Metamorphic    -3.025e+01  4.240e+04  -0.001  0.99943   
Lithology_Sedimentary    -2.901e+01  4.240e+04  -0.001  0.99945   
Lithology_Plutonic       -3.045e+01  4.240e+04  -0.001  0.99943   
Lithology_Unconsolidated -1.270e+01  4.246e+04   0.000  0.99976   
Proximity_Settlement      1.563e-03  1.035e-03   1.510  0.13110   
Proximity_Stream         -6.067e-02  4.047e-02  -1.499  0.13378   
Proximity_Road            4.416e-02  3.479e-02   1.269  0.20431   
Proximity_Fault          -1.410e-04  3.195e-04  -0.441  0.65887   
Landuse_Vegetation        1.472e+00  1.110e+00   1.325  0.18505   
Precipitation            -1.376e+01  1.014e+01  -1.358  0.17458   
TWI                      -1.691e-01  3.928e-01  -0.431  0.66681   
SPI                      -1.772e+01  7.743e+00  -2.288  0.02212 * 
STI                       2.569e-01  1.636e-01   1.570  0.11631   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 155.494  on 8758  degrees of freedom
Residual deviance:  88.528  on 8735  degrees of freedom
AIC: 136.53

Number of Fisher Scoring iterations: 23</code></pre>
</div>
</div>
</section>
<section id="calculating-percentage-of-deviance-2" class="level4">
<h4 class="anchored" data-anchor-id="calculating-percentage-of-deviance-2">4.3.2 Calculating Percentage of Deviance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span><span class="fu">with</span>(<span class="fu">summary</span>(log_model_3), <span class="dv">1</span> <span class="sc">-</span> deviance<span class="sc">/</span>null.deviance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43.06663</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-2" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-2">4.3.3 Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_confusion_matrix</span>(log_model_3, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics 

          Reference
Prediction    0    1
         0    2    0
         1    8 8749

                Accuracy : 0.9991 
     No Information Rate : 0.0011 

                   Kappa : 0.3331 

McNemars's Test P-Value  : 0.0133 

             Sensitivity : 1.0000 
             Specificity : 0.2000 
          Pos Pred Value : 0.9991 
          Neg Pred Value : 1.0000 
              Prevalence : 0.9989 
          Detection Rate : 0.9989 
    Detection Prevalence : 0.9998 
       Balanced Accuracy : 0.6000 
               Precision : 0.9991 
                  Recall : 1.0000 

        'Positive' Class : 1</code></pre>
</div>
</div>
</section>
<section id="ploting-roc-curve-and-calculating-auc-2" class="level4">
<h4 class="anchored" data-anchor-id="ploting-roc-curve-and-calculating-auc-2">4.3.4 Ploting ROC Curve and Calculating AUC</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_model_3, Q3_test[, <span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(Q3_test<span class="sc">$</span>Landslide, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curve</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"ROC Curve (Model 3)"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AUC:"</span>, auc_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.5864885 </code></pre>
</div>
</div>
</section>
</section>
<section id="logistic-regression-model-4-slope-cut-off-4th-quartile" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-model-4-slope-cut-off-4th-quartile">4.4 Logistic Regression Model 4 (Slope Cut-off = 4th Quartile)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>log_model_4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic<span class="sc">+</span>Lithology_Unconsolidated <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> Q4_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generating-model-summary-3" class="level4">
<h4 class="anchored" data-anchor-id="generating-model-summary-3">4.4.1 Generating Model Summary</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + 
    Aspect_NorthEast + Aspect_East + Aspect_SouthEast + Aspect_South + 
    Aspect_SouthWest + Aspect_West + Profile_Curvature + Plan_Curvature + 
    Lithology_Metamorphic + Lithology_Sedimentary + Lithology_Plutonic + 
    Lithology_Unconsolidated + Proximity_Settlement + Proximity_Stream + 
    Proximity_Road + Proximity_Fault + Landuse_Vegetation + Precipitation + 
    TWI + SPI + STI, family = "binomial", data = Q4_train)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               1.712e+01  1.944e+00   8.805  &lt; 2e-16 ***
Elevation                 7.268e-04  2.910e-04   2.498 0.012502 *  
Slope_Angle              -3.225e-01  1.799e-02 -17.928  &lt; 2e-16 ***
Aspect_North              3.570e-01  6.567e-01   0.544 0.586682    
Aspect_NorthEast          2.461e-01  5.408e-01   0.455 0.649066    
Aspect_East               8.297e-01  5.466e-01   1.518 0.129017    
Aspect_SouthEast          6.618e-01  5.160e-01   1.283 0.199640    
Aspect_South              7.690e-01  5.052e-01   1.522 0.127944    
Aspect_SouthWest          1.862e-01  5.105e-01   0.365 0.715256    
Aspect_West               7.293e-01  5.676e-01   1.285 0.198836    
Profile_Curvature        -1.032e+02  7.919e+01  -1.304 0.192355    
Plan_Curvature           -8.003e+01  1.026e+02  -0.780 0.435266    
Lithology_Metamorphic     2.339e+00  5.862e-01   3.990 6.60e-05 ***
Lithology_Sedimentary     2.637e+00  6.281e-01   4.199 2.68e-05 ***
Lithology_Plutonic        2.642e+00  5.627e-01   4.695 2.67e-06 ***
Lithology_Unconsolidated  1.906e+00  6.633e-01   2.874 0.004055 ** 
Proximity_Settlement     -4.936e-04  1.922e-04  -2.568 0.010223 *  
Proximity_Stream         -3.837e-02  1.450e-02  -2.646 0.008138 ** 
Proximity_Road            1.399e-02  6.477e-03   2.160 0.030747 *  
Proximity_Fault          -3.004e-04  8.332e-05  -3.606 0.000311 ***
Landuse_Vegetation        6.576e-01  2.965e-01   2.218 0.026584 *  
Precipitation            -1.382e+00  3.953e+00  -0.349 0.726721    
TWI                       3.804e-01  1.522e-01   2.499 0.012456 *  
SPI                       1.354e+01  9.481e+00   1.428 0.153342    
STI                      -4.715e-03  4.175e-03  -1.129 0.258798    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2450.51  on 8847  degrees of freedom
Residual deviance:  568.32  on 8823  degrees of freedom
AIC: 618.32

Number of Fisher Scoring iterations: 9</code></pre>
</div>
</div>
</section>
<section id="calculating-percentage-of-deviance-3" class="level4">
<h4 class="anchored" data-anchor-id="calculating-percentage-of-deviance-3">4.4.2 Calculating Percentage of Deviance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span><span class="fu">with</span>(<span class="fu">summary</span>(log_model_4), <span class="dv">1</span> <span class="sc">-</span> deviance<span class="sc">/</span>null.deviance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.80804</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-3" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-3">4.4.3 Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_confusion_matrix</span>(log_model_4, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics 

          Reference
Prediction    0    1
         0  218   33
         1   57 8540

                Accuracy : 0.9898 
     No Information Rate : 0.0311 

                   Kappa : 0.8237 

McNemars's Test P-Value  : 0.0153 

             Sensitivity : 0.9962 
             Specificity : 0.7927 
          Pos Pred Value : 0.9934 
          Neg Pred Value : 0.8685 
              Prevalence : 0.9689 
          Detection Rate : 0.9652 
    Detection Prevalence : 0.9716 
       Balanced Accuracy : 0.8944 
               Precision : 0.9934 
                  Recall : 0.9962 

        'Positive' Class : 1</code></pre>
</div>
</div>
</section>
<section id="ploting-roc-curve-and-calculating-auc-3" class="level4">
<h4 class="anchored" data-anchor-id="ploting-roc-curve-and-calculating-auc-3">4.4.4 Ploting ROC Curve and Calculating AUC</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_model_4, Q4_test[, <span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(Q4_test<span class="sc">$</span>Landslide, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"ROC Curve (Model 4)"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AUC:"</span>, auc_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.9847468 </code></pre>
</div>
</div>
</section>
</section>
<section id="logistic-regression-model-5-slope-cut-off-25" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-model-5-slope-cut-off-25">4.5 Logistic Regression Model 5 (Slope Cut-off = 25)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>sample_Q5 <span class="ot">&lt;-</span> <span class="fu">subset</span>(train_grids_v4,Slope_Angle <span class="sc">&lt;</span> <span class="dv">25</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_Q5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18578</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sample_Q5, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Slope_Angle</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#e9531e"</span>) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Slope Stratified Sampling (Cut-off 25)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q5), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.30</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>Q5_train  <span class="ot">&lt;-</span> sample_Q5[sample, ]</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>Q5_test   <span class="ot">&lt;-</span> sample_Q5[<span class="sc">!</span>sample, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>log_model_5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic<span class="sc">+</span>Lithology_Unconsolidated <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> Q5_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generating-model-summary-4" class="level4">
<h4 class="anchored" data-anchor-id="generating-model-summary-4">4.5.1 Generating Model Summary</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + 
    Aspect_NorthEast + Aspect_East + Aspect_SouthEast + Aspect_South + 
    Aspect_SouthWest + Aspect_West + Profile_Curvature + Plan_Curvature + 
    Lithology_Metamorphic + Lithology_Sedimentary + Lithology_Plutonic + 
    Lithology_Unconsolidated + Proximity_Settlement + Proximity_Stream + 
    Proximity_Road + Proximity_Fault + Landuse_Vegetation + Precipitation + 
    TWI + SPI + STI, family = "binomial", data = Q5_train)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -3.189e+00  2.758e-01 -11.560  &lt; 2e-16 ***
Elevation                -1.916e-04  5.164e-05  -3.710 0.000207 ***
Slope_Angle               2.547e-01  4.918e-03  51.776  &lt; 2e-16 ***
Aspect_North             -1.255e-01  1.294e-01  -0.970 0.331908    
Aspect_NorthEast         -2.130e-01  1.085e-01  -1.964 0.049532 *  
Aspect_East              -3.757e-01  1.067e-01  -3.519 0.000433 ***
Aspect_SouthEast         -2.694e-01  1.042e-01  -2.586 0.009715 ** 
Aspect_South             -2.352e-01  1.024e-01  -2.297 0.021642 *  
Aspect_SouthWest         -1.081e-01  1.048e-01  -1.031 0.302512    
Aspect_West              -1.362e-01  1.046e-01  -1.303 0.192699    
Profile_Curvature        -8.692e+02  3.013e+01 -28.854  &lt; 2e-16 ***
Plan_Curvature           -6.951e+02  3.413e+01 -20.368  &lt; 2e-16 ***
Lithology_Metamorphic     7.376e-01  1.374e-01   5.367 8.01e-08 ***
Lithology_Sedimentary     1.193e+00  1.432e-01   8.329  &lt; 2e-16 ***
Lithology_Plutonic       -6.195e-01  1.318e-01  -4.701 2.58e-06 ***
Lithology_Unconsolidated  1.320e+00  1.388e-01   9.509  &lt; 2e-16 ***
Proximity_Settlement      7.579e-05  4.497e-05   1.685 0.091927 .  
Proximity_Stream         -6.302e-03  2.348e-03  -2.684 0.007270 ** 
Proximity_Road           -3.667e-03  1.594e-03  -2.301 0.021415 *  
Proximity_Fault           2.340e-07  2.561e-05   0.009 0.992708    
Landuse_Vegetation        6.285e-01  5.987e-02  10.499  &lt; 2e-16 ***
Precipitation            -5.176e+00  6.462e-01  -8.010 1.15e-15 ***
TWI                      -4.201e-02  1.330e-02  -3.158 0.001590 ** 
SPI                       7.550e-01  1.001e+00   0.754 0.450812    
STI                      -6.657e-04  1.243e-03  -0.535 0.592322    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 17929.0  on 13031  degrees of freedom
Residual deviance:  9387.3  on 13007  degrees of freedom
AIC: 9437.3

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="calculating-percentage-of-deviance-4" class="level4">
<h4 class="anchored" data-anchor-id="calculating-percentage-of-deviance-4">4.5.2 Calculating Percentage of Deviance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span><span class="fu">with</span>(<span class="fu">summary</span>(log_model_5), <span class="dv">1</span> <span class="sc">-</span> deviance<span class="sc">/</span>null.deviance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47.64204</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-4" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-4">4.5.3 Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_confusion_matrix</span>(log_model_5, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics 

          Reference
Prediction    0    1
         0 4809 1003
         1 1039 6181

                Accuracy : 0.8433 
     No Information Rate : 0.4487 

                   Kappa : 0.6831 

McNemars's Test P-Value  : 0.4386 

             Sensitivity : 0.8604 
             Specificity : 0.8223 
          Pos Pred Value : 0.8561 
          Neg Pred Value : 0.8274 
              Prevalence : 0.5513 
          Detection Rate : 0.4743 
    Detection Prevalence : 0.5540 
       Balanced Accuracy : 0.8414 
               Precision : 0.8561 
                  Recall : 0.8604 

        'Positive' Class : 1</code></pre>
</div>
</div>
</section>
<section id="ploting-roc-curve-and-calculating-auc-4" class="level4">
<h4 class="anchored" data-anchor-id="ploting-roc-curve-and-calculating-auc-4">4.5.4 Ploting ROC Curve and Calculating AUC</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_model_5, Q5_test[, <span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(Q5_test<span class="sc">$</span>Landslide, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curve</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"ROC Curve (Model 5)"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray"</span>)  <span class="co"># Add a reference line for a random classifier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AUC:"</span>, auc_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.9199029 </code></pre>
</div>
</div>
</section>
</section>
<section id="logistic-regression-model-6-slope-cut-off-20" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-model-6-slope-cut-off-20">4.6 Logistic Regression Model 6 (Slope Cut-off = 20)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>sample_Q6 <span class="ot">&lt;-</span> <span class="fu">subset</span>(train_grids_v4,Slope_Angle <span class="sc">&lt;</span> <span class="dv">20</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_Q6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14020</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sample_Q6, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Slope_Angle</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#e9531e"</span>)<span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Slope Stratified Sampling (Cut-off 20)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q6), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.30</span>))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>Q6_train  <span class="ot">&lt;-</span> sample_Q6[sample, ]</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>Q6_test   <span class="ot">&lt;-</span> sample_Q6[<span class="sc">!</span>sample, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>log_model_6 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic<span class="sc">+</span>Lithology_Unconsolidated <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> Q6_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generating-model-summary-5" class="level4">
<h4 class="anchored" data-anchor-id="generating-model-summary-5">4.6.1 Generating Model Summary</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + 
    Aspect_NorthEast + Aspect_East + Aspect_SouthEast + Aspect_South + 
    Aspect_SouthWest + Aspect_West + Profile_Curvature + Plan_Curvature + 
    Lithology_Metamorphic + Lithology_Sedimentary + Lithology_Plutonic + 
    Lithology_Unconsolidated + Proximity_Settlement + Proximity_Stream + 
    Proximity_Road + Proximity_Fault + Landuse_Vegetation + Precipitation + 
    TWI + SPI + STI, family = "binomial", data = Q6_train)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -2.935e+00  2.928e-01 -10.027  &lt; 2e-16 ***
Elevation                -2.180e-04  5.309e-05  -4.106 4.03e-05 ***
Slope_Angle               2.380e-01  5.824e-03  40.866  &lt; 2e-16 ***
Aspect_North             -9.506e-02  1.360e-01  -0.699  0.48442    
Aspect_NorthEast         -2.609e-01  1.164e-01  -2.241  0.02505 *  
Aspect_East              -3.522e-01  1.154e-01  -3.053  0.00226 ** 
Aspect_SouthEast         -3.591e-01  1.116e-01  -3.219  0.00129 ** 
Aspect_South             -3.287e-01  1.090e-01  -3.015  0.00257 ** 
Aspect_SouthWest         -2.990e-01  1.115e-01  -2.683  0.00730 ** 
Aspect_West              -1.493e-01  1.116e-01  -1.338  0.18102    
Profile_Curvature        -8.478e+02  3.166e+01 -26.774  &lt; 2e-16 ***
Plan_Curvature           -7.141e+02  3.730e+01 -19.146  &lt; 2e-16 ***
Lithology_Metamorphic     8.882e-01  1.605e-01   5.534 3.13e-08 ***
Lithology_Sedimentary     1.363e+00  1.656e-01   8.227  &lt; 2e-16 ***
Lithology_Plutonic       -1.028e+00  1.548e-01  -6.638 3.19e-11 ***
Lithology_Unconsolidated  1.429e+00  1.606e-01   8.895  &lt; 2e-16 ***
Proximity_Settlement      5.232e-05  4.807e-05   1.089  0.27637    
Proximity_Stream         -5.267e-03  2.562e-03  -2.056  0.03982 *  
Proximity_Road           -3.428e-03  1.682e-03  -2.038  0.04159 *  
Proximity_Fault          -1.640e-05  2.833e-05  -0.579  0.56267    
Landuse_Vegetation        5.954e-01  6.274e-02   9.490  &lt; 2e-16 ***
Precipitation            -6.212e+00  6.973e-01  -8.908  &lt; 2e-16 ***
TWI                      -3.580e-02  1.359e-02  -2.634  0.00843 ** 
SPI                       1.357e+00  9.876e-01   1.374  0.16939    
STI                      -9.589e-04  1.274e-03  -0.753  0.45173    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 13475.0  on 9854  degrees of freedom
Residual deviance:  8116.6  on 9830  degrees of freedom
AIC: 8166.6

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="calculating-percentage-of-deviance-5" class="level4">
<h4 class="anchored" data-anchor-id="calculating-percentage-of-deviance-5">4.6.2 Calculating Percentage of Deviance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span><span class="fu">with</span>(<span class="fu">summary</span>(log_model_6), <span class="dv">1</span> <span class="sc">-</span> deviance<span class="sc">/</span>null.deviance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.76529</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-5" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-5">4.6.3 Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_confusion_matrix</span>(log_model_6, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics 

          Reference
Prediction    0    1
         0 4796  980
         1  809 3270

                Accuracy : 0.8185 
     No Information Rate : 0.5687 

                   Kappa : 0.6281 

McNemars's Test P-Value  : 1e-04 

             Sensitivity : 0.7694 
             Specificity : 0.8557 
          Pos Pred Value : 0.8017 
          Neg Pred Value : 0.8303 
              Prevalence : 0.4313 
          Detection Rate : 0.3318 
    Detection Prevalence : 0.4139 
       Balanced Accuracy : 0.8125 
               Precision : 0.8017 
                  Recall : 0.7694 

        'Positive' Class : 1</code></pre>
</div>
</div>
</section>
<section id="ploting-roc-curve-and-calculating-auc-5" class="level4">
<h4 class="anchored" data-anchor-id="ploting-roc-curve-and-calculating-auc-5">4.6.4 Ploting ROC Curve and Calculating AUC</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_model_6, Q6_test[, <span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(Q6_test<span class="sc">$</span>Landslide, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curve</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"ROC Curve (Model 6)"</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray"</span>)  <span class="co"># Add a reference line for a random classifier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AUC:"</span>, auc_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.8941156 </code></pre>
</div>
</div>
</section>
</section>
<section id="logistic-regression-model-7-slope-cut-off-15" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression-model-7-slope-cut-off-15">4.7 Logistic Regression Model 7 (Slope Cut-off = 15)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>sample_Q7 <span class="ot">&lt;-</span> <span class="fu">subset</span>(train_grids_v4,Slope_Angle <span class="sc">&lt;</span> <span class="dv">15</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sample_Q7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sample_Q7, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Slope_Angle</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"#e9531e"</span>)<span class="sc">+</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Slope Stratified Sampling (Cut-off 15)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q7), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.30</span>))</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>Q7_train  <span class="ot">&lt;-</span> sample_Q7[sample, ]</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>Q7_test   <span class="ot">&lt;-</span> sample_Q7[<span class="sc">!</span>sample, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>log_model_7 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> sample_Q7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generating-model-summary-6" class="level4">
<h4 class="anchored" data-anchor-id="generating-model-summary-6">4.7.1 Generating Model Summary</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model_7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + 
    Aspect_NorthEast + Aspect_East + Aspect_SouthEast + Aspect_South + 
    Aspect_SouthWest + Aspect_West + Profile_Curvature + Plan_Curvature + 
    Lithology_Metamorphic + Lithology_Sedimentary + Lithology_Plutonic + 
    Proximity_Settlement + Proximity_Stream + Proximity_Road + 
    Proximity_Fault + Landuse_Vegetation + Precipitation + TWI + 
    SPI + STI, family = "binomial", data = sample_Q7)

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           -1.802e+00  2.366e-01  -7.615 2.64e-14 ***
Elevation             -1.693e-04  5.207e-05  -3.252 0.001145 ** 
Slope_Angle            3.067e-01  7.560e-03  40.573  &lt; 2e-16 ***
Aspect_North           3.827e-02  1.415e-01   0.270 0.786880    
Aspect_NorthEast      -1.965e-01  1.199e-01  -1.639 0.101267    
Aspect_East           -4.019e-01  1.188e-01  -3.384 0.000714 ***
Aspect_SouthEast      -5.030e-01  1.143e-01  -4.402 1.07e-05 ***
Aspect_South          -3.844e-01  1.095e-01  -3.512 0.000445 ***
Aspect_SouthWest      -3.941e-01  1.109e-01  -3.555 0.000378 ***
Aspect_West           -2.890e-01  1.129e-01  -2.559 0.010484 *  
Profile_Curvature     -8.378e+02  3.202e+01 -26.163  &lt; 2e-16 ***
Plan_Curvature        -7.877e+02  4.041e+01 -19.491  &lt; 2e-16 ***
Lithology_Metamorphic -5.097e-01  7.154e-02  -7.124 1.05e-12 ***
Lithology_Sedimentary  5.674e-02  8.166e-02   0.695 0.487183    
Lithology_Plutonic    -1.465e+00  1.697e-01  -8.635  &lt; 2e-16 ***
Proximity_Settlement   1.111e-05  5.096e-05   0.218 0.827447    
Proximity_Stream      -5.642e-03  2.702e-03  -2.088 0.036793 *  
Proximity_Road        -3.610e-03  1.777e-03  -2.032 0.042199 *  
Proximity_Fault       -1.422e-05  2.977e-05  -0.478 0.632917    
Landuse_Vegetation     5.302e-01  6.358e-02   8.339  &lt; 2e-16 ***
Precipitation         -6.749e+00  7.277e-01  -9.275  &lt; 2e-16 ***
TWI                   -3.925e-02  1.250e-02  -3.140 0.001691 ** 
SPI                    2.059e+00  1.058e+00   1.946 0.051636 .  
STI                   -7.487e-04  1.307e-03  -0.573 0.566742    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12593.8  on 9898  degrees of freedom
Residual deviance:  7703.1  on 9875  degrees of freedom
AIC: 7751.1

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="calculating-percentage-of-deviance-6" class="level4">
<h4 class="anchored" data-anchor-id="calculating-percentage-of-deviance-6">4.7.2 Calculating Percentage of Deviance</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span><span class="fu">with</span>(<span class="fu">summary</span>(log_model_7), <span class="dv">1</span> <span class="sc">-</span> deviance<span class="sc">/</span>null.deviance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38.83411</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix-6" class="level4">
<h4 class="anchored" data-anchor-id="confusion-matrix-6">4.7.3 Confusion Matrix</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_confusion_matrix</span>(log_model_7, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics 

          Reference
Prediction    0    1
         0 5961 1027
         1  644 2267

                Accuracy : 0.8312 
     No Information Rate : 0.6672 

                   Kappa : 0.6085 

McNemars's Test P-Value  : 0.0000 

             Sensitivity : 0.6882 
             Specificity : 0.9025 
          Pos Pred Value : 0.7788 
          Neg Pred Value : 0.8530 
              Prevalence : 0.3328 
          Detection Rate : 0.2290 
    Detection Prevalence : 0.2941 
       Balanced Accuracy : 0.7954 
               Precision : 0.7788 
                  Recall : 0.6882 

        'Positive' Class : 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(log_model_7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Elevation           Slope_Angle          Aspect_North 
             2.341444              1.341770              1.429201 
     Aspect_NorthEast           Aspect_East      Aspect_SouthEast 
             1.718443              1.752454              1.864938 
         Aspect_South      Aspect_SouthWest           Aspect_West 
             1.992124              1.926948              1.854122 
    Profile_Curvature        Plan_Curvature Lithology_Metamorphic 
             1.206487              1.325544              1.242221 
Lithology_Sedimentary    Lithology_Plutonic  Proximity_Settlement 
             1.148306              1.013311              1.837073 
     Proximity_Stream        Proximity_Road       Proximity_Fault 
             1.356210              1.946011              1.030098 
   Landuse_Vegetation         Precipitation                   TWI 
             1.228579              1.282037              1.603045 
                  SPI                   STI 
             1.255000              1.256480 </code></pre>
</div>
</div>
</section>
<section id="ploting-roc-curve-and-calculating-auc-6" class="level4">
<h4 class="anchored" data-anchor-id="ploting-roc-curve-and-calculating-auc-6">4.7.4 Ploting ROC Curve and Calculating AUC</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(log_model_7, Q7_test[, <span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(Q7_test<span class="sc">$</span>Landslide, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curve</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">"ROC Curve (Model 7)"</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray"</span>)  <span class="co"># Add a reference line for a random classifier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>auc_value <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_curve)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AUC:"</span>, auc_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.8926449 </code></pre>
</div>
</div>
</section>
<section id="stepwise-selection" class="level4">
<h4 class="anchored" data-anchor-id="stepwise-selection">4.7.5 Stepwise Selection</h4>
<p>For the initial/ first cut model, all the independent variables are put into the model. Our goal is to include a limited number of independent variables (5-15) which are all significant, without sacrificing too much on the model performance. The rationale behind not-including too many variables is that the model would be over fitted and would become unstable when tested on the validation sample. The variable reduction is done using forward or backward or stepwise variable selection procedures. We will use blr_step_aic_both() to shortlist predictors for our model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_step_aic_both</span>(log_model_7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise Selection Method 
-------------------------

Candidate Terms: 

1 . Elevation 
2 . Slope_Angle 
3 . Aspect_North 
4 . Aspect_NorthEast 
5 . Aspect_East 
6 . Aspect_SouthEast 
7 . Aspect_South 
8 . Aspect_SouthWest 
9 . Aspect_West 
10 . Profile_Curvature 
11 . Plan_Curvature 
12 . Lithology_Metamorphic 
13 . Lithology_Sedimentary 
14 . Lithology_Plutonic 
15 . Proximity_Settlement 
16 . Proximity_Stream 
17 . Proximity_Road 
18 . Proximity_Fault 
19 . Landuse_Vegetation 
20 . Precipitation 
21 . TWI 
22 . SPI 
23 . STI 


Variables Entered/Removed: 

- Slope_Angle added 
- Profile_Curvature added 
- Plan_Curvature added 
- Landuse_Vegetation added 
- Precipitation added 
- Lithology_Plutonic added 
- Lithology_Metamorphic added 
- Elevation added 
- Aspect_North added 
- TWI added 
- Aspect_SouthEast added 
- Proximity_Road added 
- SPI added 
- Proximity_Stream added 
- Aspect_SouthWest added 
- Aspect_South added 
- Aspect_East added 
- Aspect_West added 
- Aspect_North removed 
- Aspect_NorthEast added 

No more variables to be added or removed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                             Stepwise Summary                             
------------------------------------------------------------------------
Variable                  Method        AIC          BIC       Deviance  
------------------------------------------------------------------------
Slope_Angle              addition    10076.292    10090.692    10072.292 
Profile_Curvature        addition     8627.061     8648.661     8621.061 
Plan_Curvature           addition     8194.504     8223.305     8186.504 
Landuse_Vegetation       addition     8040.435     8076.436     8030.435 
Precipitation            addition     7944.499     7987.701     7932.499 
Lithology_Plutonic       addition     7858.035     7908.436     7844.035 
Lithology_Metamorphic    addition     7794.689     7852.291     7778.689 
Elevation                addition     7774.753     7839.555     7756.753 
Aspect_North             addition     7768.277     7840.278     7748.277 
TWI                      addition     7762.896     7842.098     7740.896 
Aspect_SouthEast         addition     7758.903     7845.305     7734.903 
Proximity_Road           addition     7756.074     7849.676     7730.074 
SPI                      addition     7754.081     7854.884     7726.081 
Proximity_Stream         addition     7752.955     7860.958     7722.955 
Aspect_SouthWest         addition     7752.424     7867.627     7720.424 
Aspect_South             addition     7750.729     7873.132     7716.729 
Aspect_East              addition     7746.819     7876.423     7710.819 
Aspect_West              addition     7744.845     7881.648     7706.845 
Aspect_North             removal      7743.888     7873.491     7707.888 
Aspect_NorthEast         addition     7742.250     7879.054     7704.250 
------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>log_model_7 <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blr_step_aic_both</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise Selection Method 
-------------------------

Candidate Terms: 

1 . Elevation 
2 . Slope_Angle 
3 . Aspect_North 
4 . Aspect_NorthEast 
5 . Aspect_East 
6 . Aspect_SouthEast 
7 . Aspect_South 
8 . Aspect_SouthWest 
9 . Aspect_West 
10 . Profile_Curvature 
11 . Plan_Curvature 
12 . Lithology_Metamorphic 
13 . Lithology_Sedimentary 
14 . Lithology_Plutonic 
15 . Proximity_Settlement 
16 . Proximity_Stream 
17 . Proximity_Road 
18 . Proximity_Fault 
19 . Landuse_Vegetation 
20 . Precipitation 
21 . TWI 
22 . SPI 
23 . STI 


Variables Entered/Removed: 

- Slope_Angle added 
- Profile_Curvature added 
- Plan_Curvature added 
- Landuse_Vegetation added 
- Precipitation added 
- Lithology_Plutonic added 
- Lithology_Metamorphic added 
- Elevation added 
- Aspect_North added 
- TWI added 
- Aspect_SouthEast added 
- Proximity_Road added 
- SPI added 
- Proximity_Stream added 
- Aspect_SouthWest added 
- Aspect_South added 
- Aspect_East added 
- Aspect_West added 
- Aspect_North removed 
- Aspect_NorthEast added 

No more variables to be added or removed.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-update" class="level4">
<h4 class="anchored" data-anchor-id="model-update">4.7.6 Model Update</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>log_model_7_modified <span class="ot">&lt;-</span> <span class="fu">glm</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic <span class="sc">+</span> Proximity_Road<span class="sc">+</span> Landuse_Vegetation<span class="sc">+</span>Precipitation, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> sample_Q7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_model_7_modified)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + 
    Aspect_SouthEast + Profile_Curvature + Plan_Curvature + Lithology_Metamorphic + 
    Lithology_Sedimentary + Lithology_Plutonic + Proximity_Road + 
    Landuse_Vegetation + Precipitation, family = "binomial", 
    data = sample_Q7)

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           -2.677e+00  1.475e-01 -18.152  &lt; 2e-16 ***
Elevation             -1.441e-04  4.896e-05  -2.942  0.00326 ** 
Slope_Angle            3.122e-01  7.393e-03  42.225  &lt; 2e-16 ***
Aspect_North           3.202e-01  1.192e-01   2.687  0.00721 ** 
Aspect_SouthEast      -2.054e-01  8.423e-02  -2.439  0.01472 *  
Profile_Curvature     -8.352e+02  3.137e+01 -26.622  &lt; 2e-16 ***
Plan_Curvature        -7.460e+02  3.697e+01 -20.178  &lt; 2e-16 ***
Lithology_Metamorphic -4.723e-01  7.075e-02  -6.675 2.47e-11 ***
Lithology_Sedimentary  5.532e-02  8.124e-02   0.681  0.49595    
Lithology_Plutonic    -1.473e+00  1.688e-01  -8.726  &lt; 2e-16 ***
Proximity_Road        -3.263e-03  1.676e-03  -1.947  0.05148 .  
Landuse_Vegetation     5.543e-01  6.167e-02   8.987  &lt; 2e-16 ***
Precipitation         -6.394e+00  6.987e-01  -9.150  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12593.8  on 9898  degrees of freedom
Residual deviance:  7737.8  on 9886  degrees of freedom
AIC: 7763.8

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(log_model_7_modified)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Elevation           Slope_Angle          Aspect_North 
             2.083395              1.289639              1.016584 
     Aspect_SouthEast     Profile_Curvature        Plan_Curvature 
             1.019076              1.161964              1.114569 
Lithology_Metamorphic Lithology_Sedimentary    Lithology_Plutonic 
             1.220348              1.141323              1.011247 
       Proximity_Road    Landuse_Vegetation         Precipitation 
             1.743175              1.161973              1.187435 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="geographically-weighted-logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="geographically-weighted-logistic-regression">5.0 Geographically Weighted Logistic Regression</h2>
<p>Next, we will run Geographically Weighted Logistic Regression (GWLR) models using <code>sample_Q5</code> dataset and <code>GWmodel</code> package. In order to perform GWLR modelling in <code>GWmodel</code>, we will first need to convert <em>t</em>he datasets into a <strong>SpatialPointsDataFrame</strong>.</p>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">20%</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 6 Slope Cut-off = 20</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q6), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.20</span>,<span class="fl">0.80</span>))</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>Q6_fit  <span class="ot">&lt;-</span> sample_Q6[sample, ]</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>Q6_fit.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(Q6_fit,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>))</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>Q6_fit.sf <span class="ot">&lt;-</span> <span class="fu">st_set_crs</span>(Q6_fit.sf, <span class="dv">32632</span>)</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>Q6_fit.sp <span class="ot">&lt;-</span> Q6_fit.sf <span class="sc">%&gt;%</span> <span class="fu">as_Spatial</span>()</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 7 Slope Cut-off = 20</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">nrow</span>(sample_Q7), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.20</span>,<span class="fl">0.80</span>))</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>Q7_fit  <span class="ot">&lt;-</span> sample_Q6[sample, ]</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>Q7_fit.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(Q7_fit,</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>))</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>Q7_fit.sf <span class="ot">&lt;-</span> <span class="fu">st_set_crs</span>(Q7_fit.sf, <span class="dv">32632</span>)</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>Q7_fit.sp <span class="ot">&lt;-</span> Q7_fit.sf <span class="sc">%&gt;%</span> <span class="fu">as_Spatial</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>Q6_fit.sp <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"~/IS485-Landslide/data/rds/Q6_fit.sp.rds"</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>Q7_fit.sp <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"~/IS485-Landslide/data/rds/Q7_fit.sp.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will make a quick plot to see the geographical distribution of landslide and non-landslide samples in <code>Q6_fit.sp</code> &amp; <code>Q7_fit.sp</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>Q6_fit.sf<span class="sc">$</span>Landslide <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Q6_fit.sf<span class="sc">$</span>Landslide)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>Q7_fit.sf<span class="sc">$</span>Landslide <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Q7_fit.sf<span class="sc">$</span>Landslide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculating-adaptive-bandwidth" class="level3">
<h3 class="anchored" data-anchor-id="calculating-adaptive-bandwidth">5.1 Calculating Adaptive Bandwidth</h3>
<p>In this section, we will calculate the adaptive bandwidth for fitting a GWLE model using the <strong><code>bw.ggwr</code></strong> function from <code>GWmodel</code>.</p>
<p>Firstly, we will create a distance matrix to be used for calculating the bandwidth. The <strong><code>st_coordinates</code></strong> function is used to extract the coordinates from the <strong><code>Q5_train.sf</code></strong> spatial object. The <strong><code>gw.dist</code></strong> function is then used to calculate the distance matrix <strong><code>dist.test</code></strong> based on these coordinates.</p>
<section id="model-6-slope-cut-off-20" class="level4">
<h4 class="anchored" data-anchor-id="model-6-slope-cut-off-20">5.1.1 Model 6 (Slope Cut-off 20)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(Q6_fit.sf) </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>dist.Q6 <span class="ot">&lt;-</span> <span class="fu">gw.dist</span>(<span class="at">dp.locat=</span>dist_mat,<span class="at">p=</span><span class="dv">2</span>, <span class="at">theta=</span><span class="dv">0</span>, <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that, we have created the distance matrix, we will calculate the adaptive bandwidth value with specifications as below.</p>
<ul>
<li><p>The <strong><code>family</code></strong> argument is set to <strong><code>"binomial"</code></strong>, indicating that a binomial distribution is assumed for the dependent variable.</p></li>
<li><p>The <strong><code>approach</code></strong> argument is set to <strong><code>"CV"</code></strong>, indicating that cross-validation is used for bandwidth selection.</p></li>
<li><p>The <strong><code>kernel</code></strong> argument is set to <strong><code>"gaussian"</code></strong>, indicating that a Gaussian kernel function is used.</p></li>
<li><p>The <strong><code>adaptive</code></strong> argument is set to <strong><code>TRUE</code></strong>, indicating that an adaptive kernel is used, where the bandwidth corresponds to the number of nearest neighbors.</p></li>
<li><p>The <strong><code>p</code></strong> and <strong><code>theta</code></strong> arguments are set to <strong><code>2</code></strong> and <strong><code>0</code></strong> respectively, which are the default values for the power of the Minkowski distance and the angle to rotate the coordinate system.</p></li>
<li><p>The <strong><code>longlat</code></strong> argument is set to <strong><code>FALSE</code></strong>, indicating that Euclidean distances are calculated.</p></li>
<li><p>Finally, the <strong><code>dMat</code></strong> argument is set to <strong><code>dist.test</code></strong>, which is the pre-specified distance matrix that we calculated earlier.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>adaptive_bw <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic<span class="sc">+</span>Lithology_Unconsolidated <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">data =</span> Q6_fit.sp, <span class="at">approach=</span><span class="st">"CV"</span>, <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">adaptive=</span><span class="cn">TRUE</span>, <span class="at">p=</span><span class="dv">2</span>, <span class="at">theta=</span><span class="dv">0</span>, <span class="at">longlat=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/Screenshot 2024-02-19 at 9.56.31 PM.png" class="img-fluid"></p>
<p>Based on the result, the optimal adaptive bandwidth value that yields the lowest CV score is <strong>203</strong> (with CV score = 1312.815). We will use this value in fitting GWLR model <code>gwlr</code>.</p>
</section>
</section>
<section id="building-geographically-weighted-logistic-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="building-geographically-weighted-logistic-regression-model">5.2 Building Geographically Weighted Logistic Regression Model</h3>
<p>We will use <code>ggwr.basic()</code> function from <code>GWmodel</code> package to fit a GWLR model <code>gwlr</code> using the specifications below.</p>
<ul>
<li><p>The <strong><code>bw</code></strong> argument is set to <strong><code>203</code></strong>, which is the optimal adaptive bandwidth value that yields the lowest CV score (1312.815). This value was determined in a previous step.</p></li>
<li><p>The <strong><code>family</code></strong> argument is set to <strong><code>"binomial"</code></strong>, indicating that a binomial distribution is assumed for the dependent variable. The <strong><code>kernel</code></strong> argument is set to <strong><code>"gaussian"</code></strong>, indicating that a Gaussian kernel function is used.</p></li>
<li><p>The <strong><code>adaptive</code></strong> argument is set to <strong><code>TRUE</code></strong>, indicating that an adaptive kernel is used, where the bandwidth corresponds to the number of nearest neighbors. The <strong><code>cv</code></strong> argument is set to <strong><code>TRUE</code></strong>, indicating that cross-validation data will be calculated.</p></li>
<li><p>The <strong><code>tol</code></strong> argument is set to <strong><code>0.00001</code></strong>, which is the threshold that determines the convergence of the IRLS procedure.</p></li>
<li><p>The <strong><code>p</code></strong> and <strong><code>theta</code></strong> arguments are set to <strong><code>2</code></strong> and <strong><code>0</code></strong> respectively, which are the default values for the power of the Minkowski distance and the angle to rotate the coordinate system.</p></li>
<li><p>The <strong><code>longlat</code></strong> argument is set to <strong><code>FALSE</code></strong>, indicating that Euclidean distances are calculated.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>gwlr <span class="ot">&lt;-</span> <span class="fu">ggwr.basic</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> Slope_Angle <span class="sc">+</span> Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> Aspect_East<span class="sc">+</span>Aspect_SouthEast<span class="sc">+</span>Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span>Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span>Plan_Curvature <span class="sc">+</span> Lithology_Metamorphic<span class="sc">+</span>Lithology_Sedimentary <span class="sc">+</span> Lithology_Plutonic<span class="sc">+</span>Lithology_Unconsolidated <span class="sc">+</span> Proximity_Settlement<span class="sc">+</span>Proximity_Stream<span class="sc">+</span>Proximity_Road<span class="sc">+</span>Proximity_Fault<span class="sc">+</span>Landuse_Vegetation<span class="sc">+</span>Precipitation<span class="sc">+</span>TWI<span class="sc">+</span>SPI<span class="sc">+</span>STI, <span class="at">data =</span> Q6_fit.sp, <span class="at">bw=</span> <span class="dv">100</span>, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">kernel =</span> <span class="st">"gaussian"</span>, <span class="at">adaptive =</span> <span class="cn">TRUE</span>, <span class="at">cv =</span> T, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">theta =</span> <span class="dv">0</span>, <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-summary" class="level3">
<h3 class="anchored" data-anchor-id="model-summary">5.3 Model Summary</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>gwlr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2024-02-20 08:43:41.302803 
   Call:
   ggwr.basic(formula = Landslide ~ Elevation + Slope_Angle + Aspect_North + 
    Aspect_NorthEast + Aspect_East + Aspect_SouthEast + Aspect_South + 
    Aspect_SouthWest + Aspect_West + Profile_Curvature + Plan_Curvature + 
    Lithology_Metamorphic + Lithology_Sedimentary + Lithology_Plutonic + 
    Lithology_Unconsolidated + Proximity_Settlement + Proximity_Stream + 
    Proximity_Road + Proximity_Fault + Landuse_Vegetation + Precipitation + 
    TWI + SPI + STI, data = Q5_train_sp, regression.points = Q5_test_sp, 
    bw = 203, family = "binomial", kernel = "gaussian", adaptive = TRUE, 
    cv = T, tol = 1e-05, p = 2, theta = 0, longlat = FALSE)

   Dependent (y) variable:  Landslide
   Independent variables:  Elevation Slope_Angle Aspect_North Aspect_NorthEast Aspect_East Aspect_SouthEast Aspect_South Aspect_SouthWest Aspect_West Profile_Curvature Plan_Curvature Lithology_Metamorphic Lithology_Sedimentary Lithology_Plutonic Lithology_Unconsolidated Proximity_Settlement Proximity_Stream Proximity_Road Proximity_Fault Landuse_Vegetation Precipitation TWI SPI STI
   Number of data points: 12936
   Used family: binomial
   ***********************************************************************
   *              Results of Generalized linear Regression               *
   ***********************************************************************

Call:
NULL

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
Intercept                -3.437e+00  2.804e-01 -12.255  &lt; 2e-16 ***
Elevation                -2.053e-04  5.153e-05  -3.983 6.80e-05 ***
Slope_Angle               2.564e-01  4.957e-03  51.712  &lt; 2e-16 ***
Aspect_North              6.226e-02  1.286e-01   0.484   0.6284    
Aspect_NorthEast         -9.202e-02  1.092e-01  -0.843   0.3993    
Aspect_East              -1.559e-01  1.083e-01  -1.439   0.1501    
Aspect_SouthEast         -2.629e-01  1.050e-01  -2.505   0.0123 *  
Aspect_South             -2.082e-01  1.023e-01  -2.036   0.0417 *  
Aspect_SouthWest         -6.468e-02  1.051e-01  -0.615   0.5383    
Aspect_West              -4.534e-02  1.056e-01  -0.430   0.6675    
Profile_Curvature        -8.460e+02  3.008e+01 -28.120  &lt; 2e-16 ***
Plan_Curvature           -7.246e+02  3.422e+01 -21.173  &lt; 2e-16 ***
Lithology_Metamorphic     7.394e-01  1.392e-01   5.313 1.08e-07 ***
Lithology_Sedimentary     1.098e+00  1.447e-01   7.588 3.24e-14 ***
Lithology_Plutonic       -6.174e-01  1.322e-01  -4.671 2.99e-06 ***
Lithology_Unconsolidated  1.305e+00  1.404e-01   9.294  &lt; 2e-16 ***
Proximity_Settlement      7.413e-05  4.614e-05   1.607   0.1081    
Proximity_Stream         -5.654e-03  2.351e-03  -2.405   0.0162 *  
Proximity_Road           -3.436e-03  1.607e-03  -2.138   0.0325 *  
Proximity_Fault           2.964e-05  2.555e-05   1.160   0.2462    
Landuse_Vegetation        6.619e-01  5.991e-02  11.048  &lt; 2e-16 ***
Precipitation            -5.054e+00  6.600e-01  -7.657 1.90e-14 ***
TWI                      -2.496e-02  1.328e-02  -1.880   0.0601 .  
SPI                       5.565e-01  9.392e-01   0.593   0.5535    
STI                       1.216e-04  1.135e-03   0.107   0.9147    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 17778.2  on 12935  degrees of freedom
Residual deviance:  9367.3  on 12911  degrees of freedom
AIC: 9417.3

Number of Fisher Scoring iterations: 6


 AICc:  9417.362
 Pseudo R-square value:  0.4731051
   ***********************************************************************
   *          Results of Geographically Weighted Regression              *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 203 (number of nearest neighbours)
   Regression points: A seperate set of regression points is used.
   Distance metric: Euclidean distance metric is used.

   ************Summary of Generalized GWR coefficient estimates:**********
                                   Min.     1st Qu.      Median     3rd Qu.
   Intercept                -2.2292e+03 -4.7322e+00 -2.4838e+00  1.1179e+00
   Elevation                -5.5303e-03 -1.9487e-03 -1.0699e-03 -3.9695e-04
   Slope_Angle               1.3679e-01  2.3957e-01  2.6247e-01  3.0523e-01
   Aspect_North             -3.2685e+00 -3.7158e-01  6.6438e-02  5.7209e-01
   Aspect_NorthEast         -2.0677e+00 -5.3232e-01 -5.1641e-02  4.9088e-01
   Aspect_East              -2.2102e+00 -6.6302e-01 -1.2399e-01  5.9538e-01
   Aspect_SouthEast         -2.2022e+00 -7.7883e-01 -7.5033e-02  6.4405e-01
   Aspect_South             -2.7350e+00 -6.9757e-01 -1.2606e-01  5.8518e-01
   Aspect_SouthWest         -2.1135e+00 -5.8536e-01 -1.6144e-01  3.7881e-01
   Aspect_West              -2.1831e+00 -4.1492e-01 -9.8628e-02  4.2942e-01
   Profile_Curvature        -1.4988e+03 -8.7123e+02 -7.1415e+02 -5.6137e+02
   Plan_Curvature           -2.3965e+03 -1.0010e+03 -7.7246e+02 -5.5740e+02
   Lithology_Metamorphic    -4.0714e+02 -1.5267e+00 -4.2470e-01  5.1771e-01
   Lithology_Sedimentary    -4.0603e+02 -1.7469e+00 -3.9433e-01  7.4777e-01
   Lithology_Plutonic       -9.0420e+00 -3.6743e+00 -1.4776e+00 -3.0875e-01
   Lithology_Unconsolidated -4.0720e+02 -1.3369e+00  2.2028e-01  1.0894e+00
   Proximity_Settlement     -1.1802e-03 -3.0190e-05  2.0770e-04  6.3443e-04
   Proximity_Stream         -1.5947e-01 -3.6857e-02 -8.1638e-03  1.9761e-02
   Proximity_Road           -9.5281e-02 -1.3754e-02 -7.6464e-04  1.6616e-02
   Proximity_Fault          -2.6713e-03 -2.4192e-04  8.0035e-05  4.6317e-04
   Landuse_Vegetation       -7.7653e-01  6.7617e-02  5.2753e-01  9.0657e-01
   Precipitation            -7.9766e+01 -4.5176e+00  7.8831e+00  1.7006e+01
   TWI                      -4.0499e-01 -1.4649e-01 -7.6203e-02 -2.0298e-02
   SPI                      -1.8961e+01 -2.8786e+00  7.3061e-01  4.0492e+00
   STI                      -1.4056e-02 -3.0657e-03  1.5789e-03  5.7384e-03
                                 Max.
   Intercept                 412.2115
   Elevation                   0.0028
   Slope_Angle                 0.5331
   Aspect_North                3.2800
   Aspect_NorthEast            1.9637
   Aspect_East                 2.5205
   Aspect_SouthEast            2.3429
   Aspect_South                3.4021
   Aspect_SouthWest            2.6369
   Aspect_West                 2.2829
   Profile_Curvature         161.7406
   Plan_Curvature            402.5170
   Lithology_Metamorphic    2277.2060
   Lithology_Sedimentary    2169.7130
   Lithology_Plutonic          1.3806
   Lithology_Unconsolidated 2180.1257
   Proximity_Settlement        0.0023
   Proximity_Stream            0.1261
   Proximity_Road              0.0846
   Proximity_Fault             0.0021
   Landuse_Vegetation          2.4352
   Precipitation              57.6561
   TWI                         0.3045
   SPI                        28.0687
   STI                         0.0302
   ************************Diagnostic information*************************

   ***********************************************************************
   Program stops at: 2024-02-20 09:14:42.8669 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>regression.points <span class="ot">&lt;-</span> gwlr<span class="sc">$</span>SDF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spatial-interpolation" class="level3">
<h3 class="anchored" data-anchor-id="spatial-interpolation">Spatial Interpolation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>valtellina_boundary <span class="ot">&lt;-</span> <span class="fu">st_union</span>(valtellina) <span class="sc">%&gt;%</span> <span class="fu">st_sf</span>()</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(valtellina_boundary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sf"         "data.frame"</code></pre>
</div>
</div>
<section id="prediction-locations" class="level4">
<h4 class="anchored" data-anchor-id="prediction-locations"><strong>Prediction locations</strong></h4>
<p>We wish to predict the prices of properties continuously in space in Athens. To do that, we create a fine raster grid covering Athens and consider the centroids of the raster cells as the prediction locations. We create the raster grid with the <a href="https://rdrr.io/pkg/terra/man/rast.html"><code>rast()</code></a> function of <strong>terra</strong> by specifying the region to be covered (<code>map</code>), and the number of rows and columns of the grid (<code>nrows = 700, ncols = 1066</code>). The prediction locations are the centroids of the raster cells and can be obtained with the <a href="https://rdrr.io/pkg/terra/man/xyCellFrom.html"><code>xyFromCell()</code></a> function of <strong>terra</strong>. Alternatively, we could create the grid using the <a href="https://r-spatial.github.io/sf/reference/st_make_grid.html"><code>st_make_grid()</code></a> function of <strong>sf</strong> by specifying the number of grid cells in the horizontal and vertical directions or the cell size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">rast</span>(valtellina_boundary, <span class="at">nrows =</span> <span class="dv">700</span>, <span class="at">ncols =</span> <span class="dv">1066</span>)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">xyFromCell</span>(grid, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncell</span>(grid))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>coop <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">as.data.frame</span>(xy), <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>),</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">crs =</span> <span class="fu">st_crs</span>(valtellina_boundary))</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>coop <span class="ot">&lt;-</span> <span class="fu">st_filter</span>(coop, valtellina_boundary)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(coop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="closest-observation" class="level3">
<h3 class="anchored" data-anchor-id="closest-observation"><strong>Closest Observation</strong></h3>
<p>We can obtain predictions at each of the prediction locations as the values of the closest sampled locations. To do that, we can employ the Voronoi diagram (also known as Dirichlet or Thiessen diagram). The Voronoi diagram is created when a region with n points is partitioned into convex polygons such that each polygon contains exactly one generating point, and every point in a given polygon is closer to its generating point than to any other.</p>
<p>Given a set of points, we can create a Voronoi diagram with the <a href="https://rdrr.io/pkg/terra/man/voronoi.html"><code>voronoi()</code></a> function of <strong>terra</strong> specifying the points as an object of class <code>SpatVector</code> of <strong>terra</strong>, and <code>map</code> to set the outer boundary of the Voronoi diagram. This returns a Voronoi diagram for the set of points assuming constant values in each of the polygons.</p>
<p>Then, we can use the functions <a href="https://rdrr.io/pkg/tmap/man/tm_shape.html"><code>tm_shape()</code></a> and <a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html"><code>tm_fill()</code></a> of <strong>tmap</strong> to plot the values of the variable in each of the polygons indicating the name of the variable <code>col = "vble"</code>, the palette <code>palette = "viridis"</code> and the level of transparency <code>alpha = 0.6</code> (if the plot is interactive).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Voronoi</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">voronoi</span>(<span class="at">x =</span> <span class="fu">vect</span>(regression.points), <span class="at">bnd =</span> valtellina_boundary)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(v)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">vect</span>(regression.points), <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(v)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(v) <span class="sc">+</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Landuse_Vegetation"</span>, <span class="at">palette =</span> <span class="st">"Spectral"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Landuse_Vegetation" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-65-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(v, coop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>pred <span class="ot">&lt;-</span> resp<span class="sc">$</span>Landuse_Vegetation</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>pred_voronoi <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(resp, grid, <span class="at">field =</span> <span class="st">"pred"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>voronoi_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(pred_voronoi) <span class="sc">+</span> </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Landuse Vegetation"</span>,</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">midpoint =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Voronoi"</span>,</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>),</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.4</span>,</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">text.size =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"TOP"</span>)) <span class="sc">+</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">"LEFT"</span>, <span class="st">"TOP"</span>),</span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">text.size =</span> <span class="fl">0.4</span>)</span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a>voronoi_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="idw-inverse-distance-weighting" class="level3">
<h3 class="anchored" data-anchor-id="idw-inverse-distance-weighting">IDW: Inverse Distance Weighting</h3>
<p>In the IDW method, values at unsampled locations are estimated as the weighted average of values from the rest of locations with weights inversely proportional to the distance between the unsampled and the sampled locations.</p>
<p>We can apply the IDW method with the <a href="https://rdrr.io/pkg/gstat/man/gstat.html"><code>gstat()</code></a> function of <strong>gstat</strong> and the following arguments:</p>
<ul>
<li><p><code>formula</code>: <code>vble ~ 1</code> to have an intercept only model,</p></li>
<li><p><code>nmax</code>: number of neighbors is set equal to the total number of locations,</p></li>
<li><p><code>idp</code>: inverse distance power is set to <code>idp = 1</code> to have weights with β=1�=1.</p></li>
</ul>
<p>Then, we use the <a href="https://rdrr.io/pkg/terra/man/predict.html"><code>predict()</code></a> function to obtain the predictions and <strong>tmap</strong> to show the results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(gstat)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">gstat</span>(<span class="at">formula =</span> Landuse_Vegetation <span class="sc">~</span> <span class="dv">1</span>, <span class="at">locations =</span> regression.points,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">nmax =</span> <span class="fu">nrow</span>(regression.points), <span class="co"># use all the neighbors locations</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="dv">1</span>)) <span class="co"># beta = 1 </span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">predict</span>(res, coop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[inverse distance weighted interpolation]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(resp)[,<span class="dv">1</span>]</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(resp)[,<span class="dv">2</span>]</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>pred <span class="ot">&lt;-</span> resp<span class="sc">$</span>var1.pred</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>pred_idw <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(resp, grid, <span class="at">field =</span> <span class="st">"pred"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>idw_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(pred_idw) <span class="sc">+</span> </span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Landuse Vegetation"</span>,</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">midpoint =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"IDW"</span>,</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>),</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.4</span>,</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">text.size =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"TOP"</span>)) <span class="sc">+</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">"LEFT"</span>, <span class="st">"TOP"</span>),</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">text.size =</span> <span class="fl">0.4</span>)</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>idw_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="nearest-neighbors" class="level3">
<h3 class="anchored" data-anchor-id="nearest-neighbors"><strong>Nearest neighbors</strong></h3>
<p>In the nearest neighbors interpolation method, values at unsampled locations are estimated as the average of the values of the k closest sampled locations. Specifically,</p>
<p>We can compute predictions using nearest neighbors interpolation with the <a href="https://rdrr.io/pkg/gstat/man/gstat.html"><code>gstat()</code></a> function of <strong>gstat</strong>. Here, we consider the number of closest sampled locations equal to 5 by setting <code>nmax = 5</code>. Unlike the IDW method, in the nearest neighbors approach locations further away from the location where we wish to predict are assigned the same weights. Therefore, the inverse distance power <code>idp</code> is set equal to zero so all the neighbors are equally weighted.</p>
<p>Then, we use the <a href="https://rdrr.io/pkg/terra/man/predict.html"><code>predict()</code></a> function to get predictions at unsampled locations given in <code>coop</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">gstat</span>(<span class="at">formula =</span> Landuse_Vegetation <span class="sc">~</span> <span class="dv">1</span>, <span class="at">locations =</span> regression.points, <span class="at">nmax =</span> <span class="dv">5</span>,</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="dv">0</span>))</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">predict</span>(res, coop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[inverse distance weighted interpolation]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(resp)[,<span class="dv">1</span>]</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(resp)[,<span class="dv">2</span>]</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>pred <span class="ot">&lt;-</span> resp<span class="sc">$</span>var1.pred</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>pred_nn <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(resp, grid, <span class="at">field =</span> <span class="st">"pred"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>nn_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(pred_nn) <span class="sc">+</span> </span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">"Landuse Vegetation"</span>,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">midpoint =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Nearest Neighbour"</span>,</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>),</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.4</span>,</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">text.size =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"TOP"</span>)) <span class="sc">+</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">"LEFT"</span>, <span class="st">"TOP"</span>),</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">text.size =</span> <span class="fl">0.4</span>)</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>nn_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ensemble-approach" class="level3">
<h3 class="anchored" data-anchor-id="ensemble-approach"><strong>Ensemble approach</strong></h3>
<p>Predictions can also be obtained using an ensemble approach that combines the predictions obtained with several spatial interpolation methods.</p>
<p>Here, we use an ensemble approach to predict the price per square meter of apartments in Athens by combining the predictions of the three previous approaches (closest observation, IDW, nearest neighbors) using equal weights.</p>
<p>The predictions with the closest observation method are obtained using the Voronoi diagram as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Closest observation (Voronoi)</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">voronoi</span>(<span class="at">x =</span> terra<span class="sc">::</span><span class="fu">vect</span>(regression.points), <span class="at">bnd =</span> valtellina_boundary)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(v)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(v, coop)<span class="sc">$</span>Landuse_Vegetation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
</div>
</div>
<p>The IDW approach can be applied with the <a href="https://rdrr.io/pkg/gstat/man/gstat.html"><code>gstat()</code></a> function of <strong>gstat</strong> specifying <code>nmax</code> as the total number of locations and <code>idp = 1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IDW</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">gstat</span>(<span class="at">formula =</span> Landuse_Vegetation <span class="sc">~</span> <span class="dv">1</span>, <span class="at">locations =</span> regression.points, <span class="at">nmax =</span> <span class="fu">nrow</span>(regression.points),</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="dv">1</span>))</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs, coop)<span class="sc">$</span>var1.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[inverse distance weighted interpolation]</code></pre>
</div>
</div>
<p>The nearest neighbors method is applied with the <a href="https://rdrr.io/pkg/gstat/man/gstat.html"><code>gstat()</code></a> function specifying <code>nmax</code> as the number of neighbors and with equal weights (<code>idp = 0</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nearest neighbors</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>nn <span class="ot">&lt;-</span> <span class="fu">gstat</span>(<span class="at">formula =</span> Landuse_Vegetation <span class="sc">~</span> <span class="dv">1</span>, <span class="at">locations =</span> regression.points, <span class="at">nmax =</span> <span class="dv">5</span>,</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="dv">0</span>))</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn, coop)<span class="sc">$</span>var1.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[inverse distance weighted interpolation]</code></pre>
</div>
</div>
<p>Finally, the ensemble predictions are obtained by combining the predictions of these three methods with equal weights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble (equal weights)</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> p1 <span class="sc">*</span> weights[<span class="dv">1</span>] <span class="sc">+</span> p2 <span class="sc">*</span> weights[<span class="dv">2</span>] <span class="sc">+</span> p3 <span class="sc">*</span> weights[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We create a map with the predictions by creating a raster with the predictions and using the <strong>tmap</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="at">x =</span> <span class="fu">st_coordinates</span>(coop)[, <span class="dv">1</span>],</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="at">y =</span> <span class="fu">st_coordinates</span>(coop)[, <span class="dv">2</span>],</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="at">pred =</span> p4)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(resp, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(map))</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>pred_ensemble <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(resp, grid, <span class="at">field =</span> <span class="st">"pred"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a> ensemble_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(pred_ensemble) <span class="sc">+</span> </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>,</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">"Landuse Vegetation"</span>,</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">midpoint =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Ensemble"</span>,</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"BOTTOM"</span>),</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.4</span>,</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">text.size =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position=</span><span class="fu">c</span>(<span class="st">"RIGHT"</span>, <span class="st">"TOP"</span>)) <span class="sc">+</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>(<span class="at">position=</span><span class="fu">c</span>(<span class="st">"LEFT"</span>, <span class="st">"TOP"</span>),</span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">text.size =</span> <span class="fl">0.4</span>)</span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a> ensemble_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(voronoi_map, idw_map, nn_map, ensemble_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="slopesampling_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(pred_nn, <span class="st">"~/IS485-Landslide/data/gwr_maps/landuse_nn.tif"</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(pred_idw, <span class="st">"~/IS485-Landslide/data/gwr_maps/landuse_idw.tif"</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(pred_voronoi, <span class="st">"~/IS485-Landslide/data/gwr_maps/landuse_voronoi.tif"</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(pred_ensemble, <span class="st">"~/IS485-Landslide/data/gwr_maps/landuse_ensemble.tif"</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation">Cross-Validation</h3>
<p>We can assess the performance of each of the methods presented above using K-fold cross-validation and the root mean squared error (RMSE). First, we split the data in K parts. For each part, we use the remaining K−1 parts (training data) to fit the model and that part (testing data) to predict. We compute the RMSE by comparing the testing and predicted data in each of the K parts.</p>
<p>Note that if K is equal to the number of observations n, this procedure is called leave-one-out cross-validation (LOOCV). That means that n separate data sets are trained on all of the data except one observation, and then prediction is made for that one observation.</p>
<p>Here, we assess the performance of each of the methods previously employed to predict the prices of apartments in Athens. We create training and testing sets by using the <code>dismo:kfold()</code> function of the <strong>dismo</strong> package (<a href="https://www.paulamoraga.com/book-spatial/references.html#ref-R-dismo">Hijmans et al.&nbsp;2022</a>) to randomly assign the observations to K=5 groups of roughly equal size. For each group, we fit the model using the training data, and obtain predictions of the testing data. We calculate the RMSEs of each part and average the RMSEs to obtain a K-fold cross-validation estimate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dismo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, predicted) {</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((observed <span class="sc">-</span> predicted)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data in 5 sets</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>kf <span class="ot">&lt;-</span> dismo<span class="sc">::</span><span class="fu">kfold</span>(<span class="fu">nrow</span>(regression.points), <span class="at">k =</span> <span class="dv">5</span>) <span class="co"># K-fold partitioning</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectors to store the RMSE values obtained with each method</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">5</span>) <span class="co"># Closest observation</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">5</span>) <span class="co"># IDW</span></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>rmse3 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">5</span>) <span class="co"># Nearest neighbors</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>rmse4 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">5</span>) <span class="co"># Ensemble</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data in test and train</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> regression.points[kf <span class="sc">==</span> k, ]</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> regression.points[kf <span class="sc">!=</span> k, ]</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Closest observation</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">voronoi</span>(<span class="at">x =</span> terra<span class="sc">::</span><span class="fu">vect</span>(regression.points), <span class="at">bnd =</span> valtellina_boundary)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(v)</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(v, coop)<span class="sc">$</span>Landuse_Vegetation</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>rmse1[k] <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(test<span class="sc">$</span>Landuse_Vegetation, p1)</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="co"># IDW</span></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">gstat</span>(<span class="at">formula =</span> Landuse_Vegetation <span class="sc">~</span> <span class="dv">1</span>, <span class="at">locations =</span> regression.points, <span class="at">nmax =</span> <span class="fu">nrow</span>(regression.points),</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="dv">1</span>))</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs, coop)<span class="sc">$</span>var1.pred</span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>rmse2[k] <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(test<span class="sc">$</span>Landuse_Vegetation, p2)</span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Nearest neighbors</span></span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>nn <span class="ot">&lt;-</span> <span class="fu">gstat</span>(<span class="at">formula =</span> Landuse_Vegetation <span class="sc">~</span> <span class="dv">1</span>, <span class="at">locations =</span> regression.points, <span class="at">nmax =</span> <span class="dv">5</span>,</span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">set =</span> <span class="fu">list</span>(<span class="at">idp =</span> <span class="dv">0</span>))</span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn, coop)<span class="sc">$</span>var1.pred</span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a>rmse3[k] <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(test<span class="sc">$</span>Landuse_Vegetation, p3)</span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble (weights are inverse RMSE so lower RMSE higher weight)</span></span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">c</span>(rmse1[k], rmse2[k], rmse3[k])</span>
<span id="cb175-26"><a href="#cb175-26" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> w<span class="sc">/</span><span class="fu">sum</span>(w)</span>
<span id="cb175-27"><a href="#cb175-27" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> p1 <span class="sc">*</span> weights[<span class="dv">1</span>] <span class="sc">+</span> p2 <span class="sc">*</span> weights[<span class="dv">2</span>] <span class="sc">+</span> p3 <span class="sc">*</span> weights[<span class="dv">3</span>]</span>
<span id="cb175-28"><a href="#cb175-28" aria-hidden="true" tabindex="-1"></a>rmse4[k] <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(test<span class="sc">$</span>Landuse_Vegetation, p4)</span>
<span id="cb175-29"><a href="#cb175-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The RMSE values obtained in each of the 5 splits are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE obtained for each of the 5 splits</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">closest.obs =</span> rmse1, <span class="at">IDW =</span> rmse2,</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">nearest.neigh =</span> rmse3, <span class="at">ensemble =</span> rmse4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We see the minimum average RMSE corresponds to the ensemble method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average RMSE over the 5 splits</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">closest.obs =</span> <span class="fu">mean</span>(rmse1), <span class="at">IDW =</span> <span class="fu">mean</span>(rmse2),</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">nearest.neigh =</span> <span class="fu">mean</span>(rmse3), <span class="at">ensemble =</span> <span class="fu">mean</span>(rmse4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="page-break" class="level2">
<h2 class="anchored" data-anchor-id="page-break">Page Break</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sample_Q6, <span class="st">"~/IS485-Landslide/data/aspatial/slope_20degree.csv"</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sample_Q7, <span class="st">"~/IS485-Landslide/data/aspatial/slope_15degree.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">What Causes Landslides? Explanatory Landslide Susceptibility Modelling of Valtellina Valley, Lombardy Region, Italy</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>