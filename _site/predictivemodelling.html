<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Khant Min Naing">
<meta name="author" content="Ann Mei Yi Victoria Grace">
<meta name="dcterms.date" content="2024-01-07">

<title>Machine Learning Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="logo.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo_name.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./studyarea.html" rel="" target="">
 <span class="menu-text">Study Area</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./methodology.html" rel="" target="">
 <span class="menu-text">Methodology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./project.html" rel="" target="">
 <span class="menu-text">EDA</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-model-fitting-and-results" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Model Fitting and Results</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-model-fitting-and-results">    
        <li>
    <a class="dropdown-item" href="./gwsmodelling_new.html" rel="" target="">
 <span class="dropdown-text">Statistical Modelling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./predictivemodelling.html" rel="" target="">
 <span class="dropdown-text">Machine Learning Modelling</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./research.html" rel="" target="">
 <span class="menu-text">Research Paper</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#predictive-landslide-susceptibility-modelling-using-machine-learning-techniques" id="toc-predictive-landslide-susceptibility-modelling-using-machine-learning-techniques" class="nav-link active" data-scroll-target="#predictive-landslide-susceptibility-modelling-using-machine-learning-techniques">Predictive Landslide Susceptibility Modelling Using Machine Learning Techniques</a></li>
  <li><a href="#import-packages" id="toc-import-packages" class="nav-link" data-scroll-target="#import-packages">1.0 Import Packages</a></li>
  <li><a href="#import-datasets" id="toc-import-datasets" class="nav-link" data-scroll-target="#import-datasets">2.0 Import Datasets</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3.0 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#test-train-split" id="toc-test-train-split" class="nav-link" data-scroll-target="#test-train-split">3.1 Test-Train Split</a></li>
  <li><a href="#preparing-the-testing-data" id="toc-preparing-the-testing-data" class="nav-link" data-scroll-target="#preparing-the-testing-data">3.2 Preparing the Testing Data</a></li>
  <li><a href="#storing-variable-names" id="toc-storing-variable-names" class="nav-link" data-scroll-target="#storing-variable-names">3.3 Storing Variable Names</a></li>
  <li><a href="#transforming-data-to-simple-feature-objects" id="toc-transforming-data-to-simple-feature-objects" class="nav-link" data-scroll-target="#transforming-data-to-simple-feature-objects">3.4 Transforming Data to Simple Feature Objects</a></li>
  <li><a href="#distance-matrix-transformation-and-threshold-setting" id="toc-distance-matrix-transformation-and-threshold-setting" class="nav-link" data-scroll-target="#distance-matrix-transformation-and-threshold-setting">3.5 Distance Matrix Transformation and Threshold Setting</a></li>
  <li><a href="#checking-the-balance-of-classes" id="toc-checking-the-balance-of-classes" class="nav-link" data-scroll-target="#checking-the-balance-of-classes">3.6 Checking the Balance of Classes</a></li>
  </ul></li>
  <li><a href="#explanatory-data-analysis" id="toc-explanatory-data-analysis" class="nav-link" data-scroll-target="#explanatory-data-analysis">4.0 Explanatory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#variable-spatial-autocorrelation-analysis" id="toc-variable-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#variable-spatial-autocorrelation-analysis">4.1 Variable Spatial Autocorrelation Analysis</a></li>
  </ul></li>
  <li><a href="#non-spatial-random-forest" id="toc-non-spatial-random-forest" class="nav-link" data-scroll-target="#non-spatial-random-forest">5.0 Non-spatial Random Forest</a>
  <ul class="collapse">
  <li><a href="#fitting-a-non-spatial-random-forest-model" id="toc-fitting-a-non-spatial-random-forest-model" class="nav-link" data-scroll-target="#fitting-a-non-spatial-random-forest-model">5.1 Fitting a non-spatial Random Forest model</a></li>
  <li><a href="#residual-spatial-autocorrelation-analysis" id="toc-residual-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#residual-spatial-autocorrelation-analysis">5.2 Residual Spatial Autocorrelation Analysis</a></li>
  <li><a href="#global-variable-importance" id="toc-global-variable-importance" class="nav-link" data-scroll-target="#global-variable-importance">5.3 Global Variable Importance</a></li>
  <li><a href="#understanding-variable-importance-scores" id="toc-understanding-variable-importance-scores" class="nav-link" data-scroll-target="#understanding-variable-importance-scores">5.4 Understanding Variable Importance Scores</a></li>
  <li><a href="#assessing-predictor-contribution-to-model-transferability" id="toc-assessing-predictor-contribution-to-model-transferability" class="nav-link" data-scroll-target="#assessing-predictor-contribution-to-model-transferability">5.5 Assessing Predictor Contribution to Model Transferability</a></li>
  <li><a href="#partial-dependence-plot-pdp" id="toc-partial-dependence-plot-pdp" class="nav-link" data-scroll-target="#partial-dependence-plot-pdp">5.6 Partial Dependence Plot (PDP)</a></li>
  <li><a href="#model-performance" id="toc-model-performance" class="nav-link" data-scroll-target="#model-performance">5.7 Model Performance</a></li>
  <li><a href="#predicting-onto-new-data" id="toc-predicting-onto-new-data" class="nav-link" data-scroll-target="#predicting-onto-new-data"><strong>5.8</strong> Predicting onto New Data</a></li>
  <li><a href="#permutation-test" id="toc-permutation-test" class="nav-link" data-scroll-target="#permutation-test">5.9 Permutation Test</a></li>
  </ul></li>
  <li><a href="#morans-eigenvector-random-forest" id="toc-morans-eigenvector-random-forest" class="nav-link" data-scroll-target="#morans-eigenvector-random-forest">6.0 Moran’s Eigenvector Random Forest</a>
  <ul class="collapse">
  <li><a href="#fitting-merf-model" id="toc-fitting-merf-model" class="nav-link" data-scroll-target="#fitting-merf-model">6.1 Fitting MERF Model</a></li>
  <li><a href="#residual-spatial-autocorrelation-analysis-1" id="toc-residual-spatial-autocorrelation-analysis-1" class="nav-link" data-scroll-target="#residual-spatial-autocorrelation-analysis-1">6.2 Residual Spatial Autocorrelation Analysis</a></li>
  <li><a href="#sequential-selection-of-spatial-predictors" id="toc-sequential-selection-of-spatial-predictors" class="nav-link" data-scroll-target="#sequential-selection-of-spatial-predictors">6.3 Sequential Selection of Spatial Predictors</a></li>
  <li><a href="#plotting-spatial-predictors" id="toc-plotting-spatial-predictors" class="nav-link" data-scroll-target="#plotting-spatial-predictors">6.4 Plotting Spatial Predictors</a></li>
  <li><a href="#merf-variable-importance" id="toc-merf-variable-importance" class="nav-link" data-scroll-target="#merf-variable-importance">6.5 MERF Variable Importance</a></li>
  <li><a href="#partial-dependence-plots-pdp-for-merf" id="toc-partial-dependence-plots-pdp-for-merf" class="nav-link" data-scroll-target="#partial-dependence-plots-pdp-for-merf">6.6 Partial Dependence Plots (PDP) for MERF</a></li>
  <li><a href="#model-performance-1" id="toc-model-performance-1" class="nav-link" data-scroll-target="#model-performance-1">6.7 Model Performance</a></li>
  <li><a href="#spatial-folds-cross-validation" id="toc-spatial-folds-cross-validation" class="nav-link" data-scroll-target="#spatial-folds-cross-validation">6.8 Spatial-Folds Cross-Validation</a></li>
  </ul></li>
  <li><a href="#geographically-weighted-random-forest" id="toc-geographically-weighted-random-forest" class="nav-link" data-scroll-target="#geographically-weighted-random-forest">7.0 Geographically Weighted Random Forest</a>
  <ul class="collapse">
  <li><a href="#bandwidth-selection" id="toc-bandwidth-selection" class="nav-link" data-scroll-target="#bandwidth-selection">7.1 Bandwidth Selection</a></li>
  <li><a href="#fitting-gwrf-models-with-different-bandwidths" id="toc-fitting-gwrf-models-with-different-bandwidths" class="nav-link" data-scroll-target="#fitting-gwrf-models-with-different-bandwidths">7.2 Fitting GWRF Models with Different Bandwidths</a></li>
  <li><a href="#prediction-with-various-spatial-weights" id="toc-prediction-with-various-spatial-weights" class="nav-link" data-scroll-target="#prediction-with-various-spatial-weights">7.2 Prediction with Various Spatial Weights</a></li>
  <li><a href="#plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-optimised-bandwidth" id="toc-plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-optimised-bandwidth" class="nav-link" data-scroll-target="#plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-optimised-bandwidth">7.3 Plotting GWRF Model Prediction Accuracy at Incrementing Weight &amp; Optimised Bandwidth</a></li>
  <li><a href="#iteraction-with-standardised-bandwidths" id="toc-iteraction-with-standardised-bandwidths" class="nav-link" data-scroll-target="#iteraction-with-standardised-bandwidths">7.4 Iteraction with Standardised Bandwidths</a></li>
  <li><a href="#prediction-with-various-spatial-weights-1" id="toc-prediction-with-various-spatial-weights-1" class="nav-link" data-scroll-target="#prediction-with-various-spatial-weights-1">7.5 Prediction with Various Spatial Weights</a></li>
  <li><a href="#plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-standardised-bandwidth" id="toc-plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-standardised-bandwidth" class="nav-link" data-scroll-target="#plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-standardised-bandwidth">7.6 Plotting GWRF Model Prediction Accuracy at Incrementing Weight &amp; Standardised Bandwidth</a></li>
  </ul></li>
  <li><a href="#kriging" id="toc-kriging" class="nav-link" data-scroll-target="#kriging">8.0 Kriging</a>
  <ul class="collapse">
  <li><a href="#creating-raster-layer" id="toc-creating-raster-layer" class="nav-link" data-scroll-target="#creating-raster-layer">8.1 Creating Raster Layer</a></li>
  <li><a href="#extracting-cell-coordinates" id="toc-extracting-cell-coordinates" class="nav-link" data-scroll-target="#extracting-cell-coordinates">8.2 Extracting Cell Coordinates</a></li>
  <li><a href="#creating-spatal-data-frame" id="toc-creating-spatal-data-frame" class="nav-link" data-scroll-target="#creating-spatal-data-frame">8.3 Creating Spatal Data Frame</a></li>
  <li><a href="#variogram" id="toc-variogram" class="nav-link" data-scroll-target="#variogram">8.4 Variogram</a></li>
  <li><a href="#creating-krige-object" id="toc-creating-krige-object" class="nav-link" data-scroll-target="#creating-krige-object">8.5 Creating Krige Object</a></li>
  <li><a href="#prediction-with-krige-object" id="toc-prediction-with-krige-object" class="nav-link" data-scroll-target="#prediction-with-krige-object">8.6 Prediction with Krige Object</a></li>
  <li><a href="#rasterizing-predictions" id="toc-rasterizing-predictions" class="nav-link" data-scroll-target="#rasterizing-predictions">8.7 Rasterizing Predictions</a></li>
  <li><a href="#creating-spatial-interpolated-map" id="toc-creating-spatial-interpolated-map" class="nav-link" data-scroll-target="#creating-spatial-interpolated-map">8.8 Creating Spatial Interpolated Map</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Machine Learning Modelling</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">sf</div>
    <div class="quarto-category">gwmodel</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Khant Min Naing </p>
             <p>Ann Mei Yi Victoria Grace </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 7, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">April 11, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="predictive-landslide-susceptibility-modelling-using-machine-learning-techniques" class="level1">
<h1>Predictive Landslide Susceptibility Modelling Using Machine Learning Techniques</h1>
<p>Landslide susceptibility modelling is emerging field of research that aims to identify the contributing factors of landslides and predict areas that are most susceptible. These studies serve as a valuable decision-support tool, helping us identify the areas at highest risk and implement preventive measures accordingly. In this research project, we aims to demonstrate the potential contribution of spatial non-stationarity in landslide susceptibility modelling. To do so, we will attempt to make a comparative case study of nonspatial and spatial random forest techniques and how space can be incorporate to these models. In particular, we will be developing three different RF models</p>
<ul>
<li><p>(Nonspatial) Random Forest (<code>ranger</code> package)</p></li>
<li><p>Moran’s Eigenvector Random Forest (<code>spatialRF</code> package)</p></li>
<li><p>Geographically Weighted Random Forest (<code>SpatialML</code> package)</p></li>
</ul>
</section>
<section id="import-packages" class="level1">
<h1>1.0 Import Packages</h1>
<p>Before we start the analysis, we will need to import necessary R packages first. In particular, we will import three packages that will allow us to fit three RF models we mentioned above.</p>
<ul>
<li><p>The package <strong>ranger</strong> allows fast implementation of Random Forests, particularly suited for high dimensional data</p></li>
<li><p>The package <strong>spatialRF</strong> facilitates fitting spatial regression models on regular or irregular data with Random Forest. It does so by generating <em>spatial predictors</em> that help the model “understand” the spatial structure of the training data with the end goal of minimizing the spatial autocorrelation of the model residuals and offering honest variable importance scores.</p></li>
<li><p>The package <strong>SpatialML</strong> implements a spatial extension of the random forest algorithm based on the concept of geographically weighted regression (GWR)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, sp, tmap, ggplot2, GWmodel, tidyverse, rsample, ranger, spatialRF, kableExtra, randomForestExplainer, pdp, dplyr, SpatialML, caret, Metrics, raster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-datasets" class="level1">
<h1>2.0 Import Datasets</h1>
<p>In this session, we will use two datasets.</p>
<ul>
<li><p>The first dataset, <strong><code>valtellina</code></strong>, is a geospatial dataset that delineates the boundary of our study area - Valtellina Valley. This data is presented in the ESRI shapefile format and is based on the Italy Geographic Coordinate System.</p></li>
<li><p>The second dataset, <code>ls_data</code> is a comma-separated values (csv) dataset that includes the landslide and non-landslide samples we will use for model fitting, training and testing.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>valtellina <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="at">dsn =</span> <span class="st">"data/vector"</span>, <span class="at">layer =</span> <span class="st">"valtellina"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ls_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/rds/sample_Q6.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-wrangling" class="level1">
<h1>3.0 Data Wrangling</h1>
<section id="test-train-split" class="level2">
<h2 class="anchored" data-anchor-id="test-train-split">3.1 Test-Train Split</h2>
<p>In this section, we are preparing our data for the subsequent analysis. The <strong><code>ls_data</code></strong> dataset, which contains our landslide data, is divided into two subsets: a training set and a testing set.</p>
<p>The code chunk below performs this operation. This process is crucial because it allows us to train our model on one subset of the data (the training set) and then evaluate its performance on unseen data (the testing set). This helps to ensure that our model is not just memorizing the training data and is actually able to generalize to new data. The <strong><code>set.seed(1243)</code></strong> function ensures that the random split of data is reproducible. The <strong><code>initial_split</code></strong> function from the <strong><code>rsample</code></strong> package is used to perform the split, with 20% of the data allocated to the testing set (<strong><code>prop = .2</code></strong>). The split is stratified by the <strong><code>Landslide</code></strong> variable, meaning the proportion of each class of <strong><code>Landslide</code></strong> is the same in the training and testing sets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1243</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ls_split <span class="ot">&lt;-</span> ls_data <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(<span class="at">prop =</span> .<span class="dv">2</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">strata =</span> Landslide)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">training</span>(ls_split)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>testing_data  <span class="ot">&lt;-</span> <span class="fu">testing</span>(ls_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-the-testing-data" class="level2">
<h2 class="anchored" data-anchor-id="preparing-the-testing-data">3.2 Preparing the Testing Data</h2>
<p>In this section, we are further refining our testing data for the analysis. We will be performing two main operations:</p>
<ol type="1">
<li><p><strong>Saving the target variable:</strong> We save the <strong><code>Landslide</code></strong> values from <strong><code>testing_data</code></strong> as a separate column. This is done because <strong><code>Landslide</code></strong> is our target variable, and we want to compare our model’s predictions with the actual values to evaluate its performance.</p></li>
<li><p><strong>Removing unnecessary variables:</strong> We remove the <strong><code>Train_ID</code></strong>, <strong><code>Grid_ID</code></strong>, and <strong><code>Landslide</code></strong> variables from the <strong><code>testing_data</code></strong> as they are not needed for the analysis. These variables are identifiers and the target variable, which are not used as input features in our model.</p></li>
</ol>
<p>The code chunk below performs these operations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>test_col <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testing_data<span class="sc">$</span>Landslide)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>testing_data <span class="ot">&lt;-</span> testing_data_temp <span class="ot">&lt;-</span> <span class="fu">subset</span>(testing_data, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Train_ID,Grid_ID,Landslide))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="storing-variable-names" class="level2">
<h2 class="anchored" data-anchor-id="storing-variable-names">3.3 Storing Variable Names</h2>
<p>In this section, we are streamlining our code by storing the names of our variables in vectors. y storing the variable names in vectors, we can easily reference them later in our code. This approach will make our code cleaner and more efficient, as we won’t have to repeatedly write out all the variable names. Also, it reduces the chance of errors that could arise from mistyping variable names.</p>
<p>The code chunk below performs these operations:</p>
<ul>
<li><p>We first store the name of the dependent variable in a vector called <code>dependent.variable.name</code>.</p></li>
<li><p>We then use the <code>colnames</code> function to get the names of columns 6 to 29 from the <code>ls_data</code> dataset. These are the names of the independent variable used in this study, We store them in a vector called <code>predictor.variable.names</code>.</p></li>
<li><p>We etract the ‘X’ and ‘Y’ columns from the training data and store them in a new data frame called <code>xy</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dependent.variable.name <span class="ot">&lt;-</span> <span class="st">"Landslide"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>predictor.variable.names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ls_data)[<span class="dv">6</span><span class="sc">:</span><span class="dv">29</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> training_data[, <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>random.seed <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="transforming-data-to-simple-feature-objects" class="level2">
<h2 class="anchored" data-anchor-id="transforming-data-to-simple-feature-objects">3.4 Transforming Data to Simple Feature Objects</h2>
<p>In this section, we are transforming our <strong><code>training_data</code></strong> and <strong><code>testing_data</code></strong> data frames into simple feature (<strong><code>sf</code></strong>) objects. This is a crucial step for spatial analysis, as <strong><code>sf</code></strong> objects allow us to perform various spatial operations.</p>
<p>The code chunk below performs these transformations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>training_data_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(training_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>testing_data_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(testing_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To ensure that our spatial data is in the correct projected system, we will set the CRS of <code>training_data_sf</code> and <code>testing_data_sf</code> to <strong>WGS 84 / UTM zone 32N</strong> (EPSG code 32632). This is crucial for accurate spatial analysis, as different CRSs can lead to different results. By setting appropriate CRS, we ensure that our spatial data is in a projected system suitable for accurate distance and area calculations.</p>
<p>The code chunk below sets the CRS for our <strong><code>training_data_sf</code></strong> and <strong><code>testing_data_sf</code></strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>training_data_sf <span class="ot">&lt;-</span> <span class="fu">st_set_crs</span>(training_data_sf, <span class="dv">32632</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>testing_data_sf <span class="ot">&lt;-</span> <span class="fu">st_set_crs</span>(testing_data_sf, <span class="dv">32632</span>) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(training_data_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:32632 
  wkt:
PROJCRS["WGS 84 / UTM zone 32N",
    BASEGEOGCRS["WGS 84",
        ENSEMBLE["World Geodetic System 1984 ensemble",
            MEMBER["World Geodetic System 1984 (Transit)"],
            MEMBER["World Geodetic System 1984 (G730)"],
            MEMBER["World Geodetic System 1984 (G873)"],
            MEMBER["World Geodetic System 1984 (G1150)"],
            MEMBER["World Geodetic System 1984 (G1674)"],
            MEMBER["World Geodetic System 1984 (G1762)"],
            MEMBER["World Geodetic System 1984 (G2139)"],
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ENSEMBLEACCURACY[2.0]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4326]],
    CONVERSION["UTM zone 32N",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",9,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Engineering survey, topographic mapping."],
        AREA["Between 6°E and 12°E, northern hemisphere between equator and 84°N, onshore and offshore. Algeria. Austria. Cameroon. Denmark. Equatorial Guinea. France. Gabon. Germany. Italy. Libya. Liechtenstein. Monaco. Netherlands. Niger. Nigeria. Norway. Sao Tome and Principe. Svalbard. Sweden. Switzerland. Tunisia. Vatican City State."],
        BBOX[0,6,84,12]],
    ID["EPSG",32632]]</code></pre>
</div>
</div>
</section>
<section id="distance-matrix-transformation-and-threshold-setting" class="level2">
<h2 class="anchored" data-anchor-id="distance-matrix-transformation-and-threshold-setting">3.5 Distance Matrix Transformation and Threshold Setting</h2>
<p>In this section, we are performing transformations on the distance matrix and setting distance thresholds based on quantile values. These steps are crucial for further spatial analysis.</p>
<ul>
<li><p>We use <strong><code>gw.dist</code></strong> function from the <strong><code>spgwr</code></strong> package to compute a geographically weighted distance matrix for the training data,</p></li>
<li><p>We convert the distance matrix from metres to kilometres for easier interpretation.</p></li>
<li><p>We then calculate the quantiles of the distance matrix.</p></li>
</ul>
<p>The code chunk below performs these operations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>training_data_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(training_data_sf)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>distance.matrix <span class="ot">&lt;-</span> <span class="fu">gw.dist</span>(<span class="at">dp.locat=</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">coordinates</span>(training_data_sp))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>distance.matrix <span class="ot">&lt;-</span> distance.matrix <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(distance.matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       0%       25%       50%       75%      100% 
  0.00000  21.66893  36.99885  55.92637 106.64538 </code></pre>
</div>
</div>
<p>After examining the quantile values, we set the distance thresholds as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>distance.thresholds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">110</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-the-balance-of-classes" class="level2">
<h2 class="anchored" data-anchor-id="checking-the-balance-of-classes">3.6 Checking the Balance of Classes</h2>
<p>In this section, we are verifying whether our training and testing datasets have a representative ratio of landslide (class 1) and non-landslide (class 0) data. This is an important step to ensure that our model is trained and tested on balanced data.</p>
<p>The code chunk below performs these checks:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(training_data<span class="sc">$</span>Landslide <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1209</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(training_data<span class="sc">$</span>Landslide <span class="sc">==</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1594</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(testing_data<span class="sc">$</span>Landslide <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(testing_data<span class="sc">$</span>Landslide <span class="sc">==</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Based on these calculations, our <strong><code>training_data</code></strong> has <strong>1209 landslide</strong> and <strong>1594 non-landslide</strong> samples. Our <strong><code>testing_data</code></strong> has <strong>4839 landslide</strong> and <strong>6378 non-landslide</strong> samples. This indicates that our data has a representative ratio of landslide to non-landslide samples, which is crucial for training a balanced and unbiased model.</p>
</section>
</section>
<section id="explanatory-data-analysis" class="level1">
<h1>4.0 Explanatory Data Analysis</h1>
<section id="variable-spatial-autocorrelation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="variable-spatial-autocorrelation-analysis">4.1 Variable Spatial Autocorrelation Analysis</h2>
<p>Spatial predictor variables often exhibit spatial autocorrelation, where nearby observations are not independent but rather exhibit similar values. This leads to spatial nonstationarity, a phenomenon where the relationships between variables change over space, violating the assumption of a global model.</p>
<p>To address this issue, we use Moran’s I, a common measure of spatial autocorrelation widely adopted by the geospatial data science community. Moran’s I quantifies the similarity between values and neighbouring observations, considering spatial relationships between neighbours. It describes how each observation differs from the mean of the study area.</p>
<p>Our aim is to assess the spatial autocorrelation level of predictor variables at different spatial scales. The function <strong><code>plot_training_df_moran()</code></strong> helps in assessing the spatial autocorrelation of the response variable and the predictors across different distance thresholds. This function generates a plot that visualizes the spatial autocorrelation of the response variable and the predictors across different distance thresholds. The <strong><code>fill.color</code></strong> and <strong><code>point.color</code></strong> arguments are used to customize the colors of the plot.</p>
<p>The code chunk below performs this operation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">plot_training_df_moran</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> training_data,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dependent.variable.name =</span> dependent.variable.name,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor.variable.names =</span> predictor.variable.names,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance.matrix =</span> distance_matrix,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance.thresholds =</span> distance.thresholds,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill.color =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">100</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">"A"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.color =</span> <span class="st">"gray40"</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Screenshot 2024-04-02 at 5.00.25 PM.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
</section>
<section id="non-spatial-random-forest" class="level1">
<h1>5.0 Non-spatial Random Forest</h1>
<section id="fitting-a-non-spatial-random-forest-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-a-non-spatial-random-forest-model">5.1 Fitting a non-spatial Random Forest model</h2>
<p>The <strong><code>rf()</code></strong> function from the <strong><code>spatialRF</code></strong> package is a convenient wrapper for the <strong><code>ranger::ranger()</code></strong> function, which is used in every modelling function of the <strong><code>spatialRF</code></strong> package. This function takes the training data, the names of the response variable and the predictor variables, and optionally, to assess the spatial autocorrelation of the residuals, the distance matrix, and a vector of distance thresholds (in the same units as the distances in <strong><code>distance_matrix</code></strong>).</p>
<p>The code chunk below fits a non-spatial random forest model using the <strong><code>rf()</code></strong> function:</p>
<p>By default, RF model from <code>ranger</code> use the following parameters.</p>
<ul>
<li><p>Number of Trees (<code>ntree</code>) : 500&nbsp;</p></li>
<li><p>Number of Features at Each Split (<code>mtry</code>) : 4&nbsp;</p></li>
<li><p>Minimum Node Size (<code>min.node.size</code>) : 5</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>non.spatial.rf <span class="ot">&lt;-</span> spatialRF<span class="sc">::</span><span class="fu">rf</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> training_data,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dependent.variable.name =</span> dependent.variable.name,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor.variable.names =</span> predictor.variable.names,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance.matrix =</span> distance.matrix,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance.thresholds =</span> distance.thresholds,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xy =</span> xy,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> random.seed,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="residual-spatial-autocorrelation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="residual-spatial-autocorrelation-analysis">5.2 Residual Spatial Autocorrelation Analysis</h2>
<p>The <strong><code>residuals</code></strong> slot of our non-spatial random forest model (<strong><code>non.spatial.rf$residuals</code></strong>) stores the values of the residuals and the results of the normality and spatial autocorrelation tests. We can visualize this information using the <strong><code>plot_residuals_diagnostics()</code></strong> function from the <strong><code>spatialRF</code></strong> package. The <strong><code>xy</code></strong>, <strong><code>distance.matrix</code></strong>, and <strong><code>distance.thresholds</code></strong> arguments included in the model fitting are used to assess the spatial autocorrelation of the residuals.</p>
<p>The code chunk below generates a diagnostic plot of the residuals:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">plot_residuals_diagnostics</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  non.spatial.rf,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The plot above provides valuable insights into the behavior of the residuals:</p>
<ul>
<li><p>The <strong>upper panels</strong> show the results of the normality test. The interpretation of the test is provided in the title of the plot.</p></li>
<li><p>The <strong>middle panel</strong> shows the relationship between the residuals and the fitted values. This is important for understanding the behavior of the residuals.</p></li>
<li><p>The <strong>lower panel</strong> shows Moran’s I of the residuals across distance thresholds and their respective p-values. Positive values indicate positive spatial autocorrelation at the corresponding distances (0, 20, 35 and 55 km in this case).</p></li>
</ul>
<p>By examining these plots, we can gain a deeper understanding of our model’s performance and the spatial structure of the residuals.</p>
</section>
<section id="global-variable-importance" class="level2">
<h2 class="anchored" data-anchor-id="global-variable-importance">5.3 Global Variable Importance</h2>
<p>The <strong><code>importance</code></strong> slot of our non-spatial random forest model (<strong><code>non.spatial.rf$variable.importance</code></strong>) contains the variable importance scores. These scores provide a measure of the contribution of each predictor variable to the predictive power of the model.</p>
<p>We can visualize these importance scores using the <strong><code>plot_importance()</code></strong> function from the <strong><code>spatialRF</code></strong> package, print them with the <strong><code>print_importance()</code></strong> function, or retrieve the data frame of importance scores with the <strong><code>get_importance()</code></strong> function.</p>
<p>The code chunk below generates a plot of the variable importance scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">plot_importance</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  non.spatial.rf,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot above provides a visual representation of the importance of each predictor variable in the model. The variables are ordered by their importance scores, with the most important variable at the top.</p>
</section>
<section id="understanding-variable-importance-scores" class="level2">
<h2 class="anchored" data-anchor-id="understanding-variable-importance-scores">5.4 Understanding Variable Importance Scores</h2>
<p>The <strong><code>randomForestExplainer</code></strong> package offers several options to deepen our understanding of variable importance scores. One such option is the <strong><code>measure_importance()</code></strong> function, which analyzes the forest to find out:</p>
<ul>
<li><p>The average minimum tree depth at which each variable can be found (<strong><code>mean_min_depth</code></strong>).</p></li>
<li><p>The number of nodes in which a variable was selected to make a split (<strong><code>no_of_nodes</code></strong>).</p></li>
<li><p>The number of times the variable was selected as the first one to start a tree (<strong><code>times_a_root</code></strong>).</p></li>
<li><p>The probability of a variable to be in more nodes than what would be expected by chance (<strong><code>p_value</code></strong>).</p></li>
</ul>
<p>The code chunk below performs this operation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>importance.df <span class="ot">&lt;-</span> randomForestExplainer<span class="sc">::</span><span class="fu">measure_importance</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  non.spatial.rf,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">measures =</span> <span class="fu">c</span>(<span class="st">"mean_min_depth"</span>, <span class="st">"no_of_nodes"</span>, <span class="st">"times_a_root"</span>, <span class="st">"p_value"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting data frame, <strong><code>importance.df</code></strong>, contains the variable importance scores for each measure. This data frame can be printed in a tidy format using the <strong><code>kableExtra::kbl()</code></strong> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  importance.df <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(mean_min_depth) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">p_value =</span> <span class="fu">round</span>(p_value, <span class="dv">4</span>)),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"html"</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean_min_depth</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">no_of_nodes</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">times_a_root</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Slope_Angle</td>
<td style="text-align: right;">1.838000</td>
<td style="text-align: right;">13675</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Profile_Curvature</td>
<td style="text-align: right;">2.080000</td>
<td style="text-align: right;">12161</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plan_Curvature</td>
<td style="text-align: right;">2.218000</td>
<td style="text-align: right;">11717</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Elevation</td>
<td style="text-align: right;">2.406000</td>
<td style="text-align: right;">11854</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TWI</td>
<td style="text-align: right;">2.514000</td>
<td style="text-align: right;">11436</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precipitation</td>
<td style="text-align: right;">2.888000</td>
<td style="text-align: right;">10709</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Proximity_Stream</td>
<td style="text-align: right;">3.166000</td>
<td style="text-align: right;">9586</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Proximity_Fault</td>
<td style="text-align: right;">3.368000</td>
<td style="text-align: right;">10908</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Proximity_Settlement</td>
<td style="text-align: right;">3.418000</td>
<td style="text-align: right;">10140</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Proximity_Road</td>
<td style="text-align: right;">3.506000</td>
<td style="text-align: right;">10242</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Landuse_Vegetation</td>
<td style="text-align: right;">3.808000</td>
<td style="text-align: right;">2106</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">SPI</td>
<td style="text-align: right;">3.982000</td>
<td style="text-align: right;">9473</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">STI</td>
<td style="text-align: right;">4.198000</td>
<td style="text-align: right;">8035</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lithology_Sedimentary</td>
<td style="text-align: right;">4.984324</td>
<td style="text-align: right;">1685</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lithology_Plutonic</td>
<td style="text-align: right;">5.424900</td>
<td style="text-align: right;">1121</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lithology_Metamorphic</td>
<td style="text-align: right;">6.020288</td>
<td style="text-align: right;">1866</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lithology_Unconsolidated</td>
<td style="text-align: right;">6.050288</td>
<td style="text-align: right;">2045</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aspect_North</td>
<td style="text-align: right;">6.636828</td>
<td style="text-align: right;">1390</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aspect_SouthWest</td>
<td style="text-align: right;">6.700396</td>
<td style="text-align: right;">1682</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aspect_South</td>
<td style="text-align: right;">6.816360</td>
<td style="text-align: right;">1725</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aspect_SouthEast</td>
<td style="text-align: right;">6.882432</td>
<td style="text-align: right;">1762</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aspect_NorthEast</td>
<td style="text-align: right;">7.090540</td>
<td style="text-align: right;">1532</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aspect_West</td>
<td style="text-align: right;">7.229044</td>
<td style="text-align: right;">1550</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aspect_East</td>
<td style="text-align: right;">7.296576</td>
<td style="text-align: right;">1510</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>This table provides a detailed view of the variable importance scores, allowing us to better understand the contribution of each predictor variable to the model.</p>
</section>
<section id="assessing-predictor-contribution-to-model-transferability" class="level2">
<h2 class="anchored" data-anchor-id="assessing-predictor-contribution-to-model-transferability">5.5 Assessing Predictor Contribution to Model Transferability</h2>
<p>The <strong><code>rf_importance()</code></strong> function from the <strong><code>spatialRF</code></strong> package provides a way to assess the extent to which each predictor contributes to model transferability. Model transferability refers to the model’s predictive ability on independent spatial folds, which can be measured with the <strong><code>rf_evaluate()</code></strong> function (discussed later).</p>
<p>The <strong><code>rf_importance()</code></strong> function assesses predictor contribution by comparing the performance of the full model with models fitted without each predictor. The difference in performance between the full model and a model without a given predictor represents the contribution of that predictor to model transferability.</p>
<p>The code chunk below performs this operation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>non.spatial.rf <span class="ot">&lt;-</span> spatialRF<span class="sc">::</span><span class="fu">rf_importance</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> non.spatial.rf</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="partial-dependence-plot-pdp" class="level2">
<h2 class="anchored" data-anchor-id="partial-dependence-plot-pdp">5.6 Partial Dependence Plot (PDP)</h2>
<p>Partial dependence plots (PDPs) are a powerful tool in machine learning that allow us to visualize the relationship between predictor variables and the target outcome. Introduced by Friedman (2001), PDPs are used to interpret the output of complex machine learning models. They present the expected target outcomes as a function of the input variables and show the marginal effect one feature can have on the predicted outcome of the machine learning model.</p>
<p>In PDPs, the Y-axis value (ŷ) is defined by the average of all possible model predictions when the value of the objective predictor is at X. PDPs can reveal whether the relationship between the target and a feature is linear, monotonic, curvilinear, or of other complex types.</p>
<p>The code chunk below generates a partial dependence plot for our non-spatial random forest model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">plot_response_curves</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  non.spatial.rf,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">quantiles =</span> <span class="fl">0.5</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The above plot presents the PDPs of the 12 variables exhibiting the highest variable importance. For these plots, all other predictor variables are held constant at their median values (i.e., the 0.5 qu</p>
</section>
<section id="model-performance" class="level2">
<h2 class="anchored" data-anchor-id="model-performance">5.7 Model Performance</h2>
<p>The <strong><code>performance</code></strong> slot of our non-spatial random forest model (<strong><code>non.spatial.rf$performance</code></strong>) contains several performance measures. These can be printed using the <strong><code>print_performance()</code></strong> function from the <strong><code>spatialRF</code></strong> package.</p>
<ul>
<li><p><strong>R squared (oob)</strong> and <strong>RMSE (oob)</strong>: These are the R squared and root mean squared error (RMSE) of the model when predicting the out-of-bag data (the fraction of data not used to train individual trees). Among all the values available in the <strong><code>performance</code></strong> slot, these are probably the most honest ones, as they provide a performance estimate on independent data. However, out-of-bag data is not fully independent, and therefore these values will still be inflated, especially if the data is highly aggregated in space.</p></li>
<li><p><strong>R squared</strong> and <strong>pseudo R squared</strong>: These are computed from the observations and the predictions, and indicate to what extent model outcomes represent the input data. These values will usually be high if the data is highly aggregated in space.</p></li>
<li><p><strong>RMSE</strong> and its normalized version: These are computed via the <strong><code>root_mean_squared_error()</code></strong> function, and are linear with R squared and pseudo R squared.</p></li>
</ul>
<p>The code chunk below prints these performance measures:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">print_performance</span>(non.spatial.rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model performance 
  - R squared (oob):                  0.5446231
  - R squared (cor(obs, pred)^2):     0.9355865
  - Pseudo R squared (cor(obs, pred)):0.9672572
  - RMSE (oob):                       0.3342698
  - RMSE:                             0.1569
  - Normalized RMSE:                  0.1569</code></pre>
</div>
</div>
</section>
<section id="predicting-onto-new-data" class="level2">
<h2 class="anchored" data-anchor-id="predicting-onto-new-data"><strong>5.8</strong> Predicting onto New Data</h2>
<p>We can use our non-spatial random forest model to make predictions on the testing data. This is done using the <strong><code>stats::predict()</code></strong> function, which takes the model, the new data, and the type of prediction as arguments.</p>
<p>The code chunk below performs this prediction:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">predict</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> non.spatial.rf,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> testing_data,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After making the predictions, we can create a confusion matrix to evaluate the results. The confusion matrix provides a summary of the model’s performance by comparing the predicted values with the actual values.</p>
<p>The code chunk below creates a confusion matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>predicted_col <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicted <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>predicted_col <span class="ot">&lt;-</span> <span class="fu">factor</span>(predicted_col) </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predicted_col, test_col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5616  940
         1  762 3899
                                          
               Accuracy : 0.8483          
                 95% CI : (0.8415, 0.8549)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6893          
                                          
 Mcnemar's Test P-Value : 1.784e-05       
                                          
            Sensitivity : 0.8805          
            Specificity : 0.8057          
         Pos Pred Value : 0.8566          
         Neg Pred Value : 0.8365          
             Prevalence : 0.5686          
         Detection Rate : 0.5007          
   Detection Prevalence : 0.5845          
      Balanced Accuracy : 0.8431          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="permutation-test" class="level2">
<h2 class="anchored" data-anchor-id="permutation-test">5.9 Permutation Test</h2>
<p>Random Forest (RF) is a stochastic process, and to ensure that the results are not random, we can perform a permutation test. This involves repeating the RF process multiple times and comparing the results. In this case, we will repeat the process 10 times using the <strong><code>rf_repeat()</code></strong> function from the <strong><code>spatialRF</code></strong> package.</p>
<p>The code chunk below performs this permutation test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>non.spatial.rf.perm <span class="ot">&lt;-</span> <span class="fu">rf_repeat</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> non.spatial.rf, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repetitions =</span> <span class="dv">10</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_importance</span>(non.spatial.rf.perm, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After performing the permutation test, we can plot the variable importance scores and the partial dependence plots (PDPs) of the permuted RF model. These plots provide insights into the stability of the variable importance scores and the PDPs across the repeated RF processes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_response_curves</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  non.spatial.rf.perm, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">quantiles =</span> <span class="fl">0.5</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="morans-eigenvector-random-forest" class="level1">
<h1>6.0 Moran’s Eigenvector Random Forest</h1>
<p>Borcard and Legendre developed an approach called the Principal Coordinates of Neighbour Matrices (PCNM) to create spatial predictors that can be incorporated into models. Dray and Legendre further [2006] improved mathematical foundations of PCNM and investigated its close relation to Moran’s index of spatial autocorrelation (Moran’s I). They proposed Moran’s eigenvector approach which extract Moran’s Eigenvector Maps (MEMs) from the spatial weighting matrix.</p>
<p>The spatial weight matrix, denoted as W=[ <span class="math inline">\(w_ij\)</span>] , is an n×n matrix that represents the spatial relationships between different locations of n observations in the dataset. Each entry &nbsp;in the matrix represents the spatial relationship between location i and location j. The centring operator H subtracts the mean of each row and column from the elements of W, resulting in a doubly-centred weight matrix Ω where the row and column means are zero. By diagonalising this doubly-centred weight matrix Ω, eigenvectors obtained are orthogonal vectors with a unit norm that maximise Moran’s <em>I</em>. These eigenvectors are called Moran’s Eigenvector Maps (MEMs). The eigenvalues of MEMs are equal to the Moran’s I coefficients of spatial autocorrelation and describe the local structures of the observations in the dataset.</p>
<p><span class="math inline">\(Ω=HWH=(I-11^t/n) W (I-11^t/n)\)</span></p>
<p>where <span class="math inline">\(I\)</span> is the identity matrix, <span class="math inline">\(1\)</span> is the column vector of 1 and <span class="math inline">\(1^t\)</span> is the transpose of the column vector of 1.</p>
<p>Using the concept of MEMs, Benito introduced a methodological framework that generate MEMs from weight matrix and uses them as spatial predictors to fit a non-spatial RF model into a spatial RF model, which will be termed as Moran’s Eigenvector Random Forest (MERF) in this study. These spatial predictors can be used directly as explanatory variables to represent spatial processes not considered by the non-spatial predictors.</p>
<section id="fitting-merf-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-merf-model">6.1 Fitting MERF Model</h2>
<p>We use <code>rf_spatial</code> function to fit RF to MERF model by generating Moran’s eigenvectors and inclduing them into training dataset through sequential selection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>spatial.rf <span class="ot">&lt;-</span> spatialRF<span class="sc">::</span><span class="fu">rf_spatial</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> non.spatial.rf,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance.matrix =</span> distance.matrix,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance.thresholds =</span> distance.thresholds,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"mem.moran.sequential"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> random.seed,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="residual-spatial-autocorrelation-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="residual-spatial-autocorrelation-analysis-1">6.2 Residual Spatial Autocorrelation Analysis</h2>
<p>Just like we did with the non-spatial RF model, we can also test the residual autocorrelation for both RF and MERF models and compare the results. This can be done using the <strong><code>plot_moran()</code></strong> function from the <strong><code>spatialRF</code></strong> package.</p>
<p>The code chunk below performs residual spatial autocorrelation analysis for both RF and MERF models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">plot_moran</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  non.spatial.rf, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">plot_moran</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  spatial.rf, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the plots above, MERF has effectively eliminated the spatial autocorrelation of the model residuals for every spatial scale. The magnitude of spatial autocorrelation was reduced, as indicated by the decrease in Moran’s I values. The p-values of the Moran’s I estimates for each neighbourhood distance were higher than 0.05, indicating that they were statistically not significant.</p>
</section>
<section id="sequential-selection-of-spatial-predictors" class="level2">
<h2 class="anchored" data-anchor-id="sequential-selection-of-spatial-predictors">6.3 Sequential Selection of Spatial Predictors</h2>
<p>As explained earlier, the <strong><code>rf_spatial</code></strong> function generates Moran’s eigenvectors and includes them into the training dataset through sequential selection. The selection procedure is performed by the <strong><code>select_spatial_predictors_sequential()</code></strong> function, which finds the smaller subset of spatial predictors that maximizes the model’s R squared and minimizes the Moran’s I of the residuals. The <strong><code>rf_spatial</code></strong> function already automates this process, so there’s no need to manually run it. However, we can use the <strong><code>plot_optimization()</code></strong> function to visualize the optimization process. In the plot below, dots linked by lines represent the selected spatial predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> spatialRF<span class="sc">::</span><span class="fu">plot_optimization</span>(spatial.rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="plotting-spatial-predictors" class="level2">
<h2 class="anchored" data-anchor-id="plotting-spatial-predictors">6.4 Plotting Spatial Predictors</h2>
<p>We can also visualize the spatial predictors obtained from the Moran’s Eigenvector Random Forest (MERF) model. This can be done using the <strong><code>get_spatial_predictors()</code></strong> function from the <strong><code>spatialRF</code></strong> package, which retrieves the spatial predictors from the MERF model.</p>
<p>The code chunk below performs this operation and generates a plot of the spatial predictors using appropriate <code>ggplot2</code> functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>spatial.predictors <span class="ot">&lt;-</span> spatialRF<span class="sc">::</span><span class="fu">get_spatial_predictors</span>(spatial.rf)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(spatial.predictors, training_data[, <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)])</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(<span class="at">data =</span> valtellina, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pr,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> X,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> Y,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> spatial_predictor_55_8</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Eigenvalue"</span>) <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Variable: spatial_predictor_55_8"</span>) <span class="sc">+</span> </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>))<span class="sc">+</span> </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Longitude"</span>) <span class="sc">+</span> </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Latitude"</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="merf-variable-importance" class="level2">
<h2 class="anchored" data-anchor-id="merf-variable-importance">6.5 MERF Variable Importance</h2>
<p>The <strong><code>importance</code></strong> slot of our MERF model (<strong><code>spatial.rf$variable.importance</code></strong>) contains the variable importance scores. These scores provide a measure of the contribution of each predictor variable to the predictive power of the model.</p>
<p>We can visualize these importance scores using the <strong><code>plot_importance()</code></strong> function from the <strong><code>spatialRF</code></strong> package, print them with the <strong><code>print_importance()</code></strong> function, or retrieve the data frame of importance scores with the <strong><code>get_importance()</code></strong> function.</p>
<p>The code chunk below generates plots of the variable importance scores for both the RF and MERF models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> spatialRF<span class="sc">::</span><span class="fu">plot_importance</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  non.spatial.rf, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Non-spatial RF"</span>) </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> spatialRF<span class="sc">::</span><span class="fu">plot_importance</span>(</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  spatial.rf,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Spatial RF"</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>If we compare the variable importance plots of both models, we can see that the spatial model has an additional set of dots under the name “spatial_predictors”, and that the maximum importance of a few of these spatial predictors matches the importance of the most relevant non-spatial predictors.</p>
<p>We can also plot the 50 most important variables as below. This table provides a detailed view of the 50 most improtant variable importance and their scores, allowing us to better understand the contribution of each predictor variable to the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(spatial.rf<span class="sc">$</span>importance<span class="sc">$</span>per.variable, <span class="at">n =</span> <span class="dv">50</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"html"</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_paper</span>(<span class="st">"hover"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-paper lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">importance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Slope_Angle</td>
<td style="text-align: right;">0.224</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_55_8</td>
<td style="text-align: right;">0.139</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Profile_Curvature</td>
<td style="text-align: right;">0.137</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_124</td>
<td style="text-align: right;">0.120</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_55_12</td>
<td style="text-align: right;">0.120</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_35_14</td>
<td style="text-align: right;">0.114</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Elevation</td>
<td style="text-align: right;">0.105</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_9</td>
<td style="text-align: right;">0.101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plan_Curvature</td>
<td style="text-align: right;">0.100</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_35_22</td>
<td style="text-align: right;">0.098</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_165</td>
<td style="text-align: right;">0.095</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_3</td>
<td style="text-align: right;">0.091</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_134</td>
<td style="text-align: right;">0.090</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_43</td>
<td style="text-align: right;">0.089</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_1</td>
<td style="text-align: right;">0.088</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_35_8</td>
<td style="text-align: right;">0.086</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_162</td>
<td style="text-align: right;">0.082</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_32</td>
<td style="text-align: right;">0.081</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_147</td>
<td style="text-align: right;">0.080</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_20_29</td>
<td style="text-align: right;">0.078</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_22</td>
<td style="text-align: right;">0.077</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_55_10</td>
<td style="text-align: right;">0.070</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_82</td>
<td style="text-align: right;">0.070</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_62</td>
<td style="text-align: right;">0.070</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_35_16</td>
<td style="text-align: right;">0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_20_9</td>
<td style="text-align: right;">0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_166</td>
<td style="text-align: right;">0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_10</td>
<td style="text-align: right;">0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_90</td>
<td style="text-align: right;">0.068</td>
</tr>
<tr class="even">
<td style="text-align: left;">TWI</td>
<td style="text-align: right;">0.068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_35_13</td>
<td style="text-align: right;">0.067</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_35_10</td>
<td style="text-align: right;">0.067</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_55_11</td>
<td style="text-align: right;">0.066</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_20_8</td>
<td style="text-align: right;">0.066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_4</td>
<td style="text-align: right;">0.066</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_73</td>
<td style="text-align: right;">0.066</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_55_14</td>
<td style="text-align: right;">0.066</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_143</td>
<td style="text-align: right;">0.065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_20_12</td>
<td style="text-align: right;">0.065</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_182</td>
<td style="text-align: right;">0.064</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_112</td>
<td style="text-align: right;">0.062</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_88</td>
<td style="text-align: right;">0.061</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_35_6</td>
<td style="text-align: right;">0.061</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_38</td>
<td style="text-align: right;">0.060</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_2</td>
<td style="text-align: right;">0.060</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_35_20</td>
<td style="text-align: right;">0.060</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_29</td>
<td style="text-align: right;">0.060</td>
</tr>
<tr class="even">
<td style="text-align: left;">spatial_predictor_0_164</td>
<td style="text-align: right;">0.059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">spatial_predictor_0_140</td>
<td style="text-align: right;">0.058</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precipitation</td>
<td style="text-align: right;">0.058</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="partial-dependence-plots-pdp-for-merf" class="level2">
<h2 class="anchored" data-anchor-id="partial-dependence-plots-pdp-for-merf">6.6 Partial Dependence Plots (PDP) for MERF</h2>
<p>The code chunk below generates a partial dependence plot for our MERF forest model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">plot_response_curves</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  spatial.rf,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">quantiles =</span> <span class="fl">0.5</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="model-performance-1" class="level2">
<h2 class="anchored" data-anchor-id="model-performance-1">6.7 Model Performance</h2>
<p>The <strong><code>performance</code></strong> slot of our MERF model (<strong><code>spatial.rf$performance</code></strong>) contains several performance measures. These can be printed using the <strong><code>print_performance()</code></strong> function from the <strong><code>spatialRF</code></strong> package. We can compare these performance measures with those of the non-spatial RF model to understand how the inclusion of spatial predictors has affected the model’s performance.</p>
<p>The code chunk below prints these performance measures:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">print_performance</span>(spatial.rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model performance 
  - R squared (oob):                  0.7805373
  - R squared (cor(obs, pred)^2):     0.9820365
  - Pseudo R squared (cor(obs, pred)):0.9909776
  - RMSE (oob):                       0.2320556
  - RMSE:                             0.0958
  - Normalized RMSE:                  0.0958</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>spatialRF<span class="sc">::</span><span class="fu">print_performance</span>(non.spatial.rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model performance 
  - R squared (oob):                  0.5446231
  - R squared (cor(obs, pred)^2):     0.9355865
  - Pseudo R squared (cor(obs, pred)):0.9672572
  - RMSE (oob):                       0.3342698
  - RMSE:                             0.1569
  - Normalized RMSE:                  0.1569</code></pre>
</div>
</div>
<p>Based on our results, the performance of MERF model improved across all metrics compared to the basic RF model. This demonstrates the effectiveness of incorporating spatial variables into our model.</p>
</section>
<section id="spatial-folds-cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="spatial-folds-cross-validation">6.8 Spatial-Folds Cross-Validation</h2>
<p>To further evaluate the performance of our models, we conducted spatial fold cross-validation for both the RF and MERF models. The function <strong><code>rf_evaluate()</code></strong> provides an honest performance estimate based on spatial cross-validation, overcoming the limitations of the performance scores explained above.</p>
<p>In this process, we divided the training dataset into 10 spatially independent training and testing folds. We then fitted the model using each training fold and made predictions with each testing fold. Subsequently, we calculated the Area Under the Curve (AUC) values across the folds.</p>
<p>The code chunk below carries out 10 spatial fold cross-validation on RF model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>non.spatial.rf <span class="ot">&lt;-</span> <span class="fu">rf_evaluate</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  non.spatial.rf,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">repetitions =</span> <span class="dv">10</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xy =</span> xy,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">c</span>(<span class="st">"auc"</span>),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print_evaluation</span>(non.spatial.rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spatial evaluation 
  - Training fraction:             0.75
  - Spatial folds:                 10

 Metric Median   MAD Minimum Maximum
    auc  0.898 0.013   0.879   0.926</code></pre>
</div>
</div>
<p>We can also visualize the training and testing data of each spatial fold. The maps below show two sets of training and testing folds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> training_data[, <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>group<span class="fl">.2</span> <span class="ot">&lt;-</span> pr<span class="sc">$</span>group<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="st">"Training"</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>pr[non.spatial.rf<span class="sc">$</span>evaluation<span class="sc">$</span>spatial.folds[[<span class="dv">1</span>]]<span class="sc">$</span>testing, <span class="st">"group.1"</span>] <span class="ot">&lt;-</span> <span class="st">"Testing"</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>pr[non.spatial.rf<span class="sc">$</span>evaluation<span class="sc">$</span>spatial.folds[[<span class="dv">10</span>]]<span class="sc">$</span>testing, <span class="st">"group.2"</span>] <span class="ot">&lt;-</span> <span class="st">"Testing"</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(<span class="at">data =</span> valtellina, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> pr,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> X,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> Y,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> group<span class="fl">.1</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_viridis_d</span>(</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">end =</span> <span class="fl">0.5</span>, </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>, </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">"F"</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Group"</span>) <span class="sc">+</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Spatial fold 1"</span>) <span class="sc">+</span> </span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Longitude"</span>) <span class="sc">+</span> </span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Latitude"</span>)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(<span class="at">data =</span> valtellina, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">data =</span> pr,</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> X,</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> Y,</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> group<span class="fl">.2</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_viridis_d</span>(</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">end =</span> <span class="fl">0.5</span>, </span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span>, </span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">"F"</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Group"</span>) <span class="sc">+</span></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Spatial fold 10"</span>) <span class="sc">+</span> </span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Longitude"</span>) <span class="sc">+</span> </span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">""</span>)</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>We will do the same 10 spatial fold cross-validation for the MERF model as well:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>spatial.rf.eval <span class="ot">&lt;-</span> <span class="fu">rf_evaluate</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  spatial.rf,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">repetitions =</span> <span class="dv">10</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xy =</span> xy,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="st">"auc"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print_evaluation</span>(spatial.rf.eval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spatial evaluation 
  - Training fraction:             0.75
  - Spatial folds:                 10

 Metric Median   MAD Minimum Maximum
    auc  0.895 0.039   0.417   0.931</code></pre>
</div>
</div>
</section>
</section>
<section id="geographically-weighted-random-forest" class="level1">
<h1>7.0 Geographically Weighted Random Forest</h1>
<p>Geographically Weighted Random Forest (GWRF), proposed by (Georganos et al., 2019) is a spatial disaggregation of Random Forest (RF) models into an ensemble of local models. This formulation is based on the principles of the Geographically Weighted Regression (GWR) framework (Fotheringham et al., 2010) wherein a global process is decomposed into several local sub-models. This approach suggest that spatial interactions are better captured by an ensemble of local models, rather than including extensive spatial predictors in a single, global model such as MERF approach.</p>
<p>GWRF can be used as both a predictive and an explanatory tool. Similar to GWLR approach, a local RF sub-model is computed for each observation i and only including n number of nearby observations based on a pre-determined bandwidth. Essentially, this leads to the calculation of an RF in each training data point, with its own performance, predictive power and feature importance. The local feature importance values for each explanatory variable can be represented as a surface and depict the spatial non-stationary effects, similar to GWLR.</p>
<section id="bandwidth-selection" class="level2">
<h2 class="anchored" data-anchor-id="bandwidth-selection">7.1 Bandwidth Selection</h2>
<p>Before we fit the GWRF model, have to select bandwidth, we need to select an optimal bandwidth. The <strong><code>grf.bw</code></strong> function from the <strong><code>gwrf</code></strong> package is used for this purpose.</p>
<p>The <strong><code>step</code></strong> parameter is used to define the increment in the bandwidth during the optimization process. The <strong><code>bw.min</code></strong> and <strong><code>bw.max</code></strong> parameters define the range within which the optimal bandwidth is searched.geo.weighted. The <strong><code>geo.weighted</code></strong> parameter is a boolean flag that determines the type of random forest algorithm to use. If <strong><code>geo.weighted</code></strong> is set to <strong><code>TRUE</code></strong>, the algorithm calculates a Geographically Weighted Random Forest using the <strong><code>case.weights</code></strong> option of the <strong><code>ranger</code></strong> package. This means that each observation in the local dataset is weighted based on its geographical location. If <strong><code>geo.weighted</code></strong> is set to <strong><code>FALSE</code></strong>, it will calculate local random forests without weighting each observation in the local dataset.</p>
<p>Below is the code chunk for calculating bandwidth selection</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>grf.bw.orig <span class="ot">&lt;-</span> <span class="fu">grf.bw</span>(Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">data=</span>training_data, </span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">kernel=</span><span class="st">"adaptive"</span>, </span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords=</span>coords_train, </span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">bw.min =</span> <span class="dv">1</span>,</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">bw.max =</span> <span class="dv">306</span>, </span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">step =</span> <span class="dv">1</span>, </span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">trees=</span> <span class="dv">500</span>, </span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">importance=</span><span class="st">"impurity"</span>,</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">forests =</span> <span class="cn">FALSE</span>, </span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">geo.weighted =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Long Computation Time
</div>
</div>
<div class="callout-body-container callout-body">
<p>The above step is computationally intensive due to the brute force approach used in searching for the optimal bandwidth. This means that the function will try all possible bandwidths within the specified range and select the one that results in the best model performance. This can take a significant amount of time, especially if the range of possible bandwidths is large. It’s important to be aware of this when running the code.</p>
</div>
</div>
<p>The code chunk above calculates the Out-of-Bag (OOB) <span class="math inline">\(R^2\)</span> value for different bandwidths. A higher R2 value indicates a better fit of the model to the data. We have selected bandwidths of <strong>59</strong>, <strong>92</strong>, <strong>154</strong>, <strong>189</strong>, <strong>260</strong>, and <strong>306</strong>, as these values yielded the highest <span class="math inline">\(R^2\)</span> values, indicating optimal model performance.</p>
</section>
<section id="fitting-gwrf-models-with-different-bandwidths" class="level2">
<h2 class="anchored" data-anchor-id="fitting-gwrf-models-with-different-bandwidths">7.2 Fitting GWRF Models with Different Bandwidths</h2>
<p>In this section, we use the selected bandwidths to run different GWLR models. By comparing the results of these models, we can determine which bandwidth provides the best balance between model complexity and performance.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">59-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">92-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">154-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">189-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">260-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">306-Bandwidth GWRF</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_59 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">59</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_59, <span class="st">"data/rds/gwRF_adaptive_59.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_92 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span> <span class="dv">92</span>,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_92, <span class="st">"data/rds/gwRF_adaptive_92.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_154 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">154</span>,</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_154, <span class="st">"data/rds/gwRF_adaptive_154.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_189 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">189</span>,</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_189, <span class="st">"data/rds/gwRF_adaptive_189.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_260 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">260</span>,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_260, <span class="st">"data/rds/gwRF_adaptive_260.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_306 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">306</span>,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_306, <span class="st">"data/rds/gwRF_adaptive_306.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_59)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_92)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_154)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_189)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_260)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_306)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ls_data)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ls_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prediction-with-various-spatial-weights" class="level2">
<h2 class="anchored" data-anchor-id="prediction-with-various-spatial-weights">7.2 Prediction with Various Spatial Weights</h2>
<p>In previous section, we fitted a total of 6 GWRF models, each having different bandwidth. In this section, we will use these models to predict using different spatial weights.</p>
<p>In GWRF framework, prediction is carried out the fusion of global and local predictions using a weight parameter. This fusion of predictions enables the extraction of the locally heterogeneous signal (low bias) from the local sub-model and its integration with that of a global model which uses more data (low variance).</p>
<p>The weight parameter, denoted as α can be varied and user-specified. A purely global model is indicated by an α value of 0, which means it is devoid of any local model influence. Conversely, an α value of 1 denotes a purely local model, with no influence from the global model. For values between these thresholds, the weighting varies. For instance, an α value of 0.25 suggests a diminished weighting for the local model, thereby favouring the global one, while an α value of 0.75 implies a more favourable weighting for the local model over the global one. An α value of 0.50 signifies an equal weighting for both the local and global models.</p>
<p>Below is the code chunk for making predictions with various spatial weights.</p>
<ul>
<li><p>Preidctions are made using GWRF model with specific bandwidth and weight parameter.</p></li>
<li><p>Predictions are then converted to binary values.</p></li>
<li><p>Confusion matrix is computed using <code>testing_data</code></p></li>
<li><p>Accurarcy, precision, recall, and F1 scores are computed.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">59-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">92-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">154-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">189-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">260-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">306-Bandwidth GWRF</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_59 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_59.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_59 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_59,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_59, <span class="st">"data/rds/gwRF_pred_59_0.rds"</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_59 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_59)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>cm_59_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_59_0, <span class="st">"data/rds/cm_59_0.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>cm_59_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_59_0.rds"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>cm_59_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_59_0)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_59)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rm(gwRF_pred_59): object 'gwRF_pred_59' not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_59)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>f1_score.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pred_col_59"</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">5</span>),</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"0.25"</span>, <span class="st">"0.5"</span>, <span class="st">"0.75"</span>, <span class="st">"1"</span>),</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>, <span class="st">"pred_col_59"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_59 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_59,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_59, <span class="st">"data/rds/gwRF_pred_59_0.25.rds"</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_59 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_59)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_59_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_59_0.25.rds"</span>)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_59)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_59_0.25.rds"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5806  920
         1  572 3919
                                          
               Accuracy : 0.867           
                 95% CI : (0.8606, 0.8732)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7265          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9103          
            Specificity : 0.8099          
         Pos Pred Value : 0.8632          
         Neg Pred Value : 0.8726          
             Prevalence : 0.5686          
         Detection Rate : 0.5176          
   Detection Prevalence : 0.5996          
      Balanced Accuracy : 0.8601          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_59_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_59)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>, <span class="st">"pred_col_59"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_59 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_59,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_59, <span class="st">"data/rds/gwRF_pred_59_0.5.rds"</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_59 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_59)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_59_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_59_0.5.rds"</span>)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_59)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_59_0.5.rds"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5844  848
         1  534 3991
                                          
               Accuracy : 0.8768          
                 95% CI : (0.8706, 0.8828)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7469          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9163          
            Specificity : 0.8248          
         Pos Pred Value : 0.8733          
         Neg Pred Value : 0.8820          
             Prevalence : 0.5686          
         Detection Rate : 0.5210          
   Detection Prevalence : 0.5966          
      Balanced Accuracy : 0.8705          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_59_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_59)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>, <span class="st">"pred_col_59"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_59 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_59,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_59, <span class="st">"data/rds/gwRF_pred_59_0.75.rds"</span>)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_59 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_59)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_59_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_59_0.75.rds"</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_59)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_59_0.75.rds"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>cm_59_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5804  902
         1  574 3937
                                         
               Accuracy : 0.8684         
                 95% CI : (0.862, 0.8746)
    No Information Rate : 0.5686         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.7296         
                                         
 Mcnemar's Test P-Value : &lt; 2.2e-16      
                                         
            Sensitivity : 0.9100         
            Specificity : 0.8136         
         Pos Pred Value : 0.8655         
         Neg Pred Value : 0.8728         
             Prevalence : 0.5686         
         Detection Rate : 0.5174         
   Detection Prevalence : 0.5978         
      Balanced Accuracy : 0.8618         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_59_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_59)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>, <span class="st">"pred_col_59"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_59 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_59,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_59, <span class="st">"data/rds/gwRF_pred_59_1.rds"</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_59 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>pred_col_59 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_59)</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>cm_59_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_59_1, <span class="st">"data/rds/cm_59_1.rds"</span>)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_59)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>cm_59_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_59_1.rds"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>cm_59_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5717  996
         1  661 3843
                                          
               Accuracy : 0.8523          
                 95% CI : (0.8456, 0.8588)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6964          
                                          
 Mcnemar's Test P-Value : 2.304e-16       
                                          
            Sensitivity : 0.8964          
            Specificity : 0.7942          
         Pos Pred Value : 0.8516          
         Neg Pred Value : 0.8532          
             Prevalence : 0.5686          
         Detection Rate : 0.5097          
   Detection Prevalence : 0.5985          
      Balanced Accuracy : 0.8453          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_59_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_59)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_59, test_col)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>, <span class="st">"pred_col_59"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_59)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_92 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_92.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_92 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_92,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_92, <span class="st">"data/rds/gwRF_pred_92_0.rds"</span>)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_92 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_92)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>cm_92_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_92_0, <span class="st">"data/rds/cm_92_0.rds"</span>)</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_92)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>cm_92_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_92_0.rds"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>cm_92_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_92_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0, pred_col_92) </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_92"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_92"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_92 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_92,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_92, <span class="st">"data/rds/gwRF_pred_92_0.25.rds"</span>)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_92 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_92)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_92_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_92_0.25.rds"</span>)</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_92)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_92_0.25.rds"</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5792  921
         1  586 3918
                                          
               Accuracy : 0.8657          
                 95% CI : (0.8592, 0.8719)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7238          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9081          
            Specificity : 0.8097          
         Pos Pred Value : 0.8628          
         Neg Pred Value : 0.8699          
             Prevalence : 0.5686          
         Detection Rate : 0.5164          
   Detection Prevalence : 0.5985          
      Balanced Accuracy : 0.8589          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_92_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>, pred_col_92) </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_92"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_92 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_92,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_92, <span class="st">"data/rds/gwRF_pred_92_0.5.rds"</span>)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_92 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_92)</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_92_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_92_0.5.rds"</span>)</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_92)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_92_0.5.rds"</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5820  848
         1  558 3991
                                          
               Accuracy : 0.8747          
                 95% CI : (0.8684, 0.8807)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7426          
                                          
 Mcnemar's Test P-Value : 1.285e-14       
                                          
            Sensitivity : 0.9125          
            Specificity : 0.8248          
         Pos Pred Value : 0.8728          
         Neg Pred Value : 0.8773          
             Prevalence : 0.5686          
         Detection Rate : 0.5189          
   Detection Prevalence : 0.5945          
      Balanced Accuracy : 0.8686          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_92_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>, pred_col_92) </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_92"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_92 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_92,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_92, <span class="st">"data/rds/gwRF_pred_92_0.75.rds"</span>)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_92_0.75.rds"</span>)</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_92 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_92)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_92_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_92_0.75.rds"</span>)</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_92)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_92_0.75.rds"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>cm_92_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5796  877
         1  582 3962
                                          
               Accuracy : 0.8699          
                 95% CI : (0.8636, 0.8761)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7329          
                                          
 Mcnemar's Test P-Value : 1.393e-14       
                                          
            Sensitivity : 0.9087          
            Specificity : 0.8188          
         Pos Pred Value : 0.8686          
         Neg Pred Value : 0.8719          
             Prevalence : 0.5686          
         Detection Rate : 0.5167          
   Detection Prevalence : 0.5949          
      Balanced Accuracy : 0.8638          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_92_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>, pred_col_92) </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_92"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_92 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_92,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_92, <span class="st">"data/rds/gwRF_pred_92_1.rds"</span>)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_92 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>pred_col_92 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_92)</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>cm_92_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_92_1, <span class="st">"data/rds/cm_92_1.rds"</span>)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_92)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>cm_92_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_92_1.rds"</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>cm_92_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5741  973
         1  637 3866
                                          
               Accuracy : 0.8565          
                 95% CI : (0.8498, 0.8629)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.705           
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9001          
            Specificity : 0.7989          
         Pos Pred Value : 0.8551          
         Neg Pred Value : 0.8585          
             Prevalence : 0.5686          
         Detection Rate : 0.5118          
   Detection Prevalence : 0.5986          
      Balanced Accuracy : 0.8495          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_92_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1, pred_col_92) </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_92"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_92)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_154 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_154.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_154 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_154,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_154, <span class="st">"data/rds/gwRF_pred_154_0.rds"</span>)</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_154 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_154)</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>cm_154_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_154_0, <span class="st">"data/rds/cm_154_0.rds"</span>)</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_154)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>cm_154_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_154_0.rds"</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>cm_154_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_154_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0, pred_col_154) </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_92, test_col)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_154"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_154"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_154 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_154,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_154, <span class="st">"data/rds/gwRF_pred_154_0.25.rds"</span>)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_154 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_154)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_154_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_154_0.25.rds"</span>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_154)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_154_0.25.rds"</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5785  934
         1  593 3905
                                          
               Accuracy : 0.8639          
                 95% CI : (0.8574, 0.8702)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7201          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9070          
            Specificity : 0.8070          
         Pos Pred Value : 0.8610          
         Neg Pred Value : 0.8682          
             Prevalence : 0.5686          
         Detection Rate : 0.5157          
   Detection Prevalence : 0.5990          
      Balanced Accuracy : 0.8570          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_154_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>, pred_col_154) </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_154"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_154 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_154,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_154, <span class="st">"data/rds/gwRF_pred_154_0.5.rds"</span>)</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_154 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_154)</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_154_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_154_0.5.rds"</span>)</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_154)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_154_0.5.rds"</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5812  848
         1  566 3991
                                        
               Accuracy : 0.8739        
                 95% CI : (0.8677, 0.88)
    No Information Rate : 0.5686        
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16     
                                        
                  Kappa : 0.7412        
                                        
 Mcnemar's Test P-Value : 7.852e-14     
                                        
            Sensitivity : 0.9113        
            Specificity : 0.8248        
         Pos Pred Value : 0.8727        
         Neg Pred Value : 0.8758        
             Prevalence : 0.5686        
         Detection Rate : 0.5181        
   Detection Prevalence : 0.5937        
      Balanced Accuracy : 0.8680        
                                        
       'Positive' Class : 0             
                                        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_154_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>, pred_col_154) </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_154"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_154 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_154,</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_154, <span class="st">"data/rds/gwRF_pred_154_0.75.rds"</span>)</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_154 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_154)</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_154_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_154_0.75.rds"</span>)</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_154)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_154_0.75.rds"</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>cm_154_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5812  850
         1  566 3989
                                          
               Accuracy : 0.8738          
                 95% CI : (0.8675, 0.8799)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7408          
                                          
 Mcnemar's Test P-Value : 5.451e-14       
                                          
            Sensitivity : 0.9113          
            Specificity : 0.8243          
         Pos Pred Value : 0.8724          
         Neg Pred Value : 0.8757          
             Prevalence : 0.5686          
         Detection Rate : 0.5181          
   Detection Prevalence : 0.5939          
      Balanced Accuracy : 0.8678          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_154_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>, pred_col_154) </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_154"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>gwRF_pred_154 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_154,</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_154, <span class="st">"data/rds/gwRF_pred_154_1.rds"</span>)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_154 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>pred_col_154 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_154)</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>cm_154_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_154_1, <span class="st">"data/rds/cm_154_1.rds"</span>)</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_154)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>cm_154_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_154_1.rds"</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>cm_154_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5779  925
         1  599 3914
                                          
               Accuracy : 0.8641          
                 95% CI : (0.8577, 0.8704)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7208          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9061          
            Specificity : 0.8088          
         Pos Pred Value : 0.8620          
         Neg Pred Value : 0.8673          
             Prevalence : 0.5686          
         Detection Rate : 0.5152          
   Detection Prevalence : 0.5977          
      Balanced Accuracy : 0.8575          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_154_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1, pred_col_154) </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_154, test_col)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_154"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_154)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_189 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_189.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_189 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_189,</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_189, <span class="st">"data/rds/gwRF_pred_189_0.rds"</span>)</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_189 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_189)</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>cm_189_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_189_0, <span class="st">"data/rds/cm_189_0.rds"</span>)</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_189)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>cm_189_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_189_0.rds"</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>cm_189_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_189_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_189)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_189"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_189"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_189 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_189,</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_189, <span class="st">"data/rds/gwRF_pred_189_0.25.rds"</span>)</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_189 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_189)</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_189_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_189_0.25.rds"</span>)</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_189)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_189_0.25.rds"</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5773  938
         1  605 3901
                                          
               Accuracy : 0.8624          
                 95% CI : (0.8559, 0.8688)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7173          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9051          
            Specificity : 0.8062          
         Pos Pred Value : 0.8602          
         Neg Pred Value : 0.8657          
             Prevalence : 0.5686          
         Detection Rate : 0.5147          
   Detection Prevalence : 0.5983          
      Balanced Accuracy : 0.8557          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_189_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_189)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_189"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_189 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_189,</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_189, <span class="st">"data/rds/gwRF_pred_189_0.5.rds"</span>)</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_189 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_189)</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_189_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_189_0.5.rds"</span>)</span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_189)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_189_0.5.rds"</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5817  866
         1  561 3973
                                          
               Accuracy : 0.8728          
                 95% CI : (0.8665, 0.8789)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7387          
                                          
 Mcnemar's Test P-Value : 8.449e-16       
                                          
            Sensitivity : 0.9120          
            Specificity : 0.8210          
         Pos Pred Value : 0.8704          
         Neg Pred Value : 0.8763          
             Prevalence : 0.5686          
         Detection Rate : 0.5186          
   Detection Prevalence : 0.5958          
      Balanced Accuracy : 0.8665          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_189_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_189)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_189"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_189 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_189,</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>gwRF_pred_189 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gwRF_pred_189)</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_189, <span class="st">"data/rds/gwRF_pred_189_0.75.rds"</span>)</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_189 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_189)</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_189_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_189_0.75.rds"</span>)</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_189)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_189_0.75.rds"</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>cm_189_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5824  841
         1  554 3998
                                          
               Accuracy : 0.8756          
                 95% CI : (0.8694, 0.8817)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7447          
                                          
 Mcnemar's Test P-Value : 1.898e-14       
                                          
            Sensitivity : 0.9131          
            Specificity : 0.8262          
         Pos Pred Value : 0.8738          
         Neg Pred Value : 0.8783          
             Prevalence : 0.5686          
         Detection Rate : 0.5192          
   Detection Prevalence : 0.5942          
      Balanced Accuracy : 0.8697          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_189_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_189)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_189"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_189 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_189,</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_189, <span class="st">"data/rds/gwRF_pred_189_1.rds"</span>)</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_189 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>pred_col_189 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_189)</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>cm_189_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_189_1, <span class="st">"data/rds/cm_189_1.rds"</span>)</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_189)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>cm_189_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_189_1.rds"</span>)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>cm_189_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5785  902
         1  593 3937
                                         
               Accuracy : 0.8667         
                 95% CI : (0.8603, 0.873)
    No Information Rate : 0.5686         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.7262         
                                         
 Mcnemar's Test P-Value : 1.641e-15      
                                         
            Sensitivity : 0.9070         
            Specificity : 0.8136         
         Pos Pred Value : 0.8651         
         Neg Pred Value : 0.8691         
             Prevalence : 0.5686         
         Detection Rate : 0.5157         
   Detection Prevalence : 0.5961         
      Balanced Accuracy : 0.8603         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_189_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_189)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_189, test_col)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_189"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_189)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_260 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_260.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_260 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_260,</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_260, <span class="st">"data/rds/gwRF_pred_260_0.rds"</span>)</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_260 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_260)</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>cm_260_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_260_0, <span class="st">"data/rds/cm_260_0.rds"</span>)</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_260)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>cm_260_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_260_0.rds"</span>)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>cm_260_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_260_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_260)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_260"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_260"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_260 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_260,</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_260, <span class="st">"data/rds/gwRF_pred_260_0.25.rds"</span>)</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_260 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_260)</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_260_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_260_0.25.rds"</span>)</span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_260)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_260_0.25.rds"</span>)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5758  952
         1  620 3887
                                          
               Accuracy : 0.8599          
                 95% CI : (0.8533, 0.8662)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7119          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9028          
            Specificity : 0.8033          
         Pos Pred Value : 0.8581          
         Neg Pred Value : 0.8624          
             Prevalence : 0.5686          
         Detection Rate : 0.5133          
   Detection Prevalence : 0.5982          
      Balanced Accuracy : 0.8530          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_260_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_260)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_260"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_260 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_260,</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_260, <span class="st">"data/rds/gwRF_pred_260_0.5.rds"</span>)</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_260 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_260)</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_260_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_260_0.5.rds"</span>)</span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_260)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_260_0.5.rds"</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5807  877
         1  571 3962
                                          
               Accuracy : 0.8709          
                 95% CI : (0.8646, 0.8771)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7348          
                                          
 Mcnemar's Test P-Value : 1.099e-15       
                                          
            Sensitivity : 0.9105          
            Specificity : 0.8188          
         Pos Pred Value : 0.8688          
         Neg Pred Value : 0.8740          
             Prevalence : 0.5686          
         Detection Rate : 0.5177          
   Detection Prevalence : 0.5959          
      Balanced Accuracy : 0.8646          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_260_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_260)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_260"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_260 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_260,</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_260, <span class="st">"data/rds/gwRF_pred_260_0.75.rds"</span>)</span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_260 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_260)</span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_260_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_260_0.75.rds"</span>)</span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_260)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_260_0.75.rds"</span>)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>cm_260_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5799  853
         1  579 3986
                                         
               Accuracy : 0.8723         
                 95% CI : (0.866, 0.8785)
    No Information Rate : 0.5686         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.738          
                                         
 Mcnemar's Test P-Value : 5.423e-13      
                                         
            Sensitivity : 0.9092         
            Specificity : 0.8237         
         Pos Pred Value : 0.8718         
         Neg Pred Value : 0.8732         
             Prevalence : 0.5686         
         Detection Rate : 0.5170         
   Detection Prevalence : 0.5930         
      Balanced Accuracy : 0.8665         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_260_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_260)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_260"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_260 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_260,</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_260, <span class="st">"data/rds/gwRF_pred_260_1.rds"</span>)</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_260 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>pred_col_260 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_260)</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>cm_260_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_260_1, <span class="st">"data/rds/cm_260_1.rds"</span>)</span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_260)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>cm_260_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_260_1.rds"</span>)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>cm_260_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5773  869
         1  605 3970
                                          
               Accuracy : 0.8686          
                 95% CI : (0.8622, 0.8748)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7304          
                                          
 Mcnemar's Test P-Value : 7.372e-12       
                                          
            Sensitivity : 0.9051          
            Specificity : 0.8204          
         Pos Pred Value : 0.8692          
         Neg Pred Value : 0.8678          
             Prevalence : 0.5686          
         Detection Rate : 0.5147          
   Detection Prevalence : 0.5921          
      Balanced Accuracy : 0.8628          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_260_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_260)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_260, test_col)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_260"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_260)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_306 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_306.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_306 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_306,</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_306, <span class="st">"data/rds/gwRF_pred_306_0.rds"</span>)</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_306 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_306)</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>cm_306_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_306_0, <span class="st">"data/rds/cm_306_0.rds"</span>)</span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_306)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>cm_306_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_306_0.rds"</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>cm_306_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_306_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_306)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_306"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_306"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_306 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_306,</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_306, <span class="st">"data/rds/gwRF_pred_306_0.25.rds"</span>)</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_306 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_306)</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_306_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_306_0.25.rds"</span>)</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_306) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_306_0.25.rds"</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5757  951
         1  621 3888
                                          
               Accuracy : 0.8599          
                 95% CI : (0.8533, 0.8662)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.712           
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9026          
            Specificity : 0.8035          
         Pos Pred Value : 0.8582          
         Neg Pred Value : 0.8623          
             Prevalence : 0.5686          
         Detection Rate : 0.5132          
   Detection Prevalence : 0.5980          
      Balanced Accuracy : 0.8531          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_306_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_306)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_306"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_306 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_306,</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_306, <span class="st">"data/rds/gwRF_pred_306_0.5.rds"</span>)</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_306 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_306)</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_306_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_306_0.5.rds"</span>)</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_306) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_306_0.5.rds"</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5804  875
         1  574 3964
                                         
               Accuracy : 0.8708         
                 95% CI : (0.8645, 0.877)
    No Information Rate : 0.5686         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.7347         
                                         
 Mcnemar's Test P-Value : 3.245e-15      
                                         
            Sensitivity : 0.9100         
            Specificity : 0.8192         
         Pos Pred Value : 0.8690         
         Neg Pred Value : 0.8735         
             Prevalence : 0.5686         
         Detection Rate : 0.5174         
   Detection Prevalence : 0.5954         
      Balanced Accuracy : 0.8646         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_306_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_306)</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_306"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_306 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_306,</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_306, <span class="st">"data/rds/gwRF_pred_306_0.75.rds"</span>)</span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_306 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_306)</span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_306_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_306_0.75.rds"</span>)</span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_306) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_306_0.75.rds"</span>)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>cm_306_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5806  860
         1  572 3979
                                         
               Accuracy : 0.8723         
                 95% CI : (0.866, 0.8785)
    No Information Rate : 0.5686         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.7379         
                                         
 Mcnemar's Test P-Value : 3.345e-14      
                                         
            Sensitivity : 0.9103         
            Specificity : 0.8223         
         Pos Pred Value : 0.8710         
         Neg Pred Value : 0.8743         
             Prevalence : 0.5686         
         Detection Rate : 0.5176         
   Detection Prevalence : 0.5943         
      Balanced Accuracy : 0.8663         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_306_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_306)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_306"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_306 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_306,</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_306, <span class="st">"data/rds/gwRF_pred_306_1.rds"</span>)</span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_306 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>pred_col_306 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_306)</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>cm_306_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_306_1, <span class="st">"data/rds/cm_306_1.rds"</span>)</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_306) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>cm_306_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_306_1.rds"</span>)</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>cm_306_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5775  873
         1  603 3966
                                         
               Accuracy : 0.8684         
                 95% CI : (0.862, 0.8746)
    No Information Rate : 0.5686         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.73           
                                         
 Mcnemar's Test P-Value : 2.527e-12      
                                         
            Sensitivity : 0.9055         
            Specificity : 0.8196         
         Pos Pred Value : 0.8687         
         Neg Pred Value : 0.8680         
             Prevalence : 0.5686         
         Detection Rate : 0.5148         
   Detection Prevalence : 0.5927         
      Balanced Accuracy : 0.8625         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_306_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_306)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_306, test_col)</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_306"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_306)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-optimised-bandwidth" class="level2">
<h2 class="anchored" data-anchor-id="plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-optimised-bandwidth">7.3 Plotting GWRF Model Prediction Accuracy at Incrementing Weight &amp; Optimised Bandwidth</h2>
<p>In this section, we are plotting the prediction accuracy of the GWRFmodels at incrementing weight parameters and optimised bandwidths. The weight parameters range from 0 to 1 in increments of 0.25, and the optimised bandwidths used are 59, 92, 154, 189, 260, and 306.</p>
<p>The code chunk below creates a data frame with all combinations of weights and bandwidths, adds the accuracy values for each combination, and then creates a line plot of the accuracy against the bandwidth for each weight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"0.25"</span>, <span class="st">"0.50"</span>, <span class="st">"0.75"</span>, <span class="st">"1"</span>)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>bandwidths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">59</span>, <span class="dv">92</span>, <span class="dv">154</span>, <span class="dv">189</span>, <span class="dv">260</span>, <span class="dv">306</span>)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with all combinations of weights and bandwidths</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>df_gwRF <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Weight =</span> weights, <span class="at">Bandwidth =</span> bandwidths)</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add your accuracy values</span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>df_gwRF<span class="sc">$</span>Accuracy <span class="ot">&lt;-</span>  <span class="fu">c</span>(</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.8487</span>, <span class="fl">0.8670</span>, <span class="fl">0.8768</span>, <span class="fl">0.8684</span>, <span class="fl">0.8523</span>, </span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.8487</span>, <span class="fl">0.8657</span>, <span class="fl">0.8747</span>, <span class="fl">0.8699</span>, <span class="fl">0.8565</span>,</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.8487</span>, <span class="fl">0.8639</span>, <span class="fl">0.8739</span>, <span class="fl">0.8738</span>, <span class="fl">0.8641</span>,</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.8487</span>, <span class="fl">0.8264</span>, <span class="fl">0.8728</span>, <span class="fl">0.8756</span>, <span class="fl">0.8667</span>,</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.8487</span>, <span class="fl">0.8599</span>, <span class="fl">0.8709</span>, <span class="fl">0.8723</span>, <span class="fl">0.8686</span>,</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.8487</span>, <span class="fl">0.8599</span>, <span class="fl">0.8708</span>, <span class="fl">0.8723</span>, <span class="fl">0.8684</span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_gwRF, <span class="fu">aes</span>(<span class="at">x =</span> Bandwidth, <span class="at">y =</span> Accuracy, <span class="at">color =</span> Weight)) <span class="sc">+</span></span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">9</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bandwidth"</span>, <span class="at">y =</span> <span class="st">"Accuracy"</span>, <span class="at">title =</span> <span class="st">"GWRF Model Prediction Accuracy </span><span class="sc">\n</span><span class="st">at Incrementing Weight &amp; Optimised Bandwidth"</span>) <span class="sc">+</span></span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">59</span>, <span class="dv">92</span>, <span class="dv">154</span>, <span class="dv">189</span>, <span class="dv">260</span>,<span class="dv">306</span>)) <span class="sc">+</span></span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.82</span>, <span class="fl">0.89</span>)) <span class="sc">+</span></span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e4c838"</span>, <span class="st">"#de573e"</span>, <span class="st">"#b977cb"</span>, <span class="st">"#4225df"</span>, <span class="st">"#32c962"</span>)) <span class="sc">+</span></span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),  <span class="co"># Remove internal grid lines</span></span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-147-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="iteraction-with-standardised-bandwidths" class="level2">
<h2 class="anchored" data-anchor-id="iteraction-with-standardised-bandwidths">7.4 Iteraction with Standardised Bandwidths</h2>
<p>In the previous sections, we fitted, trained, and tested Geographically Weighted Random Forest (GWRF) models using optimised bandwidth values. However, the bandwidths used were random with different steps between them, which may make the observed result patterns not generalisable. To see if the patterns we observed earlier can be generalised (at least for our dataset), we will use standardised bandwidths with 50 steps to fit new models. We will use 50, 100, 150, 200, 250, and 300 as bandwidths.</p>
<p>Below is the code chunk that accomplishes this:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">50-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">100-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">150-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">200-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">250-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">300-Bandwidth GWRF</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_50 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">50</span>,</span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_50, <span class="st">"data/rds/gwRF_adaptive_50.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_100 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span> <span class="dv">100</span>,</span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-22"><a href="#cb226-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_100, <span class="st">"data/rds/gwRF_adaptive_100.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_150 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">150</span>,</span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_150, <span class="st">"data/rds/gwRF_adaptive_150.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_200 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb228-18"><a href="#cb228-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">200</span>,</span>
<span id="cb228-19"><a href="#cb228-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb228-20"><a href="#cb228-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb228-21"><a href="#cb228-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-22"><a href="#cb228-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_200, <span class="st">"data/rds/gwRF_adaptive_200.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_250 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">250</span>,</span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_250, <span class="st">"data/rds/gwRF_adaptive_250.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_300 <span class="ot">&lt;-</span> <span class="fu">grf</span>(<span class="at">formula =</span> Landslide <span class="sc">~</span> Elevation <span class="sc">+</span> </span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>                 Aspect_North <span class="sc">+</span> Aspect_NorthEast <span class="sc">+</span> </span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>                 Aspect_East <span class="sc">+</span> Aspect_SouthEast <span class="sc">+</span> </span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>                 Aspect_South <span class="sc">+</span> Aspect_SouthWest <span class="sc">+</span> </span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>                 Aspect_West <span class="sc">+</span> Profile_Curvature <span class="sc">+</span> </span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>                 Plan_Curvature <span class="sc">+</span> Slope_Angle <span class="sc">+</span> </span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>                 Lithology_Metamorphic <span class="sc">+</span> </span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>                 Lithology_Sedimentary <span class="sc">+</span> </span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>                 Lithology_Plutonic <span class="sc">+</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>                 Lithology_Unconsolidated <span class="sc">+</span></span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>                 Proximity_Settlement <span class="sc">+</span></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>                 Proximity_Stream <span class="sc">+</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>                 Proximity_Road <span class="sc">+</span> Proximity_Fault <span class="sc">+</span> </span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>                 Landuse_Vegetation <span class="sc">+</span> Precipitation <span class="sc">+</span> </span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>                 TWI <span class="sc">+</span> SPI <span class="sc">+</span> STI,</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dframe=</span>training_data, </span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bw=</span><span class="dv">300</span>,</span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords=</span>coords_train)</span>
<span id="cb230-21"><a href="#cb230-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-22"><a href="#cb230-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive_300, <span class="st">"data/rds/gwRF_adaptive_300.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_50)</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_100)</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_150)</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_200)</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_250)</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_300)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prediction-with-various-spatial-weights-1" class="level2">
<h2 class="anchored" data-anchor-id="prediction-with-various-spatial-weights-1">7.5 Prediction with Various Spatial Weights</h2>
<p>In this section, we will test the predictions using the newly fitted Geographically Weighted Random Forest (GWRF) models with standardised bandwidths at different weight parameters. This process is similar to what we did in the previous sections.</p>
<p>We will use these models to make predictions and then extract the performance metrics. These metrics will allow us to evaluate the performance of each model and compare the results with the GWRF models that were fitted with optimised bandwidths.</p>
<p>Below is the code chunk that accomplishes this:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">50-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">100-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">150-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">200-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">250-Bandwidth GWRF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">300-Bandwidth GWRF</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_50 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_50.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_50,</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_50, <span class="st">"data/rds/gwRF_pred_50_0.rds"</span>)</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_50_0.rds"</span>)</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_50 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_50)</span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a>cm_50_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_50_0, <span class="st">"data/rds/cm_50_0.rds"</span>)</span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>cm_50_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_50_0.rds"</span>)</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>cm_50_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_50_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_50)</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_50"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_50"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_50,</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_50, <span class="st">"data/rds/gwRF_pred_50_0.25.rds"</span>)</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_50_0.25.rds"</span>)</span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_50 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_50)</span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_50_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_50_0.25.rds"</span>)</span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_50_0.25.rds"</span>)</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5817  919
         1  561 3920
                                          
               Accuracy : 0.8681          
                 95% CI : (0.8617, 0.8743)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7286          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9120          
            Specificity : 0.8101          
         Pos Pred Value : 0.8636          
         Neg Pred Value : 0.8748          
             Prevalence : 0.5686          
         Detection Rate : 0.5186          
   Detection Prevalence : 0.6005          
      Balanced Accuracy : 0.8611          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_50_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_50)</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_50"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_50,</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_50, <span class="st">"data/rds/gwRF_pred_50_0.5.rds"</span>)</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_50_0.5.rds"</span>)</span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_50 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_50)</span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb243-17"><a href="#cb243-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_50_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_50_0.5.rds"</span>)</span>
<span id="cb243-18"><a href="#cb243-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_50_0.5.rds"</span>)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5853  851
         1  525 3988
                                          
               Accuracy : 0.8773          
                 95% CI : (0.8711, 0.8833)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7479          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9177          
            Specificity : 0.8241          
         Pos Pred Value : 0.8731          
         Neg Pred Value : 0.8837          
             Prevalence : 0.5686          
         Detection Rate : 0.5218          
   Detection Prevalence : 0.5977          
      Balanced Accuracy : 0.8709          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_50_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_50)</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb247-10"><a href="#cb247-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb247-11"><a href="#cb247-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb247-12"><a href="#cb247-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-13"><a href="#cb247-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_50"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_50,</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_50, <span class="st">"data/rds/gwRF_pred_50_0.75.rds"</span>)</span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_50_0.75.rds"</span>)</span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_50 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_50)</span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb248-18"><a href="#cb248-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_50_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_50_0.75.rds"</span>)</span>
<span id="cb248-19"><a href="#cb248-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_50_0.75.rds"</span>)</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>cm_50_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5822  923
         1  556 3916
                                          
               Accuracy : 0.8681          
                 95% CI : (0.8617, 0.8744)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7288          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9128          
            Specificity : 0.8093          
         Pos Pred Value : 0.8632          
         Neg Pred Value : 0.8757          
             Prevalence : 0.5686          
         Detection Rate : 0.5190          
   Detection Prevalence : 0.6013          
      Balanced Accuracy : 0.8610          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_50_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_50)</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_50"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) </span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_50,</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_50, <span class="st">"data/rds/gwRF_pred_50_1.rds"</span>)</span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a>gwRF_pred_50 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_50_1.rds"</span>)</span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_50 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a>pred_col_50 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_50)</span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-15"><a href="#cb253-15" aria-hidden="true" tabindex="-1"></a>cm_50_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb253-16"><a href="#cb253-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_50_1, <span class="st">"data/rds/cm_50_1.rds"</span>)</span>
<span id="cb253-17"><a href="#cb253-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>cm_50_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_50_1.rds"</span>)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>cm_50_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5942  892
         1  436 3947
                                          
               Accuracy : 0.8816          
                 95% CI : (0.8755, 0.8875)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7559          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9316          
            Specificity : 0.8157          
         Pos Pred Value : 0.8695          
         Neg Pred Value : 0.9005          
             Prevalence : 0.5686          
         Detection Rate : 0.5297          
   Detection Prevalence : 0.6093          
      Balanced Accuracy : 0.8737          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_50_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_50)</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_50, test_col)</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_50"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_100.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_100,</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_100, <span class="st">"data/rds/gwRF_pred_100_0.rds"</span>)</span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_100_0.rds"</span>)</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_100 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_100)</span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a>cm_100_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_100_0, <span class="st">"data/rds/cm_100_0.rds"</span>)</span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_100)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>cm_100_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_100_0.rds"</span>)</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>cm_100_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_100_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_100)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_100"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_100"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_100,</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_100, <span class="st">"data/rds/gwRF_pred_100_0.25.rds"</span>)</span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-11"><a href="#cb265-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_100_0.25.rds"</span>)</span>
<span id="cb265-12"><a href="#cb265-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-13"><a href="#cb265-13" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_100 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb265-14"><a href="#cb265-14" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_100)</span>
<span id="cb265-15"><a href="#cb265-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-16"><a href="#cb265-16" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb265-17"><a href="#cb265-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_100_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_100_0.25.rds"</span>)</span>
<span id="cb265-18"><a href="#cb265-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-19"><a href="#cb265-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_100)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_100_0.25.rds"</span>)</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5794  930
         1  584 3909
                                          
               Accuracy : 0.865           
                 95% CI : (0.8586, 0.8713)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7225          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9084          
            Specificity : 0.8078          
         Pos Pred Value : 0.8617          
         Neg Pred Value : 0.8700          
             Prevalence : 0.5686          
         Detection Rate : 0.5165          
   Detection Prevalence : 0.5994          
      Balanced Accuracy : 0.8581          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_100_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_100)</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_100"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_100,</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_100, <span class="st">"data/rds/gwRF_pred_100_0.5.rds"</span>)</span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_100_0.5.rds"</span>)</span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_100 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_100)</span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_100_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_100_0.5.rds"</span>)</span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_100)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_100_0.5.rds"</span>)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5824  848
         1  554 3991
                                          
               Accuracy : 0.875           
                 95% CI : (0.8687, 0.8811)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7433          
                                          
 Mcnemar's Test P-Value : 5.07e-15        
                                          
            Sensitivity : 0.9131          
            Specificity : 0.8248          
         Pos Pred Value : 0.8729          
         Neg Pred Value : 0.8781          
             Prevalence : 0.5686          
         Detection Rate : 0.5192          
   Detection Prevalence : 0.5948          
      Balanced Accuracy : 0.8689          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_100_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_100)</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-14"><a href="#cb274-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_100"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_100,</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_100, <span class="st">"data/rds/gwRF_pred_100_0.75.rds"</span>)</span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_100_0.75.rds"</span>)</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_100 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_100)</span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_100_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_100_0.75.rds"</span>)</span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_100)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_100_0.75.rds"</span>)</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>cm_100_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5796  878
         1  582 3961
                                         
               Accuracy : 0.8698         
                 95% CI : (0.8635, 0.876)
    No Information Rate : 0.5686         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.7327         
                                         
 Mcnemar's Test P-Value : 1.159e-14      
                                         
            Sensitivity : 0.9087         
            Specificity : 0.8186         
         Pos Pred Value : 0.8684         
         Neg Pred Value : 0.8719         
             Prevalence : 0.5686         
         Detection Rate : 0.5167         
   Detection Prevalence : 0.5950         
      Balanced Accuracy : 0.8637         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_100_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_100)</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb279-10"><a href="#cb279-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb279-11"><a href="#cb279-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb279-12"><a href="#cb279-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-13"><a href="#cb279-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_100"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_100,</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_100, <span class="st">"data/rds/gwRF_pred_100_1.rds"</span>)</span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_100 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_100_1.rds"</span>)</span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_100 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb280-14"><a href="#cb280-14" aria-hidden="true" tabindex="-1"></a>pred_col_100 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_100)</span>
<span id="cb280-15"><a href="#cb280-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-16"><a href="#cb280-16" aria-hidden="true" tabindex="-1"></a>cm_100_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb280-17"><a href="#cb280-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_100_1, <span class="st">"data/rds/cm_100_1.rds"</span>)</span>
<span id="cb280-18"><a href="#cb280-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-19"><a href="#cb280-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_100)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>cm_100_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_100_1.rds"</span>)</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>cm_100_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5752  955
         1  626 3884
                                          
               Accuracy : 0.8591          
                 95% CI : (0.8525, 0.8654)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7103          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9019          
            Specificity : 0.8026          
         Pos Pred Value : 0.8576          
         Neg Pred Value : 0.8612          
             Prevalence : 0.5686          
         Detection Rate : 0.5128          
   Detection Prevalence : 0.5979          
      Balanced Accuracy : 0.8522          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_100_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_100)</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_100, test_col)</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_100"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_100"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_100)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_150 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_150.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_150,</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_150, <span class="st">"data/rds/gwRF_pred_150_0.rds"</span>)</span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_150_0.rds"</span>)</span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-13"><a href="#cb287-13" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_150 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb287-14"><a href="#cb287-14" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_150)</span>
<span id="cb287-15"><a href="#cb287-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-16"><a href="#cb287-16" aria-hidden="true" tabindex="-1"></a>cm_150_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb287-17"><a href="#cb287-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_150_0, <span class="st">"data/rds/cm_150_0.rds"</span>)</span>
<span id="cb287-18"><a href="#cb287-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-19"><a href="#cb287-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_150) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>cm_150_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_150_0.rds"</span>)</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>cm_150_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_150_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_150)</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_150"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb291-14"><a href="#cb291-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-15"><a href="#cb291-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_150"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_150,</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_150, <span class="st">"data/rds/gwRF_pred_150_0.25.rds"</span>)</span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_150_0.25.rds"</span>)</span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-13"><a href="#cb292-13" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_150 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb292-14"><a href="#cb292-14" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_150)</span>
<span id="cb292-15"><a href="#cb292-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-16"><a href="#cb292-16" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb292-17"><a href="#cb292-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_150_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_150_0.25.rds"</span>)</span>
<span id="cb292-18"><a href="#cb292-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-19"><a href="#cb292-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_150)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_150_0.25.rds"</span>)</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5779  930
         1  599 3909
                                        
               Accuracy : 0.8637        
                 95% CI : (0.8572, 0.87)
    No Information Rate : 0.5686        
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16     
                                        
                  Kappa : 0.7198        
                                        
 Mcnemar's Test P-Value : &lt; 2.2e-16     
                                        
            Sensitivity : 0.9061        
            Specificity : 0.8078        
         Pos Pred Value : 0.8614        
         Neg Pred Value : 0.8671        
             Prevalence : 0.5686        
         Detection Rate : 0.5152        
   Detection Prevalence : 0.5981        
      Balanced Accuracy : 0.8569        
                                        
       'Positive' Class : 0             
                                        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_150_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_150)</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_150"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_150,</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_150, <span class="st">"data/rds/gwRF_pred_150_0.5.rds"</span>)</span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_150_0.5.rds"</span>)</span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_150 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_150)</span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb297-16"><a href="#cb297-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_150_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_150_0.5.rds"</span>)</span>
<span id="cb297-17"><a href="#cb297-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_150)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_150_0.5.rds"</span>)</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5804  848
         1  574 3991
                                          
               Accuracy : 0.8732          
                 95% CI : (0.8669, 0.8793)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7398          
                                          
 Mcnemar's Test P-Value : 4.501e-13       
                                          
            Sensitivity : 0.9100          
            Specificity : 0.8248          
         Pos Pred Value : 0.8725          
         Neg Pred Value : 0.8743          
             Prevalence : 0.5686          
         Detection Rate : 0.5174          
   Detection Prevalence : 0.5930          
      Balanced Accuracy : 0.8674          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_150_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_150)</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_150"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_150,</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_150, <span class="st">"data/rds/gwRF_pred_150_0.75.rds"</span>)</span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_150_0.75.rds"</span>)</span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_150 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_150)</span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_150_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_150_0.75.rds"</span>)</span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_150)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_150_0.75.rds"</span>)</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>cm_150_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5799  860
         1  579 3979
                                          
               Accuracy : 0.8717          
                 95% CI : (0.8654, 0.8778)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7367          
                                          
 Mcnemar's Test P-Value : 1.569e-13       
                                          
            Sensitivity : 0.9092          
            Specificity : 0.8223          
         Pos Pred Value : 0.8709          
         Neg Pred Value : 0.8730          
             Prevalence : 0.5686          
         Detection Rate : 0.5170          
   Detection Prevalence : 0.5937          
      Balanced Accuracy : 0.8657          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_150_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_150)</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb306-10"><a href="#cb306-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb306-11"><a href="#cb306-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb306-12"><a href="#cb306-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-13"><a href="#cb306-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_150"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_150,</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_150, <span class="st">"data/rds/gwRF_pred_150_1.rds"</span>)</span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_150 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_150_1.rds"</span>)</span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_150 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a>pred_col_150 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_150)</span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a>cm_150_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb307-17"><a href="#cb307-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_150_1, <span class="st">"data/rds/cm_150_1.rds"</span>)</span>
<span id="cb307-18"><a href="#cb307-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-19"><a href="#cb307-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_150)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>cm_150_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_150_1.rds"</span>)</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>cm_150_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5761  926
         1  617 3913
                                          
               Accuracy : 0.8624          
                 95% CI : (0.8559, 0.8688)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7174          
                                          
 Mcnemar's Test P-Value : 4.472e-15       
                                          
            Sensitivity : 0.9033          
            Specificity : 0.8086          
         Pos Pred Value : 0.8615          
         Neg Pred Value : 0.8638          
             Prevalence : 0.5686          
         Detection Rate : 0.5136          
   Detection Prevalence : 0.5961          
      Balanced Accuracy : 0.8559          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_150_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> pred_weight_1[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">colnames</span>(pred_weight_1) <span class="sc">==</span> <span class="st">"pred_col_150"</span>)]</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_150)</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_150, test_col)</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_150"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_150)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_200 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_200.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-47-contents" aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-47" class="callout-47-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_200,</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_200, <span class="st">"data/rds/gwRF_pred_200_0.rds"</span>)</span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_200_0.rds"</span>)</span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_200 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_200)</span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a>cm_200_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_200_0, <span class="st">"data/rds/cm_200_0.rds"</span>)</span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>cm_200_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_200_0.rds"</span>)</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>cm_200_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5710 1029
         1  668 3810
                                          
               Accuracy : 0.8487          
                 95% CI : (0.8419, 0.8553)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6888          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.8953          
            Specificity : 0.7874          
         Pos Pred Value : 0.8473          
         Neg Pred Value : 0.8508          
             Prevalence : 0.5686          
         Detection Rate : 0.5090          
   Detection Prevalence : 0.6008          
      Balanced Accuracy : 0.8413          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_200_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_200)</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_200"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_200"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_200,</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_200, <span class="st">"data/rds/gwRF_pred_200_0.25.rds"</span>)</span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_200_0.25.rds"</span>)</span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-13"><a href="#cb319-13" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_200 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb319-14"><a href="#cb319-14" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_200)</span>
<span id="cb319-15"><a href="#cb319-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-16"><a href="#cb319-16" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb319-17"><a href="#cb319-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_200_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_200_0.25.rds"</span>)</span>
<span id="cb319-18"><a href="#cb319-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-19"><a href="#cb319-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_200_0.25.rds"</span>)</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5776  941
         1  602 3898
                                          
               Accuracy : 0.8624          
                 95% CI : (0.8559, 0.8688)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7172          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9056          
            Specificity : 0.8055          
         Pos Pred Value : 0.8599          
         Neg Pred Value : 0.8662          
             Prevalence : 0.5686          
         Detection Rate : 0.5149          
   Detection Prevalence : 0.5988          
      Balanced Accuracy : 0.8556          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_200_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_200)</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_200"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-49-contents" aria-controls="callout-49" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-49" class="callout-49-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_200,</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_200, <span class="st">"data/rds/gwRF_pred_200_0.5.rds"</span>)</span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_200_0.5.rds"</span>)</span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_200 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_200)</span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-15"><a href="#cb324-15" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb324-16"><a href="#cb324-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_200_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_200_0.5.rds"</span>)</span>
<span id="cb324-17"><a href="#cb324-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_200_0.5.rds"</span>)</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5827  861
         1  551 3978
                                          
               Accuracy : 0.8741          
                 95% CI : (0.8678, 0.8802)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7414          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9136          
            Specificity : 0.8221          
         Pos Pred Value : 0.8713          
         Neg Pred Value : 0.8783          
             Prevalence : 0.5686          
         Detection Rate : 0.5195          
   Detection Prevalence : 0.5962          
      Balanced Accuracy : 0.8678          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_200_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_200)</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_200"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-50-contents" aria-controls="callout-50" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-50" class="callout-50-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_200,</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_200, <span class="st">"data/rds/gwRF_pred_200_0.75.rds"</span>)</span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_200_0.75.rds"</span>)</span>
<span id="cb329-13"><a href="#cb329-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-14"><a href="#cb329-14" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_200 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb329-15"><a href="#cb329-15" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_200)</span>
<span id="cb329-16"><a href="#cb329-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-17"><a href="#cb329-17" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb329-18"><a href="#cb329-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_200_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_200_0.75.rds"</span>)</span>
<span id="cb329-19"><a href="#cb329-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-20"><a href="#cb329-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_200_0.75.rds"</span>)</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>cm_200_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5821  841
         1  557 3998
                                          
               Accuracy : 0.8754          
                 95% CI : (0.8691, 0.8814)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7441          
                                          
 Mcnemar's Test P-Value : 3.764e-14       
                                          
            Sensitivity : 0.9127          
            Specificity : 0.8262          
         Pos Pred Value : 0.8738          
         Neg Pred Value : 0.8777          
             Prevalence : 0.5686          
         Detection Rate : 0.5189          
   Detection Prevalence : 0.5939          
      Balanced Accuracy : 0.8694          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_200_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_200)</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_200"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-51-contents" aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-51" class="callout-51-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_200,</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_200, <span class="st">"data/rds/gwRF_pred_200_1.rds"</span>)</span>
<span id="cb334-10"><a href="#cb334-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-11"><a href="#cb334-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_200 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_200_1.rds"</span>)</span>
<span id="cb334-12"><a href="#cb334-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-13"><a href="#cb334-13" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_200 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb334-14"><a href="#cb334-14" aria-hidden="true" tabindex="-1"></a>pred_col_200 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_200)</span>
<span id="cb334-15"><a href="#cb334-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-16"><a href="#cb334-16" aria-hidden="true" tabindex="-1"></a>cm_200_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb334-17"><a href="#cb334-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_200_1, <span class="st">"data/rds/cm_200_1.rds"</span>)</span>
<span id="cb334-18"><a href="#cb334-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>cm_200_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_200_1.rds"</span>)</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>cm_200_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5796  887
         1  582 3952
                                          
               Accuracy : 0.869           
                 95% CI : (0.8627, 0.8752)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.731           
                                          
 Mcnemar's Test P-Value : 2.163e-15       
                                          
            Sensitivity : 0.9087          
            Specificity : 0.8167          
         Pos Pred Value : 0.8673          
         Neg Pred Value : 0.8716          
             Prevalence : 0.5686          
         Detection Rate : 0.5167          
   Detection Prevalence : 0.5958          
      Balanced Accuracy : 0.8627          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_200_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_200)</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_200, test_col)</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_200"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_250 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_250.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-52-contents" aria-controls="callout-52" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-52" class="callout-52-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_250,</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_250, <span class="st">"data/rds/gwRF_pred_250_0.rds"</span>)</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_250_0.rds"</span>)</span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_250 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_250)</span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>cm_250_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_250_0, <span class="st">"data/rds/cm_250_0.rds"</span>)</span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>cm_250_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_250_0.rds"</span>)</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>cm_250_0</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_250_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_250)</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb343-7"><a href="#cb343-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb343-8"><a href="#cb343-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-9"><a href="#cb343-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb343-10"><a href="#cb343-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb343-11"><a href="#cb343-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb343-12"><a href="#cb343-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-13"><a href="#cb343-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_250"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb343-14"><a href="#cb343-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-15"><a href="#cb343-15" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_250"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-53-contents" aria-controls="callout-53" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-53" class="callout-53-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_250,</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-9"><a href="#cb344-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_250, <span class="st">"data/rds/gwRF_pred_250_0.25.rds"</span>)</span>
<span id="cb344-10"><a href="#cb344-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-11"><a href="#cb344-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_250_0.25.rds"</span>)</span>
<span id="cb344-12"><a href="#cb344-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-13"><a href="#cb344-13" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_250 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb344-14"><a href="#cb344-14" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_250)</span>
<span id="cb344-15"><a href="#cb344-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-16"><a href="#cb344-16" aria-hidden="true" tabindex="-1"></a>cm_250_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb344-17"><a href="#cb344-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_250_0, <span class="st">"data/rds/cm_250_0.25.rds"</span>)</span>
<span id="cb344-18"><a href="#cb344-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>cm_250_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_250_0.25.rds"</span>)</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>cm_250_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5765  953
         1  613 3886
                                          
               Accuracy : 0.8604          
                 95% CI : (0.8538, 0.8668)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.713           
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9039          
            Specificity : 0.8031          
         Pos Pred Value : 0.8581          
         Neg Pred Value : 0.8637          
             Prevalence : 0.5686          
         Detection Rate : 0.5140          
   Detection Prevalence : 0.5989          
      Balanced Accuracy : 0.8535          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_250_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_250)</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb348-8"><a href="#cb348-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-9"><a href="#cb348-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb348-10"><a href="#cb348-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb348-11"><a href="#cb348-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb348-12"><a href="#cb348-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-13"><a href="#cb348-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_250"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-54-contents" aria-controls="callout-54" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-54" class="callout-54-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_250,</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_250, <span class="st">"data/rds/gwRF_pred_250_0.5.rds"</span>)</span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_250_0.5.rds"</span>)</span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-13"><a href="#cb349-13" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_250 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb349-14"><a href="#cb349-14" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_250)</span>
<span id="cb349-15"><a href="#cb349-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-16"><a href="#cb349-16" aria-hidden="true" tabindex="-1"></a>cm_250_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb349-17"><a href="#cb349-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_250_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_250_0.5.rds"</span>)</span>
<span id="cb349-18"><a href="#cb349-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>cm_250_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_250_0.5.rds"</span>)</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>cm_250_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5810  867
         1  568 3972
                                          
               Accuracy : 0.8721          
                 95% CI : (0.8657, 0.8782)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7373          
                                          
 Mcnemar's Test P-Value : 3.642e-15       
                                          
            Sensitivity : 0.9109          
            Specificity : 0.8208          
         Pos Pred Value : 0.8702          
         Neg Pred Value : 0.8749          
             Prevalence : 0.5686          
         Detection Rate : 0.5180          
   Detection Prevalence : 0.5953          
      Balanced Accuracy : 0.8659          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_250_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_250)</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-13"><a href="#cb353-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_250"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-55-contents" aria-controls="callout-55" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-55" class="callout-55-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_250,</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_250, <span class="st">"data/rds/gwRF_pred_250_0.75.rds"</span>)</span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_250_0.75.rds"</span>)</span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_250 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_250)</span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-16"><a href="#cb354-16" aria-hidden="true" tabindex="-1"></a>cm_250_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb354-17"><a href="#cb354-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_250_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_250_0.75.rds"</span>)</span>
<span id="cb354-18"><a href="#cb354-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>cm_250_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_250_0.75.rds"</span>)</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>cm_250_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5808  843
         1  570 3996
                                          
               Accuracy : 0.874           
                 95% CI : (0.8677, 0.8801)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7415          
                                          
 Mcnemar's Test P-Value : 4.622e-13       
                                          
            Sensitivity : 0.9106          
            Specificity : 0.8258          
         Pos Pred Value : 0.8733          
         Neg Pred Value : 0.8752          
             Prevalence : 0.5686          
         Detection Rate : 0.5178          
   Detection Prevalence : 0.5929          
      Balanced Accuracy : 0.8682          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_250_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_250)</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb358-10"><a href="#cb358-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb358-11"><a href="#cb358-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb358-12"><a href="#cb358-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-13"><a href="#cb358-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_250"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-56-contents" aria-controls="callout-56" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-56" class="callout-56-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_250,</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_250, <span class="st">"data/rds/gwRF_pred_250_1.rds"</span>)</span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a>gwRF_pred_250 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_250_1.rds"</span>)</span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_250 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>pred_col_250 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_250)</span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>cm_250_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_250_1, <span class="st">"data/rds/cm_250_1.rds"</span>)</span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>cm_250_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_250_1.rds"</span>)</span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>cm_250_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5790  879
         1  588 3960
                                          
               Accuracy : 0.8692          
                 95% CI : (0.8628, 0.8754)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7315          
                                          
 Mcnemar's Test P-Value : 3.689e-14       
                                          
            Sensitivity : 0.9078          
            Specificity : 0.8184          
         Pos Pred Value : 0.8682          
         Neg Pred Value : 0.8707          
             Prevalence : 0.5686          
         Detection Rate : 0.5162          
   Detection Prevalence : 0.5945          
      Balanced Accuracy : 0.8631          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_250_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_250)</span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_250, test_col)</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_250"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_250)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive_300 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_adaptive_300.rds"</span>)</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_score.df &lt;- read_rds("data/rds/f1_score.df.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-57-contents" aria-controls="callout-57" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-57" class="callout-57-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_300,</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">0</span>,</span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">1</span>)</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_300, <span class="st">"data/rds/gwRF_pred_300_0.rds"</span>)</span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_300_0.rds"</span>)</span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_300 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_300)</span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true" tabindex="-1"></a>cm_300_0 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_300_0, <span class="st">"data/rds/cm_300_0.rds"</span>)</span>
<span id="cb366-18"><a href="#cb366-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_300)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>cm_300_0 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_300_0.rds"</span>)</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>cm_300_0</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_300_0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pred_weight_0 &lt;- as.data.frame(pred_col_300)</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>pred_weight_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0,pred_col_300)</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[,<span class="st">"pred_col_300"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0"</span>,<span class="st">"pred_col_300"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-58-contents" aria-controls="callout-58" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.25
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-58" class="callout-58-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_300,</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.25</span>,</span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.75</span>)</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_300, <span class="st">"data/rds/gwRF_pred_300_0.25.rds"</span>)</span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_300_0.25.rds"</span>)</span>
<span id="cb369-13"><a href="#cb369-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-14"><a href="#cb369-14" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_300 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb369-15"><a href="#cb369-15" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_300)</span>
<span id="cb369-16"><a href="#cb369-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-17"><a href="#cb369-17" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb369-18"><a href="#cb369-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_300_0<span class="fl">.25</span>, <span class="st">"data/rds/cm_300_0.25.rds"</span>)</span>
<span id="cb369-19"><a href="#cb369-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_300)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_300_0.25.rds"</span>)</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5762  949
         1  616 3890
                                          
               Accuracy : 0.8605          
                 95% CI : (0.8539, 0.8668)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7132          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9034          
            Specificity : 0.8039          
         Pos Pred Value : 0.8586          
         Neg Pred Value : 0.8633          
             Prevalence : 0.5686          
         Detection Rate : 0.5137          
   Detection Prevalence : 0.5983          
      Balanced Accuracy : 0.8537          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_300_0<span class="fl">.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_300)</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.25</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.25</span>,pred_col_300)</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb373-13"><a href="#cb373-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-14"><a href="#cb373-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.25"</span>,<span class="st">"pred_col_300"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-59-contents" aria-controls="callout-59" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-59" class="callout-59-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_300,</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.5</span>,</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.5</span>)</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_300, <span class="st">"data/rds/gwRF_pred_300_0.5.rds"</span>)</span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-11"><a href="#cb374-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_300_0.5.rds"</span>)</span>
<span id="cb374-12"><a href="#cb374-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-13"><a href="#cb374-13" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_300 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb374-14"><a href="#cb374-14" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_300)</span>
<span id="cb374-15"><a href="#cb374-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-16"><a href="#cb374-16" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb374-17"><a href="#cb374-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_300_0<span class="fl">.5</span>, <span class="st">"data/rds/cm_300_0.5.rds"</span>)</span>
<span id="cb374-18"><a href="#cb374-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_300)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_300_0.5.rds"</span>)</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5812  885
         1  566 3954
                                          
               Accuracy : 0.8706          
                 95% CI : (0.8643, 0.8768)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7342          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9113          
            Specificity : 0.8171          
         Pos Pred Value : 0.8679          
         Neg Pred Value : 0.8748          
             Prevalence : 0.5686          
         Detection Rate : 0.5181          
   Detection Prevalence : 0.5970          
      Balanced Accuracy : 0.8642          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_300_0<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_300)</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.5</span>,pred_col_300)</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.5"</span>,<span class="st">"pred_col_300"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-60-contents" aria-controls="callout-60" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 0.75
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-60" class="callout-60-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_300,</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="fl">0.75</span>,</span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="fl">0.25</span>)</span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-9"><a href="#cb379-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_300, <span class="st">"data/rds/gwRF_pred_300_0.75.rds"</span>)</span>
<span id="cb379-10"><a href="#cb379-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-11"><a href="#cb379-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_300_0.75.rds"</span>)</span>
<span id="cb379-12"><a href="#cb379-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-13"><a href="#cb379-13" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_300 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb379-14"><a href="#cb379-14" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_300)</span>
<span id="cb379-15"><a href="#cb379-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-16"><a href="#cb379-16" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb379-17"><a href="#cb379-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_300_0<span class="fl">.75</span>, <span class="st">"data/rds/cm_300_0.75.rds"</span>)</span>
<span id="cb379-18"><a href="#cb379-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_300)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_300_0.75.rds"</span>)</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>cm_300_0<span class="fl">.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5805  861
         1  573 3978
                                          
               Accuracy : 0.8722          
                 95% CI : (0.8658, 0.8783)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7375          
                                          
 Mcnemar's Test P-Value : 3.484e-14       
                                          
            Sensitivity : 0.9102          
            Specificity : 0.8221          
         Pos Pred Value : 0.8708          
         Neg Pred Value : 0.8741          
             Prevalence : 0.5686          
         Detection Rate : 0.5175          
   Detection Prevalence : 0.5943          
      Balanced Accuracy : 0.8661          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_300_0<span class="fl">.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_300)</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>pred_weight_0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_0<span class="fl">.75</span>,pred_col_300)</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb383-9"><a href="#cb383-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-10"><a href="#cb383-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb383-11"><a href="#cb383-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb383-12"><a href="#cb383-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb383-13"><a href="#cb383-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-14"><a href="#cb383-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"0.75"</span>,<span class="st">"pred_col_300"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-61-contents" aria-controls="callout-61" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Local Weight: 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-61" class="callout-61-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive_300,</span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>                             testing_data,</span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y.var.name=</span><span class="st">"Y"</span>,</span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">global.w=</span><span class="dv">0</span>)</span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred_300, <span class="st">"data/rds/gwRF_pred_300_1.rds"</span>)</span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-11"><a href="#cb384-11" aria-hidden="true" tabindex="-1"></a>gwRF_pred_300 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/gwRF_pred_300_1.rds"</span>)</span>
<span id="cb384-12"><a href="#cb384-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-13"><a href="#cb384-13" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gwRF_pred_300 <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb384-14"><a href="#cb384-14" aria-hidden="true" tabindex="-1"></a>pred_col_300 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_col_300)</span>
<span id="cb384-15"><a href="#cb384-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-16"><a href="#cb384-16" aria-hidden="true" tabindex="-1"></a>cm_300_1 <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb384-17"><a href="#cb384-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cm_300_1, <span class="st">"data/rds/cm_300_1.rds"</span>)</span>
<span id="cb384-18"><a href="#cb384-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_pred_300)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>cm_300_1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/cm_300_1.rds"</span>)</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>cm_300_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 5783  879
         1  595 3960
                                          
               Accuracy : 0.8686          
                 95% CI : (0.8622, 0.8748)
    No Information Rate : 0.5686          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7302          
                                          
 Mcnemar's Test P-Value : 1.691e-13       
                                          
            Sensitivity : 0.9067          
            Specificity : 0.8184          
         Pos Pred Value : 0.8681          
         Neg Pred Value : 0.8694          
             Prevalence : 0.5686          
         Detection Rate : 0.5156          
   Detection Prevalence : 0.5939          
      Balanced Accuracy : 0.8625          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(cm_300_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred_col_300)</span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>pred_weight_1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_weight_1,pred_col_300)</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_col_300, test_col)</span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a>tp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">2</span>]  <span class="co"># True Positives</span></span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a>fp <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">1</span>, <span class="dv">2</span>]  <span class="co"># False Positives</span></span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> cm<span class="sc">$</span>table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># False Negatives</span></span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb388-11"><a href="#cb388-11" aria-hidden="true" tabindex="-1"></a>recall <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)</span>
<span id="cb388-12"><a href="#cb388-12" aria-hidden="true" tabindex="-1"></a>f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision<span class="sc">*</span>recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb388-13"><a href="#cb388-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-14"><a href="#cb388-14" aria-hidden="true" tabindex="-1"></a>f1_score.df[<span class="st">"1"</span>,<span class="st">"pred_col_300"</span>] <span class="ot">&lt;-</span> f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gwRF_adaptive_300)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-standardised-bandwidth" class="level2">
<h2 class="anchored" data-anchor-id="plotting-gwrf-model-prediction-accuracy-at-incrementing-weight-standardised-bandwidth">7.6 Plotting GWRF Model Prediction Accuracy at Incrementing Weight &amp; Standardised Bandwidth</h2>
<p>In this section, we are plotting the prediction accuracy of the GWRF models at incrementing weight parameters and standardised bandwidths. The weight parameters range from 0 to 1 in increments of 0.25, and the standardised bandwidths used are 50, 100, 150, 200, 250, and 300.</p>
<p>The code chunk below creates a data frame with all combinations of weights and bandwidths, adds the accuracy values for each combination, and then creates a line plot of the accuracy against the bandwidth for each weight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"0.25"</span>, <span class="st">"0.50"</span>, <span class="st">"0.75"</span>, <span class="st">"1"</span>)</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>bandwidths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>,<span class="dv">300</span>)</span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with all combinations of weights and bandwidths</span></span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a>df_gwRF <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Weight =</span> weights, <span class="at">Bandwidth =</span> bandwidths)</span>
<span id="cb390-6"><a href="#cb390-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-7"><a href="#cb390-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add your accuracy values</span></span>
<span id="cb390-8"><a href="#cb390-8" aria-hidden="true" tabindex="-1"></a>df_gwRF<span class="sc">$</span>Accuracy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.8813</span>, <span class="fl">0.8961</span>, <span class="fl">0.8995</span>, <span class="fl">0.8582</span>, <span class="fl">0.8816</span>,</span>
<span id="cb390-9"><a href="#cb390-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.8813</span>, <span class="fl">0.8945</span>, <span class="fl">0.8997</span>, <span class="fl">0.8941</span>, <span class="fl">0.8829</span>,</span>
<span id="cb390-10"><a href="#cb390-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.8813</span>, <span class="fl">0.8932</span>, <span class="fl">0.9</span>, <span class="fl">0.8977</span>, <span class="fl">0.8891</span>,</span>
<span id="cb390-11"><a href="#cb390-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.8813</span>, <span class="fl">0.891</span>, <span class="fl">0.8991</span>, <span class="fl">0.8985</span>, <span class="fl">0.8931</span>,</span>
<span id="cb390-12"><a href="#cb390-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.8813</span>, <span class="fl">0.8902</span>, <span class="fl">0.8959</span>, <span class="fl">0.898</span>, <span class="fl">0.8938</span>,</span>
<span id="cb390-13"><a href="#cb390-13" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.8813</span>, <span class="fl">0.8901</span>, <span class="fl">0.8952</span>, <span class="fl">0.8978</span>, <span class="fl">0.8946</span>)</span>
<span id="cb390-14"><a href="#cb390-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-15"><a href="#cb390-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb390-16"><a href="#cb390-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_gwRF, <span class="fu">aes</span>(<span class="at">x =</span> Bandwidth, <span class="at">y =</span> Accuracy, <span class="at">color =</span> Weight)) <span class="sc">+</span></span>
<span id="cb390-17"><a href="#cb390-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb390-18"><a href="#cb390-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">9</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb390-19"><a href="#cb390-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bandwidth"</span>, <span class="at">y =</span> <span class="st">"Accuracy"</span>, <span class="at">title =</span> <span class="st">"GWRF Model Prediction Accuracy </span><span class="sc">\n</span><span class="st">at Incrementing Weight &amp; Standardised Bandwidth"</span>) <span class="sc">+</span></span>
<span id="cb390-20"><a href="#cb390-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>)) <span class="sc">+</span></span>
<span id="cb390-21"><a href="#cb390-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.84</span>, <span class="fl">0.911</span>)) <span class="sc">+</span></span>
<span id="cb390-22"><a href="#cb390-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e4c838"</span>, <span class="st">"#de573e"</span>, <span class="st">"#b977cb"</span>, <span class="st">"#4225df"</span>, <span class="st">"#32c962"</span>)) <span class="sc">+</span></span>
<span id="cb390-23"><a href="#cb390-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb390-24"><a href="#cb390-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb390-25"><a href="#cb390-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),  <span class="co"># Remove internal grid lines</span></span>
<span id="cb390-26"><a href="#cb390-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb390-27"><a href="#cb390-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb390-28"><a href="#cb390-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb390-29"><a href="#cb390-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-257-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(f1_score.df, <span class="st">"data/rds/f1_score.df.rds"</span>)</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(pred_weight_0, <span class="st">"data/rds/pred_weight_0.rds"</span>)</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(pred_weight_0<span class="fl">.25</span>, <span class="st">"data/rds/pred_weight_0.25.rds"</span>)</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(pred_weight_0<span class="fl">.5</span>, <span class="st">"data/rds/pred_weight_0.5.rds"</span>)</span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(pred_weight_0<span class="fl">.75</span>, <span class="st">"data/rds/pred_weight_0.75.rds"</span>)</span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(pred_weight_1, <span class="st">"data/rds/pred_weight_1.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="kriging" class="level1">
<h1>8.0 Kriging</h1>
<p>Kriging is a geostatistical interpolation technique that generates estimates of the uncertainty surrounding each interpolated value. It is particularly useful when there is moderate spatial autocorrelation, as it helps in preserving spatial variability.</p>
<p>The general steps involved in Kriging are as follows:</p>
<ol type="1">
<li><p><strong>Fitting a Variogram</strong>: The first step in Kriging is to fit a variogram to develop the spatial covariance structure of sampled points. A variogram is a function that describes the degree of spatial dependence of a spatial random field or stochastic process.</p></li>
<li><p><strong>Interpolating Values</strong>: Once the variogram is fitted, it is used to interpolate values for unsampled points from derived weights of the covariance structure. This is done using the spatial covariance structure to optimally estimate the values at unsampled locations.</p></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `valtellina' from data source 
  `/Users/khantminnaing/IS485-Landslide/data/vector/valtellina.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 1 feature and 95 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 518970 ymin: 5095447 xmax: 625510 ymax: 5165389
Projected CRS: WGS 84 / UTM zone 32N</code></pre>
</div>
</div>
<section id="creating-raster-layer" class="level2">
<h2 class="anchored" data-anchor-id="creating-raster-layer">8.1 Creating Raster Layer</h2>
<p>The <strong><code>terra::rast()</code></strong> function is used to create a raster layer from the <strong><code>valtellina</code></strong> object with 700 rows and 1066 columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(valtellina, </span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nrows =</span> <span class="dv">700</span>, </span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncols =</span> <span class="dv">1066</span>)</span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a>grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 700, 1066, 1  (nrow, ncol, nlyr)
resolution  : 99.94376, 99.91744  (x, y)
extent      : 518970, 625510, 5095447, 5165389  (xmin, xmax, ymin, ymax)
coord. ref. : WGS 84 / UTM zone 32N (EPSG:32632) </code></pre>
</div>
</div>
</section>
<section id="extracting-cell-coordinates" class="level2">
<h2 class="anchored" data-anchor-id="extracting-cell-coordinates">8.2 Extracting Cell Coordinates</h2>
<p>The <strong><code>terra::xyFromCell()</code></strong> function is used to extract the x and y coordinates of each cell in the raster layer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">xyFromCell</span>(grid, </span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">1</span><span class="sc">:</span><span class="fu">ncell</span>(grid))</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            x       y
[1,] 519019.9 5165339
[2,] 519119.9 5165339
[3,] 519219.8 5165339
[4,] 519319.8 5165339
[5,] 519419.7 5165339
[6,] 519519.7 5165339</code></pre>
</div>
</div>
</section>
<section id="creating-spatal-data-frame" class="level2">
<h2 class="anchored" data-anchor-id="creating-spatal-data-frame">8.3 Creating Spatal Data Frame</h2>
<p>The <strong><code>st_as_sf()</code></strong> function from the <strong><code>sf</code></strong> package is used to convert the data frame of coordinates into a spatial data frame. The <strong><code>st_filter()</code></strong> function is then used to keep only the points that fall within the <strong><code>valtellina</code></strong> region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>coop <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">as.data.frame</span>(xy), </span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>),</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">crs =</span> <span class="fu">st_crs</span>(valtellina))</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>coop <span class="ot">&lt;-</span> <span class="fu">st_filter</span>(coop, valtellina)</span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 0 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 594477.5 ymin: 5165139 xmax: 594877.2 ymax: 5165339
Projected CRS: WGS 84 / UTM zone 32N
                  geometry
1 POINT (594777.3 5165339)
2 POINT (594877.2 5165339)
3 POINT (594677.4 5165239)
4 POINT (594777.3 5165239)
5 POINT (594877.2 5165239)
6 POINT (594477.5 5165139)</code></pre>
</div>
</div>
</section>
<section id="variogram" class="level2">
<h2 class="anchored" data-anchor-id="variogram">8.4 Variogram</h2>
<p>A variogram is a tool used in geostatistics to quantify the spatial autocorrelation of a variable. It provides a visual depiction of the covariance exhibited between each pair of points in the sampled data. For each pair of points in the sampled data, the “semivariance” is plotted against the distance between the pairs.</p>
<p>The <strong><code>variogram</code></strong> function from the <strong><code>gstat</code></strong> package in R is used to calculate the empirical variogram of the data. The <strong><code>fit.variogram</code></strong> function is then used to fit a theoretical variogram model to this empirical variogram. The <strong><code>vgm</code></strong> function is used to specify the theoretical variogram model to fit.</p>
<p>The <strong><code>psill</code></strong> parameter is the maximum semivariance value, also known as the sill. The <strong><code>model</code></strong> parameter specifies the type of variogram model to use, in this case, a spherical model. The <strong><code>range</code></strong> parameter is the distance at which the semivariance reaches the specified sill. The <strong><code>nugget</code></strong> parameter represents the variance at zero distance, accounting for measurement errors or spatial sources of variation at distances smaller than the sampling interval.</p>
<p>Spherical variogram models are commonly used in geostatistical applications as they often have a similar shape to empirical variograms.</p>
<p>Here is the code chunk that accomplishes this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">variogram</span>(Predicted <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> testing_data_sf)</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-267-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>fv <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(<span class="at">object =</span> v,</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="fu">vgm</span>(</span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">psill =</span> <span class="fl">0.5</span>, </span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model =</span> <span class="st">"Sph"</span>,</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">range =</span> <span class="dv">5000</span>, </span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nugget =</span> <span class="fl">0.1</span>))</span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true" tabindex="-1"></a>fv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  model      psill    range
1   Nug 0.06388633    0.000
2   Sph 0.04660956 9148.716</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(v, fv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-269-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="creating-krige-object" class="level2">
<h2 class="anchored" data-anchor-id="creating-krige-object">8.5 Creating Krige Object</h2>
<p>In this code chunk, we create a <strong><code>gstat</code></strong> object named <strong><code>k</code></strong> using the <strong><code>gstat</code></strong> function. This object represents a geostatistical model that we’ll use for Kriging. The formula <strong><code>Predicted ~ 1</code></strong> specifies that we’re modeling the <strong><code>Predicted</code></strong> variable as a function of a constant (i.e., we’re fitting a mean model). The <strong><code>data</code></strong> argument is set to <strong><code>testing_data_sf</code></strong>. The <strong><code>model</code></strong> argument is set to <strong><code>fv</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">gstat</span>(<span class="at">formula =</span> Predicted <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> testing_data_sf, </span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">model =</span> fv)</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prediction-with-krige-object" class="level2">
<h2 class="anchored" data-anchor-id="prediction-with-krige-object">8.6 Prediction with Krige Object</h2>
<p>In this code chunk, we use the <strong><code>predict</code></strong> function to make predictions from the Kriging model <strong><code>k</code></strong> for the locations specified in <strong><code>coop</code></strong>. The predictions are stored in <strong><code>resp</code></strong>. We then extract the x and y coordinates and the predicted values from <strong><code>resp</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="fu">predict</span>(k, coop)</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(resp)[,<span class="dv">1</span>]</span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(resp)[,<span class="dv">2</span>]</span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>pred <span class="ot">&lt;-</span> resp<span class="sc">$</span>var1.pred</span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a>resp<span class="sc">$</span>pred <span class="ot">&lt;-</span> resp<span class="sc">$</span>pred</span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a>resp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rasterizing-predictions" class="level2">
<h2 class="anchored" data-anchor-id="rasterizing-predictions">8.7 Rasterizing Predictions</h2>
<p>In this code chunk, we rasterize the predictions <strong><code>resp</code></strong> onto the raster grid <strong><code>grid</code></strong> using the <strong><code>terra::rasterize</code></strong> function. The rasterized predictions are stored in <strong><code>kpred</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>kpred <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rasterize</span>(resp, grid, </span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">field =</span> <span class="st">"pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we will save <code>kpred</code> for later use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(kpred, <span class="st">"data/raster/kpred.tif"</span>, <span class="at">filetype=</span><span class="st">"GTIFF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-spatial-interpolated-map" class="level2">
<h2 class="anchored" data-anchor-id="creating-spatial-interpolated-map">8.8 Creating Spatial Interpolated Map</h2>
<p>Now that we have the data ready, we use appropriate <strong><code>tmap</code></strong> functions to create a map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kpred) <span class="sc">+</span> </span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">alpha =</span> <span class="dv">1</span>, </span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="st">"-RdYlGn"</span>,</span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">"Probability of Landslides"</span>) <span class="sc">+</span></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Landslide Susceptibility Map (GWRF)"</span>,</span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.height =</span> <span class="fl">0.45</span>, </span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.width =</span> <span class="fl">0.35</span>,</span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type=</span><span class="st">"8star"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>() <span class="sc">+</span></span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_grid</span>(<span class="at">alpha =</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="predictivemodelling_files/figure-html/unnamed-chunk-275-1.png" class="img-fluid" width="960"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">What Causes Landslides? Explanatory Landslide Susceptibility Modelling of Valtellina Valley, Lombardy Region, Italy</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>